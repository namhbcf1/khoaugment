import{j as e}from"./index-DPVYnWcF.js";import{r as s}from"./vendor-DD54NZMZ.js";import{F as c,f as p,T as Y,e as v,C as o,$ as g,A as $,l as V,as as A,k as R,y as d,m as D,q as Z,O as ee,V as te,ad as ne,I as M,B as j,ay as se,az as le,M as ae,W as ie,aE as ce}from"./antd-pmzi8FkM.js";const{Title:re,Text:u,Paragraph:oe}=Y,{Option:a}=g,he=[{value:5e5,label:"500,000₫",type:"bill"},{value:2e5,label:"200,000₫",type:"bill"},{value:1e5,label:"100,000₫",type:"bill"},{value:5e4,label:"50,000₫",type:"bill"},{value:2e4,label:"20,000₫",type:"bill"},{value:1e4,label:"10,000₫",type:"bill"},{value:5e3,label:"5,000₫",type:"bill"},{value:2e3,label:"2,000₫",type:"bill"},{value:1e3,label:"1,000₫",type:"bill"},{value:5e3,label:"5,000₫",type:"coin"},{value:2e3,label:"2,000₫",type:"coin"},{value:1e3,label:"1,000₫",type:"coin"},{value:500,label:"500₫",type:"coin"},{value:200,label:"200₫",type:"coin"},{value:100,label:"100₫",type:"coin"}],pe=()=>{const[de]=c.useForm(),[i,b]=s.useState({}),[C,B]=s.useState(0),[T,_]=s.useState(0),[n,E]=s.useState(0),[y,F]=s.useState(!1),[L,f]=s.useState(!1),[x,O]=s.useState("shift_start"),[q,S]=s.useState(!1),[m,I]=s.useState(""),[k,G]=s.useState("Nguyễn Văn A"),[w,K]=s.useState("Ca sáng (8:00 - 14:00)");s.useEffect(()=>{let t=0;Object.entries(i).forEach(([l,h])=>{t+=parseInt(l)*(h||0)}),B(t),E(t-T)},[i,T]);const H=(t,l)=>{b(h=>({...h,[t]:l}))},X=t=>{_(t||0)},N=()=>{S(!0),setTimeout(()=>{F(!0),S(!1)},1e3)},z=()=>{f(!0)},P=()=>{f(!1)},W=()=>{f(!1),N()},r=t=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND",maximumFractionDigits:0}).format(t),J=he.map(t=>({key:t.value.toString(),denomination:t.label,type:t.type==="bill"?"Tiền giấy":"Tiền xu",count:i[t.value]||0,value:(i[t.value]||0)*t.value})),Q=[{title:"Mệnh giá",dataIndex:"denomination",key:"denomination"},{title:"Loại",dataIndex:"type",key:"type"},{title:"Số lượng",dataIndex:"count",key:"count",render:(t,l)=>e.jsx(A,{min:0,value:i[l.key],onChange:h=>H(l.key,h),disabled:y,style:{width:"100%"}})},{title:"Thành tiền",dataIndex:"value",key:"value",render:t=>r(t)}],U=()=>{if(!y)return null;const t=Math.abs(n)>1e4;return e.jsx(p,{style:{marginTop:16},children:e.jsx(ie,{status:t?"warning":"success",title:t?"Có sự chênh lệch đáng kể trong kết quả đếm tiền":"Đếm tiền hoàn tất",subTitle:e.jsxs("div",{children:[e.jsx("p",{children:t?`Chênh lệch: ${r(n)} (${n>0?"thừa":"thiếu"})`:"Kết quả đếm tiền đã được lưu thành công"}),e.jsxs("p",{children:["Thời gian: ",new Date().toLocaleString()]}),e.jsxs("p",{children:["Thu ngân: ",k]}),e.jsxs("p",{children:["Ca làm việc: ",w]}),m&&e.jsxs("p",{children:["Ghi chú: ",m]})]}),extra:[e.jsx(j,{icon:e.jsx(ce,{}),type:"primary",children:"In báo cáo"},"print"),e.jsx(j,{onClick:()=>window.location.reload(),children:"Đếm tiền mới"},"new")]})})};return e.jsx("div",{className:"cash-count",children:e.jsxs(p,{children:[e.jsx(re,{level:2,children:"Kiểm đếm tiền"}),e.jsx(oe,{type:"secondary",children:"Kiểm đếm tiền mặt trong quầy thu ngân để đảm bảo tính chính xác"}),!y&&e.jsxs(e.Fragment,{children:[e.jsxs(v,{gutter:16,style:{marginBottom:16},children:[e.jsx(o,{span:8,children:e.jsx(c.Item,{label:"Loại kiểm đếm",children:e.jsxs(g,{value:x,onChange:O,disabled:Object.keys(i).length>0,children:[e.jsx(a,{value:"shift_start",children:"Đầu ca"}),e.jsx(a,{value:"shift_end",children:"Cuối ca"}),e.jsx(a,{value:"mid_day",children:"Giữa ngày"})]})})}),e.jsx(o,{span:8,children:e.jsx(c.Item,{label:"Thu ngân",children:e.jsxs(g,{value:k,onChange:G,children:[e.jsx(a,{value:"Nguyễn Văn A",children:"Nguyễn Văn A"}),e.jsx(a,{value:"Trần Thị B",children:"Trần Thị B"}),e.jsx(a,{value:"Lê Văn C",children:"Lê Văn C"})]})})}),e.jsx(o,{span:8,children:e.jsx(c.Item,{label:"Ca làm việc",children:e.jsxs(g,{value:w,onChange:K,children:[e.jsx(a,{value:"Ca sáng (8:00 - 14:00)",children:"Ca sáng (8:00 - 14:00)"}),e.jsx(a,{value:"Ca chiều (14:00 - 20:00)",children:"Ca chiều (14:00 - 20:00)"}),e.jsx(a,{value:"Ca tối (20:00 - 22:00)",children:"Ca tối (20:00 - 22:00)"})]})})})]}),x==="shift_end"&&e.jsx(v,{gutter:16,style:{marginBottom:16},children:e.jsx(o,{span:24,children:e.jsx($,{message:"Số tiền dự kiến trong quầy",description:e.jsxs(V,{direction:"vertical",style:{width:"100%"},children:[e.jsx(u,{children:"Nhập số tiền dự kiến dựa trên báo cáo hệ thống:"}),e.jsx(A,{style:{width:"100%"},min:0,step:1e4,formatter:t=>`${t}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:t=>t.replace(/\$\s?|(,*)/g,""),onChange:X,addonAfter:"VND",placeholder:"Nhập số tiền dự kiến"})]}),type:"info",showIcon:!0})})}),e.jsx(R,{orientation:"left",children:"Nhập số lượng theo mệnh giá"}),e.jsx(d,{columns:Q,dataSource:J,pagination:!1,summary:()=>e.jsxs(d.Summary.Row,{children:[e.jsx(d.Summary.Cell,{index:0,colSpan:2,children:e.jsx(u,{strong:!0,children:"Tổng cộng"})}),e.jsx(d.Summary.Cell,{index:2,children:e.jsxs(u,{strong:!0,children:[Object.values(i).reduce((t,l)=>t+(l||0),0)," tờ/đồng"]})}),e.jsx(d.Summary.Cell,{index:3,children:e.jsx(u,{strong:!0,children:r(C)})})]})}),e.jsx(R,{}),e.jsxs(v,{gutter:16,children:[e.jsx(o,{span:12,children:e.jsx(p,{children:e.jsx(D,{title:"Tổng tiền đếm được",value:C,precision:0,valueStyle:{color:"#3f8600"},prefix:e.jsx(Z,{}),suffix:"VND",formatter:t=>r(t)})})}),x==="shift_end"&&e.jsx(o,{span:12,children:e.jsxs(p,{children:[e.jsx(D,{title:"Chênh lệch",value:n,precision:0,valueStyle:{color:n===0?"#3f8600":Math.abs(n)<1e4?"#faad14":"#cf1322"},prefix:n===0?e.jsx(ee,{}):n>0?e.jsx(te,{}):e.jsx(ne,{}),suffix:"VND",formatter:t=>{const l=r(Math.abs(t));return`${t>=0?"+":"-"} ${l}`}}),n!==0&&e.jsx("div",{style:{marginTop:8},children:e.jsx(u,{type:n>0?"success":"danger",children:n>0?"Thừa tiền":"Thiếu tiền"})})]})})]}),e.jsx("div",{style:{marginTop:16},children:e.jsx(c.Item,{label:"Ghi chú",children:e.jsx(M.TextArea,{rows:4,placeholder:"Nhập ghi chú về việc đếm tiền (nếu có)",value:m,onChange:t=>I(t.target.value)})})}),e.jsx("div",{style:{marginTop:16,textAlign:"right"},children:e.jsxs(V,{children:[e.jsx(j,{icon:e.jsx(se,{}),onClick:()=>b({}),children:"Đặt lại"}),e.jsx(j,{type:"primary",icon:e.jsx(le,{}),onClick:x==="shift_end"&&n!==0?z:N,loading:q,disabled:Object.keys(i).length===0,children:"Hoàn tất đếm tiền"})]})})]}),U(),e.jsxs(ae,{title:"Xác nhận chênh lệch",open:L,onOk:W,onCancel:P,okText:"Xác nhận",cancelText:"Hủy",children:[e.jsx($,{message:`Chênh lệch: ${r(n)} (${n>0?"thừa":"thiếu"})`,description:"Có sự chênh lệch giữa số tiền đếm được và số tiền dự kiến. Vui lòng kiểm tra lại hoặc ghi chú lý do chênh lệch.",type:Math.abs(n)<1e4?"warning":"error",showIcon:!0,style:{marginBottom:16}}),e.jsx(c,{layout:"vertical",children:e.jsx(c.Item,{label:"Lý do chênh lệch",children:e.jsx(M.TextArea,{rows:4,placeholder:"Nhập lý do chênh lệch",value:m,onChange:t=>I(t.target.value)})})})]})]})})};export{pe as default};
