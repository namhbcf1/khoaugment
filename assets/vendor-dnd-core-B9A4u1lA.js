import{c as t}from"./vendor-redux-DjMjAQeN.js";import{i as e}from"./vendor-react-dnd-invariant-3ejajjRq.js";import{a as r}from"./vendor-react-dnd-asap-CbVDrjlw.js";function n(t){return"object"==typeof t}const i="dnd-core/INIT_COORDS",o="dnd-core/BEGIN_DRAG",s="dnd-core/PUBLISH_DRAG_SOURCE",c="dnd-core/HOVER",a="dnd-core/DROP",u="dnd-core/END_DRAG";function d(t,e){return{type:i,payload:{sourceClientOffset:e||null,clientOffset:t||null}}}const l={type:i,payload:{clientOffset:null,sourceClientOffset:null}};function f(t){return function(r=[],i={publishSource:!0}){const{publishSource:s=!0,clientOffset:c,getSourceClientOffset:a}=i,u=t.getMonitor(),f=t.getRegistry();t.dispatch(d(c)),function(t,r,n){e(!r.isDragging(),"Cannot call beginDrag while dragging."),t.forEach(function(t){e(n.getSource(t),"Expected sourceIds to be registered.")})}(r,u,f);const g=function(t,e){let r=null;for(let n=t.length-1;n>=0;n--)if(e.canDragSource(t[n])){r=t[n];break}return r}(r,u);if(null==g)return void t.dispatch(l);let p=null;if(c){if(!a)throw new Error("getSourceClientOffset must be defined");!function(t){e("function"==typeof t,"When clientOffset is provided, getSourceClientOffset must be a function.")}(a),p=a(g)}t.dispatch(d(c,p));const h=f.getSource(g).beginDrag(u,g);if(null==h)return;!function(t){e(n(t),"Item must be an object.")}(h),f.pinSource(g);const y=f.getSourceType(g);return{type:o,payload:{itemType:y,item:h,sourceId:g,clientOffset:c||null,sourceClientOffset:p||null,isSourcePublic:!!s}}}}function g(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function p(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(e){g(t,e,r[e])})}return t}function h(t){return function(r={}){const i=t.getMonitor(),o=t.getRegistry();!function(t){e(t.isDragging(),"Cannot call drop while not dragging."),e(!t.didDrop(),"Cannot call drop twice during one drag operation.")}(i);const s=function(t){const e=t.getTargetIds().filter(t.canDropOnTarget,t);return e.reverse(),e}(i);s.forEach((s,c)=>{const u=function(t,r,i,o){const s=i.getTarget(t);let c=s?s.drop(o,t):void 0;(function(t){e(void 0===t||n(t),"Drop result must either be an object or undefined.")})(c),void 0===c&&(c=0===r?{}:o.getDropResult());return c}(s,c,o,i),d={type:a,payload:{dropResult:p({},r,u)}};t.dispatch(d)})}}function y(t){return function(){const r=t.getMonitor(),n=t.getRegistry();!function(t){e(t.isDragging(),"Cannot call endDrag while not dragging.")}(r);const i=r.getSourceId();if(null!=i){n.getSource(i,!0).endDrag(r,i),n.unpinSource()}return{type:u}}}function O(t,e){return null===e?null===t:Array.isArray(t)?t.some(t=>t===e):t===e}function S(t){return function(r,{clientOffset:n}={}){!function(t){e(Array.isArray(t),"Expected targetIds to be an array.")}(r);const i=r.slice(0),o=t.getMonitor(),s=t.getRegistry();return function(t,e,r){for(let n=t.length-1;n>=0;n--){const i=t[n];O(e.getTargetType(i),r)||t.splice(n,1)}}(i,s,o.getItemType()),function(t,r,n){e(r.isDragging(),"Cannot call hover while not dragging."),e(!r.didDrop(),"Cannot call hover after drop.");for(let i=0;i<t.length;i++){const r=t[i];e(t.lastIndexOf(r)===i,"Expected targetIds to be unique in the passed array.");const o=n.getTarget(r);e(o,"Expected targetIds to be registered.")}}(i,o,s),function(t,e,r){t.forEach(function(t){r.getTarget(t).hover(e,t)})}(i,o,s),{type:c,payload:{targetIds:i,clientOffset:n||null}}}}function b(t){return function(){if(t.getMonitor().isDragging())return{type:s}}}class I{receiveBackend(t){this.backend=t}getMonitor(){return this.monitor}getBackend(){return this.backend}getRegistry(){return this.monitor.registry}getActions(){const t=this,{dispatch:e}=this.store;const r=function(t){return{beginDrag:f(t),publishDragSource:b(t),hover:S(t),drop:h(t),endDrag:y(t)}}(this);return Object.keys(r).reduce((n,i)=>{const o=r[i];var s;return n[i]=(s=o,(...r)=>{const n=s.apply(t,r);void 0!==n&&e(n)}),n},{})}dispatch(t){this.store.dispatch(t)}constructor(t,e){this.isSetUp=!1,this.handleRefCountChange=()=>{const t=this.store.getState().refCount>0;this.backend&&(t&&!this.isSetUp?(this.backend.setup(),this.isSetUp=!0):!t&&this.isSetUp&&(this.backend.teardown(),this.isSetUp=!1))},this.store=t,this.monitor=e,t.subscribe(this.handleRefCountChange)}}function T(t,e){return{x:t.x-e.x,y:t.y-e.y}}const D=[],E=[];D.__IS_NONE__=!0,E.__IS_ALL__=!0;class m{subscribeToStateChange(t,r={}){const{handlerIds:n}=r;e("function"==typeof t,"listener must be a function."),e(void 0===n||Array.isArray(n),"handlerIds, when specified, must be an array of strings.");let i=this.store.getState().stateId;return this.store.subscribe(()=>{const e=this.store.getState(),r=e.stateId;try{const o=r===i||r===i+1&&!function(t,e){return t!==D&&(t===E||void 0===e||(r=t,e.filter(t=>r.indexOf(t)>-1)).length>0);var r}(e.dirtyHandlerIds,n);o||t()}finally{i=r}})}subscribeToOffsetChange(t){e("function"==typeof t,"listener must be a function.");let r=this.store.getState().dragOffset;return this.store.subscribe(()=>{const e=this.store.getState().dragOffset;e!==r&&(r=e,t())})}canDragSource(t){if(!t)return!1;const r=this.registry.getSource(t);return e(r,`Expected to find a valid source. sourceId=${t}`),!this.isDragging()&&r.canDrag(this,t)}canDropOnTarget(t){if(!t)return!1;const r=this.registry.getTarget(t);if(e(r,`Expected to find a valid target. targetId=${t}`),!this.isDragging()||this.didDrop())return!1;return O(this.registry.getTargetType(t),this.getItemType())&&r.canDrop(this,t)}isDragging(){return Boolean(this.getItemType())}isDraggingSource(t){if(!t)return!1;const r=this.registry.getSource(t,!0);if(e(r,`Expected to find a valid source. sourceId=${t}`),!this.isDragging()||!this.isSourcePublic())return!1;return this.registry.getSourceType(t)===this.getItemType()&&r.isDragging(this,t)}isOverTarget(t,e={shallow:!1}){if(!t)return!1;const{shallow:r}=e;if(!this.isDragging())return!1;const n=this.registry.getTargetType(t),i=this.getItemType();if(i&&!O(n,i))return!1;const o=this.getTargetIds();if(!o.length)return!1;const s=o.indexOf(t);return r?s===o.length-1:s>-1}getItemType(){return this.store.getState().dragOperation.itemType}getItem(){return this.store.getState().dragOperation.item}getSourceId(){return this.store.getState().dragOperation.sourceId}getTargetIds(){return this.store.getState().dragOperation.targetIds}getDropResult(){return this.store.getState().dragOperation.dropResult}didDrop(){return this.store.getState().dragOperation.didDrop}isSourcePublic(){return Boolean(this.store.getState().dragOperation.isSourcePublic)}getInitialClientOffset(){return this.store.getState().dragOffset.initialClientOffset}getInitialSourceClientOffset(){return this.store.getState().dragOffset.initialSourceClientOffset}getClientOffset(){return this.store.getState().dragOffset.clientOffset}getSourceClientOffset(){return function(t){const{clientOffset:e,initialClientOffset:r,initialSourceClientOffset:n}=t;return e&&r&&n?T((o=n,{x:(i=e).x+o.x,y:i.y+o.y}),r):null;var i,o}(this.store.getState().dragOffset)}getDifferenceFromInitialOffset(){return function(t){const{clientOffset:e,initialClientOffset:r}=t;return e&&r?T(e,r):null}(this.store.getState().dragOffset)}constructor(t,e){this.store=t,this.registry=e}}const v="dnd-core/ADD_SOURCE",w="dnd-core/ADD_TARGET",C="dnd-core/REMOVE_SOURCE",R="dnd-core/REMOVE_TARGET";function x(t,r){r&&Array.isArray(t)?t.forEach(t=>x(t,!1)):e("string"==typeof t||"symbol"==typeof t,r?"Type can only be a string, a symbol, or an array of either.":"Type can only be a string or a symbol.")}var j,P;(P=j||(j={})).SOURCE="SOURCE",P.TARGET="TARGET";let _=0;function A(t){const e=(_++).toString();switch(t){case j.SOURCE:return`S${e}`;case j.TARGET:return`T${e}`;default:throw new Error(`Unknown Handler Role: ${t}`)}}function U(t){switch(t[0]){case"S":return j.SOURCE;case"T":return j.TARGET;default:throw new Error(`Cannot parse handler ID: ${t}`)}}function k(t,e){const r=t.entries();let n=!1;do{const{done:t,value:[,i]}=r.next();if(i===e)return!0;n=!!t}while(!n);return!1}class G{addSource(t,r){x(t),function(t){e("function"==typeof t.canDrag,"Expected canDrag to be a function."),e("function"==typeof t.beginDrag,"Expected beginDrag to be a function."),e("function"==typeof t.endDrag,"Expected endDrag to be a function.")}(r);const n=this.addHandler(j.SOURCE,t,r);return this.store.dispatch(function(t){return{type:v,payload:{sourceId:t}}}(n)),n}addTarget(t,r){x(t,!0),function(t){e("function"==typeof t.canDrop,"Expected canDrop to be a function."),e("function"==typeof t.hover,"Expected hover to be a function."),e("function"==typeof t.drop,"Expected beginDrag to be a function.")}(r);const n=this.addHandler(j.TARGET,t,r);return this.store.dispatch(function(t){return{type:w,payload:{targetId:t}}}(n)),n}containsHandler(t){return k(this.dragSources,t)||k(this.dropTargets,t)}getSource(t,r=!1){e(this.isSourceId(t),"Expected a valid source ID.");return r&&t===this.pinnedSourceId?this.pinnedSource:this.dragSources.get(t)}getTarget(t){return e(this.isTargetId(t),"Expected a valid target ID."),this.dropTargets.get(t)}getSourceType(t){return e(this.isSourceId(t),"Expected a valid source ID."),this.types.get(t)}getTargetType(t){return e(this.isTargetId(t),"Expected a valid target ID."),this.types.get(t)}isSourceId(t){return U(t)===j.SOURCE}isTargetId(t){return U(t)===j.TARGET}removeSource(t){e(this.getSource(t),"Expected an existing source."),this.store.dispatch(function(t){return{type:C,payload:{sourceId:t}}}(t)),r(()=>{this.dragSources.delete(t),this.types.delete(t)})}removeTarget(t){e(this.getTarget(t),"Expected an existing target."),this.store.dispatch(function(t){return{type:R,payload:{targetId:t}}}(t)),this.dropTargets.delete(t),this.types.delete(t)}pinSource(t){const r=this.getSource(t);e(r,"Expected an existing source."),this.pinnedSourceId=t,this.pinnedSource=r}unpinSource(){e(this.pinnedSource,"No source is pinned at the time."),this.pinnedSourceId=null,this.pinnedSource=null}addHandler(t,e,r){const n=A(t);return this.types.set(n,e),t===j.SOURCE?this.dragSources.set(n,r):t===j.TARGET&&this.dropTargets.set(n,r),n}constructor(t){this.types=new Map,this.dragSources=new Map,this.dropTargets=new Map,this.pinnedSourceId=null,this.pinnedSource=null,this.store=t}}const M=(t,e)=>t===e;function H(t=D,e){switch(e.type){case c:break;case v:case w:case R:case C:return D;default:return E}const{targetIds:r=[],prevTargetIds:n=[]}=e.payload,i=function(t,e){const r=new Map,n=t=>{r.set(t,r.has(t)?r.get(t)+1:1)};t.forEach(n),e.forEach(n);const i=[];return r.forEach((t,e)=>{1===t&&i.push(e)}),i}(r,n);if(!(i.length>0||!function(t,e,r=M){if(t.length!==e.length)return!1;for(let n=0;n<t.length;++n)if(!r(t[n],e[n]))return!1;return!0}(r,n)))return D;const o=n[n.length-1],s=r[r.length-1];return o!==s&&(o&&i.push(o),s&&i.push(s)),i}function N(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const B={initialSourceClientOffset:null,initialClientOffset:null,clientOffset:null};function $(t=B,e){const{payload:r}=e;switch(e.type){case i:case o:return{initialSourceClientOffset:r.sourceClientOffset,initialClientOffset:r.clientOffset,clientOffset:r.clientOffset};case c:return n=t.clientOffset,s=r.clientOffset,!n&&!s||n&&s&&n.x===s.x&&n.y===s.y?t:function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(e){N(t,e,r[e])})}return t}({},t,{clientOffset:r.clientOffset});case u:case a:return B;default:return t}var n,s}function L(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function V(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(e){L(t,e,r[e])})}return t}const X={itemType:null,item:null,sourceId:null,targetIds:[],dropResult:null,didDrop:!1,isSourcePublic:null};function q(t=X,e){const{payload:r}=e;switch(e.type){case o:return V({},t,{itemType:r.itemType,item:r.item,sourceId:r.sourceId,isSourcePublic:r.isSourcePublic,dropResult:null,didDrop:!1});case s:return V({},t,{isSourcePublic:!0});case c:return V({},t,{targetIds:r.targetIds});case R:return-1===t.targetIds.indexOf(r.targetId)?t:V({},t,{targetIds:(n=t.targetIds,i=r.targetId,n.filter(t=>t!==i))});case a:return V({},t,{dropResult:r.dropResult,didDrop:!0,targetIds:[]});case u:return V({},t,{itemType:null,item:null,sourceId:null,dropResult:null,didDrop:!1,isSourcePublic:null,targetIds:[]});default:return t}var n,i}function F(t=0,e){switch(e.type){case v:case w:return t+1;case C:case R:return t-1;default:return t}}function W(t=0){return t+1}function z(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function J(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(e){z(t,e,r[e])})}return t}function K(t={},e){return{dirtyHandlerIds:H(t.dirtyHandlerIds,{type:e.type,payload:J({},e.payload,{prevTargetIds:(r=t,n="dragOperation.targetIds",i=[],n.split(".").reduce((t,e)=>t&&t[e]?t[e]:i||null,r))})}),dragOffset:$(t.dragOffset,e),refCount:F(t.refCount,e),dragOperation:q(t.dragOperation,e),stateId:W(t.stateId)};var r,n,i}function Q(e,r=void 0,n={},i=!1){const o=function(e){const r="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__;return t(K,e&&r&&r({name:"dnd-core",instanceId:"dnd-core"}))}(i),s=new m(o,new G(o)),c=new I(o,s),a=e(c,r,n);return c.receiveBackend(a),c}export{Q as c};
