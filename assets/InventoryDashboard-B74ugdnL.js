import{j as e}from"./index-DPVYnWcF.js";import{u as ne,r as c}from"./vendor-DD54NZMZ.js";import{z,f as l,e as h,C as a,T as oe,l as S,B as i,ag as ae,a1 as re,au as ce,ay as ie,m as w,aA as B,am as v,ab as le,o as de,H as g,E as he,V as xe,aB as ue,y as V,a8 as me,I as ge,$ as R,af as je,aj as pe,N as ke,J as C,a7 as ye,ak as fe,aC as Se,u as ve,ad as Ce,P as Ie,O as Te}from"./antd-pmzi8FkM.js";import{C as Me}from"./index-BWtZXrxb.js";import{P as X}from"./index-J5Y8oacM.js";import"./utils-Db1EesZb.js";import"./defaultLocale-Baf4yPCw.js";const{Title:be,Text:L,Link:we}=oe,{Search:Le}=ge,{Option:j}=R,{TabPane:ze}=ve,Be=()=>{const I=ne(),[d,T]=c.useState(!0),[M,K]=c.useState([]),[x,E]=c.useState({}),[p,$]=c.useState(""),[U,D]=c.useState([]),[y,_]=c.useState("all"),[f,F]=c.useState("all"),[P,G]=c.useState([]),[b,Y]=c.useState([]),[A,H]=c.useState([]);c.useEffect(()=>{T(!0),setTimeout(()=>{const t=O();K(t),D(t),E(J(t)),G(W(t)),Y(t.filter(s=>s.stock<=s.lowStockThreshold).slice(0,5)),H(q()),T(!1)},1500)},[]);const O=()=>[{name:"Laptop Dell XPS 13",category:"Laptop",price:285e5,cost:24e6},{name:"Laptop Macbook Air M2",category:"Laptop",price:279e5,cost:235e5},{name:"PC Gaming Core i7",category:"PC",price:25e6,cost:21e6},{name:"PC Văn phòng",category:"PC",price:12e6,cost:95e5},{name:'Màn hình Dell 27"',category:"Màn hình",price:55e5,cost:43e5},{name:"Màn hình LG Ultrawide",category:"Màn hình",price:89e5,cost:7e6},{name:"RAM Kingston 16GB",category:"Linh kiện",price:15e5,cost:12e5},{name:"SSD Samsung 1TB",category:"Linh kiện",price:25e5,cost:19e5},{name:"Chuột Logitech MX Master",category:"Phụ kiện",price:18e5,cost:14e5},{name:"Bàn phím cơ Keychron",category:"Phụ kiện",price:22e5,cost:17e5},{name:"Tai nghe Sony WH-1000XM4",category:"Âm thanh",price:58e5,cost:45e5},{name:"Loa JBL Flip 6",category:"Âm thanh",price:25e5,cost:18e5},{name:"Card đồ họa RTX 4060",category:"Linh kiện",price:85e5,cost:72e5},{name:"Bộ tản nhiệt CPU",category:"Linh kiện",price:12e5,cost:85e4},{name:"Tay cầm Xbox Series",category:"Gaming",price:15e5,cost:115e4}].map((s,n)=>{const o=Math.floor(Math.random()*50),m=Math.floor(Math.random()*5)+3,k=Math.floor(Math.random()*20)+15;return{id:n+1,sku:`SKU-${100+n}`,name:s.name,category:s.category,stock:o,reserved:Math.floor(Math.random()*5),lowStockThreshold:m,optimalStock:k,price:s.price,cost:s.cost,value:o*s.cost,status:o<=0?"out_of_stock":o<=m?"low_stock":"in_stock",lastUpdated:z().subtract(Math.floor(Math.random()*30),"days").format("YYYY-MM-DD"),location:`Kệ ${String.fromCharCode(65+Math.floor(Math.random()*6))}-${Math.floor(Math.random()*20)+1}`,incoming:Math.random()>.7?Math.floor(Math.random()*10)+1:0}}),J=t=>{const s=t.reduce((r,u)=>r+u.stock,0),n=t.reduce((r,u)=>r+u.value,0),o=t.filter(r=>r.status==="low_stock").length,m=t.filter(r=>r.status==="out_of_stock").length,k=t.filter(r=>r.status==="in_stock").length;return{totalProducts:t.length,totalItems:s,totalValue:n,lowStockCount:o,outOfStockCount:m,inStockCount:k,averageValue:n/s}},W=t=>[...new Set(t.map(n=>n.category))].map(n=>{const o=t.filter(r=>r.category===n),m=o.reduce((r,u)=>r+u.stock,0),k=o.reduce((r,u)=>r+u.value,0);return{category:n,items:o.length,stock:m,value:k}}).sort((n,o)=>o.value-n.value),q=()=>[{id:1,name:"Laptop Dell XPS 13",category:"Laptop",sold:24,restocked:15,turnoverRate:2.4},{id:2,name:"Chuột Logitech MX Master",category:"Phụ kiện",sold:42,restocked:50,turnoverRate:3.8},{id:3,name:"RAM Kingston 16GB",category:"Linh kiện",sold:36,restocked:40,turnoverRate:3.2},{id:4,name:"Tai nghe Sony WH-1000XM4",category:"Âm thanh",sold:18,restocked:20,turnoverRate:2.2},{id:5,name:"SSD Samsung 1TB",category:"Linh kiện",sold:32,restocked:30,turnoverRate:3}];c.useEffect(()=>{let t=[...M];p&&(t=t.filter(s=>s.name.toLowerCase().includes(p.toLowerCase())||s.sku.toLowerCase().includes(p.toLowerCase())||s.category.toLowerCase().includes(p.toLowerCase()))),y!=="all"&&(t=t.filter(s=>s.category===y)),f!=="all"&&(t=t.filter(s=>s.status===f)),D(t)},[p,y,f,M]);const Q=[...new Set(M.map(t=>t.category))],Z=[{title:"Sản phẩm",dataIndex:"name",key:"name",render:(t,s)=>e.jsx(we,{onClick:()=>I(`/admin/inventory/product/${s.id}`),children:t})},{title:"SKU",dataIndex:"sku",key:"sku"},{title:"Danh mục",dataIndex:"category",key:"category",render:t=>e.jsx(g,{children:t})},{title:"Tồn kho",dataIndex:"stock",key:"stock",sorter:(t,s)=>t.stock-s.stock,render:(t,s)=>{let n;return s.status==="out_of_stock"?n="#ff4d4f":s.status==="low_stock"?n="#faad14":n="#52c41a",e.jsxs("div",{children:[e.jsx(v,{color:n,text:t}),s.incoming>0&&e.jsx(C,{title:`${s.incoming} sắp về`,children:e.jsxs(g,{color:"blue",style:{marginLeft:8},children:["+",s.incoming]})})]})}},{title:"Trạng thái",dataIndex:"status",key:"status",render:t=>{let s,n,o;switch(t){case"in_stock":s="success",n="Còn hàng",o=e.jsx(Te,{});break;case"low_stock":s="warning",n="Sắp hết",o=e.jsx(Ie,{});break;case"out_of_stock":s="error",n="Hết hàng",o=e.jsx(Ce,{});break;default:s="default",n=t,o=null}return e.jsx(g,{color:s,icon:o,children:n})}},{title:"Tối ưu",key:"stockLevel",dataIndex:"stock",render:(t,s)=>{const n=Math.min(100,Math.round(s.stock/s.optimalStock*100));let o;return n<=20?o="#ff4d4f":n<=60?o="#faad14":o="#52c41a",e.jsx(C,{title:`${s.stock}/${s.optimalStock} (${n}%)`,children:e.jsx(ye,{percent:n,size:"small",strokeColor:o})})}},{title:"Giá trị",dataIndex:"value",key:"value",sorter:(t,s)=>t.value-s.value,render:t=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(t)},{title:"Vị trí",dataIndex:"location",key:"location"},{title:"Cập nhật",dataIndex:"lastUpdated",key:"lastUpdated",render:t=>z(t).format("DD/MM/YYYY")},{title:"Thao tác",key:"action",render:(t,s)=>e.jsxs(S,{size:"small",children:[e.jsx(C,{title:"Chỉnh sửa",children:e.jsx(i,{type:"text",size:"small",icon:e.jsx(fe,{}),onClick:()=>I(`/admin/inventory/edit/${s.id}`)})}),e.jsx(C,{title:"Cập nhật tồn kho",children:e.jsx(i,{type:"text",size:"small",icon:e.jsx(Se,{}),onClick:()=>console.log("Update stock",s.id)})})]})}],ee={data:P,xField:"category",yField:"stock",label:{position:"middle",style:{fill:"#FFFFFF",opacity:.6}},meta:{category:{alias:"Danh mục"},stock:{alias:"Tồn kho"}},color:"#1890ff"},te={data:P,angleField:"value",colorField:"category",radius:.8,label:{type:"spider",content:`{name}
{percentage}`,style:{fontSize:12}},interactions:[{type:"element-active"}],tooltip:{formatter:t=>({name:t.category,value:N(t.value)})}},N=t=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(t),se=[{title:"Sản phẩm",dataIndex:"name",key:"name"},{title:"Danh mục",dataIndex:"category",key:"category",render:t=>e.jsx(g,{children:t})},{title:"Đã bán",dataIndex:"sold",key:"sold",align:"right"},{title:"Nhập mới",dataIndex:"restocked",key:"restocked",align:"right"},{title:"Tỉ lệ luân chuyển",dataIndex:"turnoverRate",key:"turnoverRate",align:"right",render:t=>e.jsx(g,{color:"blue",children:t})}];return e.jsxs("div",{className:"inventory-dashboard",children:[e.jsx(l,{bordered:!1,className:"header-card",children:e.jsxs(h,{justify:"space-between",align:"middle",gutter:[24,24],children:[e.jsxs(a,{xs:24,sm:12,children:[e.jsx(be,{level:3,children:"Quản lý kho hàng"}),e.jsx(L,{type:"secondary",children:"Theo dõi tồn kho và quản lý sản phẩm trong kho"})]}),e.jsx(a,{xs:24,sm:12,children:e.jsxs(S,{wrap:!0,style:{width:"100%",justifyContent:"flex-end"},children:[e.jsx(i,{type:"primary",icon:e.jsx(ae,{}),onClick:()=>I("/admin/inventory/add"),children:"Nhập hàng"}),e.jsx(i,{icon:e.jsx(re,{}),children:"Xuất hàng"}),e.jsx(i,{icon:e.jsx(ce,{}),children:"Xuất Excel"}),e.jsx(i,{icon:e.jsx(ie,{}),loading:d,onClick:()=>T(!0),children:"Làm mới"})]})})]})}),e.jsxs(h,{gutter:[24,24],style:{marginTop:"24px"},children:[e.jsx(a,{xs:24,sm:8,children:e.jsx(l,{bordered:!1,loading:d,children:e.jsx(w,{title:e.jsxs("div",{children:[e.jsx(B,{})," Tổng sản phẩm"]}),value:x.totalProducts,suffix:e.jsxs("div",{style:{fontSize:"14px"},children:[x.totalItems," đơn vị"]})})})}),e.jsx(a,{xs:24,sm:8,children:e.jsx(l,{bordered:!1,loading:d,children:e.jsx(w,{title:e.jsxs("div",{children:[e.jsx(le,{})," Trạng thái kho"]}),value:x.inStockCount,suffix:e.jsxs("div",{style:{fontSize:"14px"},children:[e.jsx(v,{status:"success",text:`${x.inStockCount} còn hàng`}),e.jsx("br",{}),e.jsx(v,{status:"warning",text:`${x.lowStockCount} sắp hết`}),e.jsx("br",{}),e.jsx(v,{status:"error",text:`${x.outOfStockCount} hết hàng`})]})})})}),e.jsx(a,{xs:24,sm:8,children:e.jsx(l,{bordered:!1,loading:d,children:e.jsx(w,{title:e.jsxs("div",{children:[e.jsx(de,{})," Giá trị tồn kho"]}),value:x.totalValue,precision:0,formatter:t=>N(t)})})})]}),e.jsx(h,{gutter:[24,24],style:{marginTop:"24px"},children:e.jsx(a,{xs:24,children:e.jsx(l,{title:e.jsxs("span",{children:[e.jsx(xe,{})," Cảnh báo tồn kho"]}),bordered:!1,loading:d,children:b.length>0?e.jsxs(h,{gutter:[16,16],children:[b.map(t=>e.jsx(a,{xs:24,sm:12,md:8,lg:6,children:e.jsx(l,{size:"small",className:"warning-card",children:e.jsxs("div",{className:"warning-card-content",children:[e.jsxs("div",{children:[e.jsx(L,{strong:!0,children:t.name}),e.jsx("br",{}),e.jsx(L,{type:"secondary",children:t.category})]}),e.jsxs("div",{children:[e.jsxs(g,{color:t.status==="out_of_stock"?"error":"warning",children:[t.stock," / ",t.lowStockThreshold]}),e.jsx("div",{style:{marginTop:8},children:e.jsx(i,{size:"small",type:"primary",children:"Đặt hàng"})})]})]})})},t.id)),b.length>0&&e.jsx(a,{xs:24,children:e.jsx("div",{style:{textAlign:"right",marginTop:12},children:e.jsx(i,{type:"link",children:"Xem tất cả sản phẩm sắp hết hàng"})})})]}):e.jsx(he,{description:"Không có cảnh báo tồn kho"})})})}),e.jsxs(h,{gutter:[24,24],style:{marginTop:"24px"},children:[e.jsx(a,{xs:24,lg:12,children:e.jsx(l,{title:e.jsxs("span",{children:[e.jsx(ue,{})," Phân bố tồn kho theo danh mục"]}),bordered:!1,loading:d,children:e.jsx(Me,{...ee,height:300})})}),e.jsx(a,{xs:24,lg:12,children:e.jsx(l,{title:e.jsxs("span",{children:[e.jsx(X,{})," Giá trị tồn kho theo danh mục"]}),bordered:!1,loading:d,children:e.jsx(X,{...te,height:300})})})]}),e.jsx(h,{gutter:[24,24],style:{marginTop:"24px"},children:e.jsx(a,{xs:24,children:e.jsx(l,{title:e.jsxs("span",{children:[e.jsx(me,{})," Top sản phẩm chuyển động nhanh"]}),bordered:!1,loading:d,children:e.jsx(V,{dataSource:A,columns:se,pagination:!1,rowKey:"id"})})})}),e.jsx(h,{gutter:[24,24],style:{marginTop:"24px"},children:e.jsx(a,{xs:24,children:e.jsxs(l,{title:e.jsxs("span",{children:[e.jsx(B,{})," Danh sách tồn kho"]}),bordered:!1,loading:d,extra:e.jsxs(S,{children:[e.jsx(i,{icon:e.jsx(pe,{}),children:"Nhập từ Excel"}),e.jsx(i,{icon:e.jsx(ke,{}),children:"Tải Excel mẫu"})]}),children:[e.jsx("div",{style:{marginBottom:16},children:e.jsxs(h,{gutter:[16,16],align:"middle",children:[e.jsx(a,{xs:24,md:8,children:e.jsx(Le,{placeholder:"Tìm kiếm theo tên, SKU...",allowClear:!0,enterButton:!0,onChange:t=>$(t.target.value)})}),e.jsx(a,{xs:12,md:5,children:e.jsxs(R,{style:{width:"100%"},placeholder:"Lọc theo danh mục",value:y,onChange:t=>_(t),children:[e.jsx(j,{value:"all",children:"Tất cả danh mục"}),Q.map(t=>e.jsx(j,{value:t,children:t},t))]})}),e.jsx(a,{xs:12,md:5,children:e.jsxs(R,{style:{width:"100%"},placeholder:"Lọc theo trạng thái",value:f,onChange:t=>F(t),children:[e.jsx(j,{value:"all",children:"Tất cả trạng thái"}),e.jsx(j,{value:"in_stock",children:"Còn hàng"}),e.jsx(j,{value:"low_stock",children:"Sắp hết"}),e.jsx(j,{value:"out_of_stock",children:"Hết hàng"})]})}),e.jsx(a,{xs:24,md:6,style:{textAlign:"right"},children:e.jsx(S,{children:e.jsx(i,{icon:e.jsx(je,{}),onClick:()=>{_("all"),F("all"),$("")},children:"Đặt lại bộ lọc"})})})]})}),e.jsx(V,{columns:Z,dataSource:U,rowKey:"id",pagination:{pageSize:10,showSizeChanger:!0,pageSizeOptions:["10","20","50"]}})]})})})]})};export{Be as default};
