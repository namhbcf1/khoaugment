import{j as e}from"./index-D0cJwDsb.js";import{r as i}from"./vendor-DD54NZMZ.js";import{e as D,C as N,f as T,T as de,l as he,B as c,aN as me,b1 as xe,I as ue,w as ge,x as pe,k as z,n as je,am as b,g as V,ab as ye,y as H,ae as A,b9 as K,D as ke,a4 as S,a5 as ve,M as E,q as fe,as as G,bs as Ce,J as F,s as l,aq as Ne,aE as Te,bB as be,ag as Se,H as Ie,u as we}from"./antd-pmzi8FkM.js";import"./utils-Db1EesZb.js";const{Title:I,Text:n}=de,{Search:X}=ue,{TabPane:Me}=we,qe=()=>{const[r,h]=i.useState([]),[j,O]=i.useState([]),[J,W]=i.useState([]),[x,w]=i.useState("all"),[g,_]=i.useState(""),[R,$]=i.useState([]),[Q,y]=i.useState(!1),[o,L]=i.useState(null),[k,P]=i.useState("grid"),[Z,u]=i.useState(!1),[v,M]=i.useState("cash"),[q,U]=i.useState(0),[Y,f]=i.useState(!1);i.useEffect(()=>{setTimeout(()=>{const s=ee(),t=[...new Set(s.map(a=>a.category))];O(s),$(s),W(t),f(!1)},1e3)},[]);const ee=()=>[{id:1,name:"Laptop Dell Inspiron 15",price:15e6,category:"Laptop",image:"https://via.placeholder.com/80",barcode:"8935236799892",stock:25},{id:2,name:'Màn hình Dell 24"',price:35e5,category:"Màn hình",image:"https://via.placeholder.com/80",barcode:"8935236799893",stock:42},{id:3,name:"Chuột không dây Logitech",price:45e4,category:"Phụ kiện",image:"https://via.placeholder.com/80",barcode:"8935236799894",stock:78},{id:4,name:"Bàn phím cơ AKKO",price:12e5,category:"Phụ kiện",image:"https://via.placeholder.com/80",barcode:"8935236799895",stock:15},{id:5,name:"Laptop Acer Nitro 5",price:22e6,category:"Laptop",image:"https://via.placeholder.com/80",barcode:"8935236799896",stock:12},{id:6,name:"Tai nghe Sony WH-1000XM4",price:58e5,category:"Âm thanh",image:"https://via.placeholder.com/80",barcode:"8935236799897",stock:8},{id:7,name:"Máy tính để bàn HP Pavilion",price:18e6,category:"PC",image:"https://via.placeholder.com/80",barcode:"8935236799898",stock:10},{id:8,name:"SSD Samsung 1TB",price:25e5,category:"Linh kiện",image:"https://via.placeholder.com/80",barcode:"8935236799899",stock:35},{id:9,name:"RAM Kingston 16GB DDR4",price:15e5,category:"Linh kiện",image:"https://via.placeholder.com/80",barcode:"8935236799900",stock:28},{id:10,name:"Card đồ họa NVIDIA RTX 3060",price:95e5,category:"Linh kiện",image:"https://via.placeholder.com/80",barcode:"8935236799901",stock:5},{id:11,name:"Máy in HP LaserJet",price:42e5,category:"Máy in",image:"https://via.placeholder.com/80",barcode:"8935236799902",stock:7},{id:12,name:"Webcam Logitech C920",price:18e5,category:"Phụ kiện",image:"https://via.placeholder.com/80",barcode:"8935236799903",stock:15}],se=[{id:1,name:"Nguyễn Văn A",phone:"0912345678",points:120},{id:2,name:"Trần Thị B",phone:"0923456789",points:85},{id:3,name:"Lê Văn C",phone:"0934567890",points:210},{id:4,name:"Phạm Thị D",phone:"0945678901",points:45},{id:5,name:"Hoàng Văn E",phone:"0956789012",points:150}];i.useEffect(()=>{let s=[...j];if(x!=="all"&&(s=s.filter(t=>t.category===x)),g){const t=g.toLowerCase();s=s.filter(a=>a.name.toLowerCase().includes(t)||a.barcode.includes(t))}$(s)},[x,g,j]);const B=s=>{const t=r.find(a=>a.id===s.id);if(t){if(t.quantity>=s.stock){l.warning(`Chỉ còn ${s.stock} sản phẩm trong kho!`);return}h(r.map(a=>a.id===s.id?{...a,quantity:a.quantity+1}:a))}else{if(s.stock<=0){l.warning("Sản phẩm đã hết hàng!");return}h([...r,{...s,quantity:1}])}l.success(`Đã thêm ${s.name} vào giỏ hàng`)},C=(s,t)=>{const a=j.find(m=>m.id===s);if(t>a.stock){l.warning(`Chỉ còn ${a.stock} sản phẩm trong kho!`);return}t<=0?h(r.filter(m=>m.id!==s)):h(r.map(m=>m.id===s?{...m,quantity:t}:m))},te=s=>{h(r.filter(t=>t.id!==s)),l.success("Đã xóa sản phẩm khỏi giỏ hàng")},ae=()=>{E.confirm({title:"Xóa giỏ hàng",content:"Bạn có chắc chắn muốn xóa toàn bộ giỏ hàng?",okText:"Xóa",cancelText:"Hủy",onOk:()=>{h([]),l.success("Đã xóa toàn bộ giỏ hàng")}})},ne=s=>{L(s),y(!1),l.success(`Đã chọn khách hàng: ${s.name}`)},p=()=>r.reduce((s,t)=>s+t.price*t.quantity,0),ce=()=>{f(!0),setTimeout(()=>{l.success("Thanh toán thành công!"),h([]),L(null),u(!1),f(!1)},1500)},d=s=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(s),ie=()=>{const s=p();return q>s?q-s:0},re=[{title:"Sản phẩm",dataIndex:"name",key:"name",render:(s,t)=>e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("img",{src:t.image,alt:s,style:{width:40,height:40,marginRight:10}}),e.jsxs("div",{children:[e.jsx("div",{children:s}),e.jsx("div",{style:{fontSize:"12px",color:"rgba(0, 0, 0, 0.45)"},children:t.barcode})]})]})},{title:"Giá",dataIndex:"price",key:"price",render:s=>d(s)},{title:"Số lượng",dataIndex:"quantity",key:"quantity",render:(s,t)=>e.jsxs("div",{className:"quantity-control",children:[e.jsx(c,{icon:e.jsx(be,{}),onClick:()=>C(t.id,t.quantity-1)}),e.jsx(G,{min:1,max:t.stock,value:s,onChange:a=>C(t.id,a)}),e.jsx(c,{icon:e.jsx(Se,{}),onClick:()=>C(t.id,t.quantity+1)})]})},{title:"Thành tiền",dataIndex:"price",key:"total",render:(s,t)=>d(s*t.quantity)},{title:"",key:"action",render:(s,t)=>e.jsx(c,{type:"text",danger:!0,icon:e.jsx(A,{}),onClick:()=>te(t.id)})}],le=()=>e.jsx(D,{gutter:[16,16],children:R.map(s=>e.jsx(N,{xs:12,sm:8,md:6,lg:6,xl:4,children:e.jsx(T,{hoverable:!0,cover:e.jsx("img",{alt:s.name,src:s.image,style:{height:100,objectFit:"contain"}}),onClick:()=>B(s),className:"product-card",children:e.jsxs("div",{className:"product-card-content",children:[e.jsx("div",{className:"product-card-title",children:s.name}),e.jsx("div",{className:"product-card-price",children:d(s.price)}),e.jsx("div",{className:"product-card-stock",children:e.jsx(b,{status:s.stock>10?"success":s.stock>0?"warning":"error",text:`${s.stock} trong kho`})})]})})},s.id))}),oe=()=>{const s=[{title:"Sản phẩm",dataIndex:"name",key:"name",render:(t,a)=>e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsx("img",{src:a.image,alt:t,style:{width:40,height:40,marginRight:10}}),e.jsxs("div",{children:[e.jsx("div",{children:t}),e.jsx("div",{style:{fontSize:"12px",color:"rgba(0, 0, 0, 0.45)"},children:a.barcode})]})]})},{title:"Danh mục",dataIndex:"category",key:"category",render:t=>e.jsx(Ie,{children:t})},{title:"Giá",dataIndex:"price",key:"price",render:t=>d(t)},{title:"Tồn kho",dataIndex:"stock",key:"stock",render:t=>e.jsx(b,{status:t>10?"success":t>0?"warning":"error",text:t})},{title:"Thao tác",key:"action",render:(t,a)=>e.jsx(c,{type:"primary",size:"small",onClick:()=>B(a),disabled:a.stock<=0,children:"Thêm"})}];return e.jsx(H,{columns:s,dataSource:R,rowKey:"id",pagination:{pageSize:6}})};return e.jsxs("div",{className:"pos-terminal",children:[e.jsxs(D,{gutter:[16,16],children:[e.jsx(N,{xs:24,lg:15,children:e.jsxs(T,{className:"full-height-card",children:[e.jsxs("div",{className:"pos-header",children:[e.jsx(I,{level:4,children:"Bán hàng"}),e.jsxs(he,{children:[e.jsx(c,{icon:e.jsx(me,{}),type:k==="grid"?"primary":"default",onClick:()=>P("grid")}),e.jsx(c,{icon:e.jsx(xe,{}),type:k==="list"?"primary":"default",onClick:()=>P("list")})]})]}),e.jsx("div",{className:"pos-search-bar",children:e.jsx(X,{placeholder:"Nhập tên hoặc quét mã vạch...",enterButton:e.jsx(pe,{}),prefix:e.jsx(ge,{}),onChange:s=>_(s.target.value),value:g})}),e.jsxs("div",{className:"pos-categories",children:[e.jsx(c,{type:x==="all"?"primary":"default",onClick:()=>w("all"),children:"Tất cả"}),J.map(s=>e.jsx(c,{type:x===s?"primary":"default",onClick:()=>w(s),children:s},s))]}),e.jsx(z,{}),e.jsx("div",{className:"pos-products",children:k==="grid"?le():oe()})]})}),e.jsx(N,{xs:24,lg:9,children:e.jsxs(T,{className:"full-height-card cart-section",children:[e.jsxs("div",{className:"cart-header",children:[e.jsxs("div",{className:"cart-title",children:[e.jsx(je,{}),e.jsx("span",{children:"Giỏ hàng"}),e.jsx(b,{count:r.length,showZero:!0})]}),e.jsx("div",{className:"customer-section",children:e.jsx(c,{icon:e.jsx(V,{}),onClick:()=>y(!0),children:o?o.name:"Chọn khách hàng"})})]}),e.jsx("div",{className:"cart-content",children:r.length===0?e.jsxs("div",{className:"empty-cart",children:[e.jsx(ye,{style:{fontSize:48,color:"#d9d9d9"}}),e.jsx(n,{type:"secondary",children:"Giỏ hàng trống"})]}):e.jsx(H,{columns:re,dataSource:r,rowKey:"id",pagination:!1,size:"small"})}),e.jsxs("div",{className:"cart-footer",children:[e.jsxs("div",{className:"cart-summary",children:[e.jsxs("div",{className:"cart-summary-row",children:[e.jsx(n,{children:"Tổng sản phẩm:"}),e.jsxs(n,{children:[r.reduce((s,t)=>s+t.quantity,0)," sản phẩm"]})]}),e.jsxs("div",{className:"cart-summary-row",children:[e.jsx(n,{children:"Tổng tiền:"}),e.jsx(n,{strong:!0,className:"total-amount",children:d(p())})]}),o&&e.jsxs("div",{className:"cart-summary-row",children:[e.jsx(n,{children:"Khách hàng:"}),e.jsxs(n,{children:[o.name," (",o.points," điểm)"]})]})]}),e.jsxs("div",{className:"cart-actions",children:[e.jsx(c,{danger:!0,icon:e.jsx(A,{}),onClick:ae,disabled:r.length===0,children:"Xóa tất cả"}),e.jsx(c,{type:"primary",icon:e.jsx(K,{}),size:"large",onClick:()=>u(!0),disabled:r.length===0,children:"Thanh toán"})]})]})]})})]}),e.jsxs(ke,{title:"Chọn khách hàng",placement:"right",onClose:()=>y(!1),visible:Q,width:400,children:[e.jsx("div",{style:{marginBottom:16},children:e.jsx(X,{placeholder:"Tìm kiếm theo tên hoặc SĐT",enterButton:!0})}),e.jsx(S,{itemLayout:"horizontal",dataSource:se,renderItem:s=>e.jsx(S.Item,{actions:[e.jsx(c,{type:"primary",size:"small",onClick:()=>ne(s),children:"Chọn"})],children:e.jsx(S.Item.Meta,{avatar:e.jsx(ve,{icon:e.jsx(V,{})}),title:s.name,description:e.jsxs("div",{children:[e.jsxs("div",{children:["SĐT: ",s.phone]}),e.jsxs("div",{children:["Điểm tích lũy: ",s.points]})]})})})})]}),e.jsx(E,{title:"Thanh toán",visible:Z,onCancel:()=>u(!1),footer:null,width:600,children:e.jsxs("div",{className:"checkout-modal",children:[e.jsxs("div",{className:"checkout-summary",children:[e.jsx(I,{level:4,children:"Tổng quan đơn hàng"}),e.jsxs("div",{className:"checkout-items",children:[e.jsxs("div",{className:"checkout-item-header",children:[e.jsx(n,{strong:!0,children:"Sản phẩm"}),e.jsx(n,{strong:!0,children:"SL"}),e.jsx(n,{strong:!0,children:"Thành tiền"})]}),r.map(s=>e.jsxs("div",{className:"checkout-item",children:[e.jsx(n,{children:s.name}),e.jsx(n,{children:s.quantity}),e.jsx(n,{children:d(s.price*s.quantity)})]},s.id))]}),e.jsx(z,{}),e.jsxs("div",{className:"checkout-total",children:[e.jsx(n,{strong:!0,children:"Tổng tiền:"}),e.jsx(n,{strong:!0,className:"checkout-total-amount",children:d(p())})]}),o&&e.jsxs("div",{className:"checkout-customer",children:[e.jsxs(n,{children:["Khách hàng: ",o.name]}),e.jsxs(n,{children:["Điểm tích lũy: ",o.points]})]})]}),e.jsxs("div",{className:"payment-section",children:[e.jsx(I,{level:4,children:"Phương thức thanh toán"}),e.jsxs("div",{className:"payment-methods",children:[e.jsxs("div",{className:"payment-method-selection",children:[e.jsx(c,{type:v==="cash"?"primary":"default",icon:e.jsx(fe,{}),size:"large",onClick:()=>M("cash"),children:"Tiền mặt"}),e.jsx(c,{type:v==="card"?"primary":"default",icon:e.jsx(K,{}),size:"large",onClick:()=>M("card"),children:"Thẻ"})]}),v==="cash"&&e.jsxs("div",{className:"cash-payment",children:[e.jsxs("div",{className:"amount-input",children:[e.jsx(n,{children:"Tiền khách đưa:"}),e.jsx(G,{style:{width:"100%"},formatter:s=>`${s}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:s=>s.replace(/\$\s?|(,*)/g,""),size:"large",min:p(),onChange:U})]}),e.jsxs("div",{className:"change-amount",children:[e.jsx(n,{children:"Tiền thối lại:"}),e.jsx(n,{strong:!0,children:d(ie())})]})]})]}),e.jsxs("div",{className:"payment-actions",children:[e.jsx(c,{onClick:()=>u(!1),children:"Hủy"}),e.jsx(c,{type:"primary",icon:e.jsx(Ce,{}),size:"large",loading:Y,onClick:ce,children:"Hoàn tất thanh toán"}),e.jsx(F,{title:"Lưu đơn chờ",children:e.jsx(c,{icon:e.jsx(Ne,{}),onClick:()=>{l.success("Đã lưu đơn hàng chờ"),u(!1)},children:"Lưu"})}),e.jsx(F,{title:"In hóa đơn",children:e.jsx(c,{icon:e.jsx(Te,{}),onClick:()=>l.info("Đang in hóa đơn..."),children:"In"})})]})]})]})})]})};export{qe as default};
