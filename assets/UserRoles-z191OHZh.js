import{j as e}from"./index-CI5lv9mG.js";import{r as n}from"./vendor-DD54NZMZ.js";import{F as i,am as A,l as m,B as a,ak as M,s as o,bf as ie,aF as E,ae as F,T as ae,bb as re,f,u as U,ag as V,y as T,r as $,g as _,e as ne,C as le,A as w,a4 as l,a5 as oe,a3 as D,h as ce,M as S,I as u,k as de,bm as me,O as ue,H as he,an as pe,aN as ye,b2 as xe,aK as ge,ab as fe,w as je,aO as ke,bn as ve}from"./antd-pmzi8FkM.js";import"./utils-Db1EesZb.js";const{Title:O,Text:_e,Paragraph:we}=ae,{TabPane:C}=U,{TextArea:Se}=u,{DirectoryTree:Ce}=me,c=[{id:1,name:"Administrator",description:"Full system access with all permissions",users:3,permissions:["all"],isSystem:!0,createdAt:"2023-01-15"},{id:2,name:"Manager",description:"Access to manage store operations, reports, and staff",users:5,permissions:["dashboard_view","products_view","products_edit","orders_view","orders_edit","customers_view","customers_edit","reports_view","staff_view","staff_edit"],isSystem:!0,createdAt:"2023-01-15"},{id:3,name:"Cashier",description:"POS access for processing sales and managing basic customer data",users:12,permissions:["pos_access","orders_view","orders_create","customers_view","customers_create"],isSystem:!0,createdAt:"2023-01-15"},{id:4,name:"Inventory Specialist",description:"Manage product inventory and stock levels",users:4,permissions:["products_view","products_edit","inventory_view","inventory_edit","reports_view"],isSystem:!1,createdAt:"2023-03-22"},{id:5,name:"Marketing Specialist",description:"Manage marketing campaigns and customer communications",users:2,permissions:["dashboard_view","customers_view","marketing_view","marketing_edit","reports_view"],isSystem:!1,createdAt:"2023-05-10"},{id:6,name:"Accountant",description:"Access to financial reports and transactions",users:1,permissions:["dashboard_view","orders_view","reports_view","finances_view","finances_edit"],isSystem:!1,createdAt:"2023-06-18"}],Ie=[{id:1,name:"Nguyen Van A",email:"admin@truongphat.com",role:"Administrator",status:"active",lastLogin:"2023-10-07 09:45",createdAt:"2023-01-15"},{id:2,name:"Tran Thi B",email:"manager@truongphat.com",role:"Manager",status:"active",lastLogin:"2023-10-06 17:30",createdAt:"2023-01-15"},{id:3,name:"Le Van C",email:"cashier1@truongphat.com",role:"Cashier",status:"active",lastLogin:"2023-10-07 14:22",createdAt:"2023-01-20"},{id:4,name:"Pham Thi D",email:"cashier2@truongphat.com",role:"Cashier",status:"active",lastLogin:"2023-10-07 13:15",createdAt:"2023-02-05"},{id:5,name:"Hoang Van E",email:"inventory@truongphat.com",role:"Inventory Specialist",status:"active",lastLogin:"2023-10-05 11:30",createdAt:"2023-03-22"},{id:6,name:"Vu Thi F",email:"marketing@truongphat.com",role:"Marketing Specialist",status:"inactive",lastLogin:"2023-09-28 14:45",createdAt:"2023-05-10"},{id:7,name:"Dao Van G",email:"accountant@truongphat.com",role:"Accountant",status:"active",lastLogin:"2023-10-06 09:20",createdAt:"2023-06-18"}],N=[{title:"Dashboard",key:"dashboard",children:[{title:"View Dashboard",key:"dashboard_view"},{title:"Edit Dashboard Widgets",key:"dashboard_edit"}]},{title:"Products",key:"products",children:[{title:"View Products",key:"products_view"},{title:"Create Products",key:"products_create"},{title:"Edit Products",key:"products_edit"},{title:"Delete Products",key:"products_delete"},{title:"Manage Categories",key:"categories_manage"},{title:"Manage Product Attributes",key:"attributes_manage"}]},{title:"Inventory",key:"inventory",children:[{title:"View Inventory",key:"inventory_view"},{title:"Edit Inventory",key:"inventory_edit"},{title:"Manage Stock Transfers",key:"inventory_transfer"},{title:"Manage Suppliers",key:"suppliers_manage"},{title:"Manage Purchase Orders",key:"purchase_orders_manage"}]},{title:"Orders",key:"orders",children:[{title:"View Orders",key:"orders_view"},{title:"Create Orders",key:"orders_create"},{title:"Edit Orders",key:"orders_edit"},{title:"Delete Orders",key:"orders_delete"},{title:"Process Refunds",key:"orders_refund"},{title:"Manage Shipping",key:"shipping_manage"}]},{title:"Customers",key:"customers",children:[{title:"View Customers",key:"customers_view"},{title:"Create Customers",key:"customers_create"},{title:"Edit Customers",key:"customers_edit"},{title:"Delete Customers",key:"customers_delete"},{title:"Manage Customer Groups",key:"customer_groups_manage"},{title:"Manage Loyalty Programs",key:"loyalty_manage"}]},{title:"Staff",key:"staff",children:[{title:"View Staff",key:"staff_view"},{title:"Create Staff",key:"staff_create"},{title:"Edit Staff",key:"staff_edit"},{title:"Delete Staff",key:"staff_delete"},{title:"Manage Commissions",key:"commissions_manage"},{title:"Manage Shifts",key:"shifts_manage"}]},{title:"Reports",key:"reports",children:[{title:"View Reports",key:"reports_view"},{title:"Export Reports",key:"reports_export"},{title:"View Financial Reports",key:"finances_view"},{title:"Edit Financial Data",key:"finances_edit"}]},{title:"Marketing",key:"marketing",children:[{title:"View Marketing",key:"marketing_view"},{title:"Edit Marketing",key:"marketing_edit"},{title:"Manage Promotions",key:"promotions_manage"},{title:"Manage Email Campaigns",key:"email_campaigns_manage"}]},{title:"POS",key:"pos",children:[{title:"Access POS",key:"pos_access"},{title:"Apply Discounts",key:"pos_discounts"},{title:"Void Transactions",key:"pos_void"},{title:"Open Cash Drawer",key:"pos_cash_drawer"}]},{title:"Settings",key:"settings",children:[{title:"View Settings",key:"settings_view"},{title:"Edit Settings",key:"settings_edit"},{title:"Manage User Roles",key:"roles_manage"},{title:"Manage Integrations",key:"integrations_manage"},{title:"Access System Logs",key:"logs_access"}]}],Me=()=>{const[L,B]=n.useState("roles"),[K,j]=n.useState(!1),[q,k]=n.useState(!1),[H,h]=n.useState(!1),[r,I]=n.useState(null),[p,Y]=n.useState(null),[y]=i.useForm(),[x]=i.useForm(),[b,d]=n.useState([]),[z,G]=n.useState(["dashboard","products"]),g=(s=null)=>{I(s),s?(y.setFieldsValue({name:s.name,description:s.description}),d(s.permissions)):(y.resetFields(),d([])),j(!0)},P=(s=null)=>{Y(s),s?x.setFieldsValue({name:s.name,email:s.email,role:s.role,status:s.status==="active"}):x.resetFields(),k(!0)},R=s=>{I(s),h(!0)},W=()=>{y.validateFields().then(s=>{console.log("Form values:",s),console.log("Selected permissions:",b);const t=r?"updated":"created";o.success(`Role ${s.name} ${t} successfully`),j(!1)}).catch(s=>{console.log("Form validation failed:",s)})},J=()=>{x.validateFields().then(s=>{console.log("Form values:",s);const t=p?"updated":"created";o.success(`User ${s.name} ${t} successfully`),k(!1)}).catch(s=>{console.log("Form validation failed:",s)})},Q=s=>{if(s.isSystem){o.error("System roles cannot be deleted");return}o.success(`Role ${s.name} deleted successfully`)},X=s=>{o.success(`User ${s.name} deleted successfully`)},Z=s=>{d(s)},ee=[{title:"Role Name",dataIndex:"name",key:"name",render:(s,t)=>e.jsxs(m,{children:[e.jsx(_e,{strong:!0,children:s}),t.isSystem&&e.jsx(he,{color:"blue",children:"System"})]})},{title:"Description",dataIndex:"description",key:"description"},{title:"Users",dataIndex:"users",key:"users",sorter:(s,t)=>s.users-t.users},{title:"Created",dataIndex:"createdAt",key:"createdAt"},{title:"Actions",key:"actions",render:(s,t)=>e.jsxs(m,{children:[e.jsx(a,{icon:e.jsx(pe,{}),onClick:()=>R(t),children:"Permissions"}),e.jsx(a,{icon:e.jsx(M,{}),onClick:()=>g(t),children:"Edit"}),e.jsx(E,{title:"Are you sure you want to delete this role?",onConfirm:()=>Q(t),okText:"Yes",cancelText:"No",disabled:t.isSystem,children:e.jsx(a,{danger:!0,icon:e.jsx(F,{}),disabled:t.isSystem,children:"Delete"})})]})}],se=[{title:"Name",dataIndex:"name",key:"name"},{title:"Email",dataIndex:"email",key:"email"},{title:"Role",dataIndex:"role",key:"role",filters:c.map(s=>({text:s.name,value:s.name})),onFilter:(s,t)=>t.role===s},{title:"Status",dataIndex:"status",key:"status",render:s=>s==="active"?e.jsx(A,{status:"success",text:"Active"}):e.jsx(A,{status:"default",text:"Inactive"}),filters:[{text:"Active",value:"active"},{text:"Inactive",value:"inactive"}],onFilter:(s,t)=>t.status===s},{title:"Last Login",dataIndex:"lastLogin",key:"lastLogin"},{title:"Created",dataIndex:"createdAt",key:"createdAt"},{title:"Actions",key:"actions",render:(s,t)=>e.jsxs(m,{children:[e.jsx(a,{icon:e.jsx(M,{}),onClick:()=>P(t),children:"Edit"}),e.jsx(a,{icon:e.jsx(ie,{}),onClick:()=>{o.success("Password reset link sent to user")},children:"Reset Password"}),e.jsx(E,{title:"Are you sure you want to delete this user?",onConfirm:()=>X(t),okText:"Yes",cancelText:"No",children:e.jsx(a,{danger:!0,icon:e.jsx(F,{}),children:"Delete"})})]})}],te=s=>({dashboard:e.jsx(ve,{}),products:e.jsx(ke,{}),inventory:e.jsx(je,{}),orders:e.jsx(fe,{}),customers:e.jsx(_,{}),staff:e.jsx($,{}),reports:e.jsx(ge,{}),marketing:e.jsx(NotificationOutlined,{}),pos:e.jsx(ShoppingCartOutlined,{}),settings:e.jsx(xe,{})})[s]||e.jsx(ye,{});return e.jsxs("div",{style:{padding:"24px"},children:[e.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:24},children:e.jsxs(O,{level:2,children:[e.jsx(re,{})," User Roles & Permissions"]})}),e.jsx(f,{children:e.jsxs(U,{activeKey:L,onChange:B,children:[e.jsxs(C,{tab:e.jsxs("span",{children:[e.jsx($,{})," Roles"]}),children:[e.jsx("div",{style:{marginBottom:16,display:"flex",justifyContent:"flex-end"},children:e.jsx(a,{type:"primary",icon:e.jsx(V,{}),onClick:()=>g(),children:"Create New Role"})}),e.jsx(T,{columns:ee,dataSource:c,rowKey:"id",pagination:!1})]},"roles"),e.jsxs(C,{tab:e.jsxs("span",{children:[e.jsx(_,{})," Users"]}),children:[e.jsx("div",{style:{marginBottom:16,display:"flex",justifyContent:"flex-end"},children:e.jsx(a,{type:"primary",icon:e.jsx(V,{}),onClick:()=>P(),children:"Create New User"})}),e.jsx(T,{columns:se,dataSource:Ie,rowKey:"id",pagination:!1})]},"users"),e.jsx(C,{tab:e.jsxs("span",{children:[e.jsx(ce,{})," Permission Settings"]}),children:e.jsx(ne,{gutter:24,children:e.jsxs(le,{span:24,children:[e.jsx(w,{message:"Permission Management",description:"Configure default permissions for system roles and manage permission inheritance rules.",type:"info",showIcon:!0,style:{marginBottom:24}}),e.jsx(f,{title:"System Roles",style:{marginBottom:24},children:e.jsx(l,{itemLayout:"horizontal",dataSource:c.filter(s=>s.isSystem),renderItem:s=>e.jsx(l.Item,{actions:[e.jsx(a,{onClick:()=>R(s),children:"View Permissions"},"view"),e.jsx(a,{onClick:()=>g(s),children:"Edit"},"edit")],children:e.jsx(l.Item.Meta,{avatar:e.jsx(oe,{icon:e.jsx(_,{})}),title:s.name,description:s.description})})})}),e.jsx(f,{title:"Permission Inheritance",children:e.jsxs(i,{layout:"vertical",children:[e.jsx(i.Item,{label:"Enable Permission Inheritance",name:"inheritPermissions",valuePropName:"checked",initialValue:!0,children:e.jsx(D,{})}),e.jsx(i.Item,{label:"Default Role for New Users",name:"defaultRole",initialValue:"Cashier",children:e.jsx(Select,{children:c.map(s=>e.jsx(Select.Option,{value:s.name,children:s.name},s.id))})}),e.jsx(i.Item,{label:"Role Hierarchy",name:"roleHierarchy",initialValue:["Administrator","Manager","Cashier"],children:e.jsx(Select,{mode:"multiple",children:c.map(s=>e.jsx(Select.Option,{value:s.name,children:s.name},s.id))})}),e.jsx(a,{type:"primary",children:"Save Permission Settings"})]})})]})})},"permissions")]})}),e.jsx(S,{title:r?`Edit Role: ${r.name}`:"Create New Role",visible:K,onCancel:()=>j(!1),onOk:W,width:800,children:e.jsxs(i,{form:y,layout:"vertical",children:[e.jsx(i.Item,{name:"name",label:"Role Name",rules:[{required:!0,message:"Please enter a role name"}],children:e.jsx(u,{placeholder:"e.g., Store Manager"})}),e.jsx(i.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter a description"}],children:e.jsx(Se,{placeholder:"Describe the purpose and responsibilities of this role",rows:3})}),e.jsx(de,{children:"Permissions"}),e.jsx(w,{message:"Select Permissions",description:"Choose the permissions that users with this role will have. You can select individual permissions or entire categories.",type:"info",showIcon:!0,style:{marginBottom:16}}),e.jsx(Ce,{checkable:!0,onCheck:Z,checkedKeys:b,treeData:N,expandedKeys:z,onExpand:G,defaultExpandAll:!0,height:400,style:{overflowY:"auto"}}),e.jsx("div",{style:{marginTop:16},children:e.jsxs(m,{children:[e.jsx(a,{onClick:()=>d(["all"]),children:"Select All"}),e.jsx(a,{onClick:()=>d([]),children:"Clear All"})]})})]})}),e.jsx(S,{title:p?`Edit User: ${p.name}`:"Create New User",visible:q,onCancel:()=>k(!1),onOk:J,children:e.jsxs(i,{form:x,layout:"vertical",children:[e.jsx(i.Item,{name:"name",label:"Full Name",rules:[{required:!0,message:"Please enter the user's name"}],children:e.jsx(u,{placeholder:"e.g., Nguyen Van A"})}),e.jsx(i.Item,{name:"email",label:"Email Address",rules:[{required:!0,message:"Please enter an email address"},{type:"email",message:"Please enter a valid email address"}],children:e.jsx(u,{placeholder:"e.g., user@example.com"})}),e.jsx(i.Item,{name:"role",label:"Role",rules:[{required:!0,message:"Please select a role"}],children:e.jsx(Select,{placeholder:"Select a role",children:c.map(s=>e.jsx(Select.Option,{value:s.name,children:s.name},s.id))})}),!p&&e.jsx(i.Item,{name:"password",label:"Password",rules:[{required:!0,message:"Please enter a password"}],children:e.jsx(u.Password,{placeholder:"Enter password"})}),e.jsx(i.Item,{name:"status",label:"Status",valuePropName:"checked",initialValue:!0,children:e.jsx(D,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})}),e.jsx(S,{title:`Permissions: ${r?.name}`,visible:H,onCancel:()=>h(!1),footer:[e.jsx(a,{onClick:()=>h(!1),children:"Close"},"close"),e.jsx(a,{type:"primary",onClick:()=>{h(!1),g(r)},children:"Edit Permissions"},"edit")],width:800,children:r&&e.jsxs(e.Fragment,{children:[e.jsx(we,{children:r.description}),r.permissions.includes("all")?e.jsx(w,{message:"Full System Access",description:"This role has all permissions enabled and can access all features of the system.",type:"success",showIcon:!0,style:{marginBottom:16}}):e.jsxs("div",{children:[e.jsx(O,{level:5,children:"Granted Permissions:"}),e.jsx(l,{grid:{gutter:16,column:2},dataSource:N,renderItem:s=>{const t=s.children.filter(v=>r.permissions.includes(v.key));return t.length===0?null:e.jsx(l.Item,{children:e.jsx(f,{title:e.jsxs(m,{children:[te(s.key),s.title]}),size:"small",children:e.jsx(l,{size:"small",dataSource:t,renderItem:v=>e.jsxs(l.Item,{children:[e.jsx(ue,{style:{color:"#52c41a",marginRight:8}}),v.title]})})})})}})]})]})})]})};export{Me as default};
