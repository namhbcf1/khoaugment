import{j as e}from"./index-CI5lv9mG.js";import{r as c}from"./vendor-DD54NZMZ.js";import{z as n,f as o,e as h,C as l,T as L,$ as B,a0 as K,B as b,R as z,N as X,m as x,a9 as C,aa as T,n as Q,q as W,Q as J,g as k,S as g,a8 as U,u as S,a6 as Z,aB as _,y as ee,H as te}from"./antd-pmzi8FkM.js";import{m as ae,P as I}from"./index-HZU7_8u2.js";import{C as se}from"./index-BAR-SsWl.js";import"./utils-Db1EesZb.js";import"./defaultLocale-Baf4yPCw.js";var re=ae("Line");const{Title:ne,Text:le}=L,{RangePicker:oe}=K,{Option:u}=B,{TabPane:O}=S,me=()=>{const[r,m]=c.useState(!0),[y,j]=c.useState("month"),[p,d]=c.useState([n().subtract(30,"days"),n()]),[a,w]=c.useState({summary:{},orderTrends:[],orderByStatus:[],orderByChannel:[],orderByTime:[],topCustomers:[]});c.useEffect(()=>{m(!0),setTimeout(()=>{const t=R();w(t),m(!1)},1500)},[y,p]);const R=()=>({summary:{totalOrders:356,completedOrders:312,pendingOrders:24,cancelledOrders:20,avgProcessingTime:18,totalOrderValue:785265e4,avgOrderValue:22058427,totalOrderGrowth:12.5,avgOrderValueGrowth:4.8},orderTrends:M(),orderByStatus:[{status:"Hoàn thành",value:312,color:"#52c41a"},{status:"Đang xử lý",value:24,color:"#1890ff"},{status:"Hủy",value:20,color:"#ff4d4f"}],orderByChannel:[{channel:"Cửa hàng",value:245,percentage:68.8},{channel:"Online",value:65,percentage:18.3},{channel:"Đại lý",value:46,percentage:12.9}],orderByTime:D(),topCustomers:V()}),M=()=>{const t=[],s=n().subtract(30,"days");for(let i=0;i<30;i++){const f=s.clone().add(i,"days").format("YYYY-MM-DD");t.push({date:f,"Hoàn thành":Math.floor(Math.random()*15)+5,"Đang xử lý":Math.floor(Math.random()*3),Hủy:Math.floor(Math.random()*2)})}return t},D=()=>{const t=[];for(let s=0;s<24;s++)t.push({hour:`${s}:00`,orders:Math.floor(Math.random()*30)+(s>=9&&s<=20?10:0)});return t},V=()=>[{id:1,name:"Nguyễn Văn A",orders:12,value:658e5,loyalty:"Vàng"},{id:2,name:"Trần Thị B",orders:8,value:453e5,loyalty:"Bạc"},{id:3,name:"Lê Văn C",orders:7,value:385e5,loyalty:"Bạc"},{id:4,name:"Phạm Minh D",orders:6,value:527e5,loyalty:"Vàng"},{id:5,name:"Hoàng Thị E",orders:5,value:249e5,loyalty:"Đồng"}],P={data:a.orderTrends,xField:"date",yField:"value",seriesField:"type",yAxis:{title:{text:"Số đơn hàng"}},xAxis:{type:"time",tickCount:10},legend:{position:"top"},smooth:!0,animation:{appear:{animation:"path-in",duration:1e3}},isStack:!1,slider:{start:0,end:1,trendCfg:{isArea:!1}},meta:{value:{alias:"Số đơn"},type:{alias:"Trạng thái"}}},$=a.orderTrends.reduce((t,s)=>{const{date:i,...f}=s;return Object.entries(f).forEach(([N,E])=>{t.push({date:i,type:N,value:E})}),t},[]),F={data:a.orderByStatus,angleField:"value",colorField:"status",radius:.75,label:{type:"spider",content:"{name}: {percentage}"},color:({status:t})=>{const s=a.orderByStatus.find(i=>i.status===t);return s?s.color:"#1890ff"},interactions:[{type:"element-active"}]},G={data:a.orderByChannel,angleField:"value",colorField:"channel",radius:.75,label:{type:"spider",content:"{name}: {percentage}"},interactions:[{type:"element-active"}]},H={data:a.orderByTime,xField:"hour",yField:"orders",color:"#1890ff",label:{position:"top",style:{fill:"#1890ff",opacity:.6}},xAxis:{label:{autoHide:!0,autoRotate:!1}},meta:{hour:{alias:"Giờ"},orders:{alias:"Đơn hàng"}}},v=t=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(t),Y=t=>{switch(j(t),t){case"week":d([n().subtract(7,"days"),n()]);break;case"month":d([n().subtract(30,"days"),n()]);break;case"quarter":d([n().subtract(90,"days"),n()]);break;case"year":d([n().subtract(365,"days"),n()]);break;default:d([n().subtract(30,"days"),n()])}},q=t=>{t&&t.length===2&&(d(t),j("custom"))},A=[{title:"Khách hàng",dataIndex:"name",key:"name"},{title:"Số đơn hàng",dataIndex:"orders",key:"orders",align:"right"},{title:"Giá trị",dataIndex:"value",key:"value",align:"right",render:t=>v(t)},{title:"Hạng",dataIndex:"loyalty",key:"loyalty",align:"center",render:t=>{let s;switch(t){case"Vàng":s="gold";break;case"Bạc":s="silver";break;case"Đồng":s="#cd7f32";break;default:s="default"}return e.jsx(te,{color:s,children:t})}}];return e.jsxs("div",{className:"order-analytics",children:[e.jsx(o,{bordered:!1,className:"header-card",children:e.jsxs(h,{justify:"space-between",align:"middle",gutter:[24,24],children:[e.jsxs(l,{xs:24,sm:12,children:[e.jsx(ne,{level:3,children:"Phân tích đơn hàng"}),e.jsx(le,{type:"secondary",children:"Thống kê và phân tích đơn hàng trong khoảng thời gian đã chọn"})]}),e.jsx(l,{xs:24,sm:12,children:e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",flexWrap:"wrap"},children:[e.jsxs(B,{style:{width:120},value:y,onChange:Y,disabled:r,children:[e.jsx(u,{value:"week",children:"7 ngày qua"}),e.jsx(u,{value:"month",children:"30 ngày qua"}),e.jsx(u,{value:"quarter",children:"90 ngày qua"}),e.jsx(u,{value:"year",children:"365 ngày qua"}),y==="custom"&&e.jsx(u,{value:"custom",children:"Tùy chỉnh"})]}),e.jsx(oe,{value:p,onChange:q,format:"DD/MM/YYYY",allowClear:!1,disabled:r}),e.jsx(b,{icon:e.jsx(z,{}),onClick:()=>m(!0),loading:r,children:"Làm mới"}),e.jsx(b,{icon:e.jsx(X,{}),disabled:r,children:"Xuất báo cáo"})]})})]})}),e.jsxs(h,{gutter:[24,24],style:{marginTop:"24px"},children:[e.jsx(l,{xs:24,sm:12,lg:6,children:e.jsx(o,{bordered:!1,loading:r,children:e.jsx(x,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(Q,{}),e.jsx("span",{children:"Tổng đơn hàng"})]}),value:a.summary.totalOrders,suffix:e.jsxs("div",{style:{fontSize:"14px",color:a.summary.totalOrderGrowth>=0?"#52c41a":"#f5222d"},children:[a.summary.totalOrderGrowth>=0?e.jsx(C,{}):e.jsx(T,{})," ",Math.abs(a.summary.totalOrderGrowth),"%"]})})})}),e.jsx(l,{xs:24,sm:12,lg:6,children:e.jsx(o,{bordered:!1,loading:r,children:e.jsx(x,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(W,{}),e.jsx("span",{children:"Giá trị trung bình"})]}),value:a.summary.avgOrderValue,precision:0,formatter:t=>v(t),suffix:e.jsxs("div",{style:{fontSize:"14px",color:a.summary.avgOrderValueGrowth>=0?"#52c41a":"#f5222d"},children:[a.summary.avgOrderValueGrowth>=0?e.jsx(C,{}):e.jsx(T,{})," ",Math.abs(a.summary.avgOrderValueGrowth),"%"]})})})}),e.jsx(l,{xs:24,sm:12,lg:6,children:e.jsx(o,{bordered:!1,loading:r,children:e.jsx(x,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(J,{}),e.jsx("span",{children:"Thời gian xử lý TB"})]}),value:a.summary.avgProcessingTime,suffix:"phút"})})}),e.jsx(l,{xs:24,sm:12,lg:6,children:e.jsx(o,{bordered:!1,loading:r,children:e.jsx(x,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(k,{}),e.jsx("span",{children:"Tỷ lệ hoàn thành"})]}),value:a.summary.completedOrders/a.summary.totalOrders*100,precision:1,suffix:"%",valueStyle:{color:"#52c41a"}})})})]}),e.jsx(h,{gutter:[24,24],style:{marginTop:"24px"},children:e.jsx(l,{xs:24,children:e.jsx(o,{title:e.jsxs("span",{children:[e.jsx(U,{})," Xu hướng đơn hàng"]}),bordered:!1,loading:r,children:r?e.jsx("div",{style:{height:400,display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(g,{})}):e.jsx(re,{...P,data:$,height:400})})})}),e.jsxs(h,{gutter:[24,24],style:{marginTop:"24px"},children:[e.jsx(l,{xs:24,lg:12,children:e.jsx(o,{title:e.jsxs("span",{children:[e.jsx(Z,{})," Phân tích đơn hàng"]}),bordered:!1,loading:r,children:e.jsxs(S,{defaultActiveKey:"status",children:[e.jsx(O,{tab:"Theo trạng thái",children:r?e.jsx("div",{style:{height:300,display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(g,{})}):e.jsx(I,{...F,height:300})},"status"),e.jsx(O,{tab:"Theo kênh bán hàng",children:r?e.jsx("div",{style:{height:300,display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(g,{})}):e.jsx(I,{...G,height:300})},"channel")]})})}),e.jsx(l,{xs:24,lg:12,children:e.jsx(o,{title:e.jsxs("span",{children:[e.jsx(_,{})," Đơn hàng theo giờ"]}),bordered:!1,loading:r,children:r?e.jsx("div",{style:{height:358,display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(g,{})}):e.jsx(se,{...H,height:358})})})]}),e.jsx(h,{gutter:[24,24],style:{marginTop:"24px"},children:e.jsx(l,{xs:24,children:e.jsx(o,{title:e.jsxs("span",{children:[e.jsx(k,{})," Khách hàng mua nhiều nhất"]}),bordered:!1,loading:r,children:e.jsx(ee,{dataSource:a.topCustomers,columns:A,pagination:!1,rowKey:"id"})})})})]})};export{me as default};
