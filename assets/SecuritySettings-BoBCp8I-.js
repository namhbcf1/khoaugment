import{j as e}from"./index-CI5lv9mG.js";import{r}from"./vendor-DD54NZMZ.js";import{F as h,f as s,T as te,bb as ne,u as N,e as l,C as i,I as L,h as R,bf as M,B as d,aq as se,a4 as x,O as ie,k as y,d as B,Z as c,am as f,a3 as I,A as he,N as ce,E as ae,bo as re,y as v,$ as V,aM as le,aR as de,z as oe,_ as k,b6 as xe,s as o,M as ue,l as me,aF as F,bp as pe,H as ge}from"./antd-pmzi8FkM.js";import"./utils-Db1EesZb.js";const{Title:je,Text:T,Paragraph:u}=te,{TabPane:m}=N,{Option:p}=V,{Password:C}=L,ve=()=>{const[$,H]=r.useState("password"),[w]=h.useForm(),[g,b]=r.useState(!1),[K,P]=r.useState(!1),[Q,D]=r.useState(30),[X,z]=r.useState(!0),[S,E]=r.useState([{id:1,ip:"192.168.1.100",reason:"Nhiều lần đăng nhập thất bại",blockedAt:"2023-08-15 14:30:22"},{id:2,ip:"45.23.126.42",reason:"Hoạt động đáng ngờ",blockedAt:"2023-09-02 09:15:40"}]),[j,A]=r.useState([{id:1,device:"Chrome / Windows 10",ip:"192.168.1.5",location:"Hòa Bình, Vietnam",lastActive:"2023-10-12 10:30:45",current:!0},{id:2,device:"Safari / MacOS",ip:"192.168.1.10",location:"Hòa Bình, Vietnam",lastActive:"2023-10-11 16:45:22",current:!1},{id:3,device:"Chrome / Android",ip:"115.72.45.120",location:"Hà Nội, Vietnam",lastActive:"2023-10-10 09:15:33",current:!1}]),[O,ke]=r.useState([{id:1,action:"Đăng nhập thành công",user:"admin",ip:"192.168.1.5",device:"Chrome / Windows 10",timestamp:"2023-10-12 10:30:45",status:"success"},{id:2,action:"Thay đổi mật khẩu",user:"admin",ip:"192.168.1.5",device:"Chrome / Windows 10",timestamp:"2023-10-10 15:22:30",status:"success"},{id:3,action:"Đăng nhập thất bại",user:"unknown",ip:"45.23.126.42",device:"Unknown",timestamp:"2023-09-02 09:15:40",status:"error"},{id:4,action:"Thiết lập xác thực hai lớp",user:"admin",ip:"192.168.1.5",device:"Chrome / Windows 10",timestamp:"2023-08-25 11:10:15",status:"success"},{id:5,action:"Tài khoản bị khóa",user:"staff1",ip:"192.168.1.100",device:"Firefox / Windows 10",timestamp:"2023-08-15 14:30:22",status:"warning"}]),q=t=>{console.log("Password update values:",t),o.success("Mật khẩu đã được cập nhật thành công"),w.resetFields()},W=t=>{t?P(!0):ue.confirm({title:"Xác nhận tắt xác thực hai lớp",content:"Việc tắt xác thực hai lớp sẽ làm giảm bảo mật cho tài khoản của bạn. Bạn có chắc chắn muốn tiếp tục?",onOk:()=>{b(!1),o.warning("Xác thực hai lớp đã bị tắt")},onCancel:()=>{b(!0)}})},Y=()=>{b(!0),P(!1),o.success("Xác thực hai lớp đã được thiết lập thành công")},G=t=>{const n=j.filter(a=>a.id!==t);A(n),o.success("Phiên đăng nhập đã được kết thúc")},_=()=>{const t=j.find(n=>n.current);A(t?[t]:[]),o.success("Tất cả các phiên đăng nhập khác đã được kết thúc")},U=t=>{const n=S.filter(a=>a.id!==t);E(n),o.success("Địa chỉ IP đã được mở khóa")},Z=[{title:"Thiết bị",dataIndex:"device",key:"device",render:(t,n)=>e.jsx(me,{children:n.current?e.jsx(f,{status:"processing",text:t+" (Thiết bị hiện tại)"}):t})},{title:"Địa chỉ IP",dataIndex:"ip",key:"ip"},{title:"Địa điểm",dataIndex:"location",key:"location"},{title:"Hoạt động cuối",dataIndex:"lastActive",key:"lastActive"},{title:"Hành động",key:"action",render:(t,n)=>n.current?e.jsx(T,{type:"secondary",children:"Phiên hiện tại"}):e.jsx(F,{title:"Bạn có chắc chắn muốn kết thúc phiên này?",onConfirm:()=>G(n.id),okText:"Có",cancelText:"Không",children:e.jsx(d,{danger:!0,size:"small",icon:e.jsx(pe,{}),children:"Kết thúc phiên"})})}],J=[{title:"Địa chỉ IP",dataIndex:"ip",key:"ip"},{title:"Lý do",dataIndex:"reason",key:"reason"},{title:"Thời gian khóa",dataIndex:"blockedAt",key:"blockedAt"},{title:"Hành động",key:"action",render:(t,n)=>e.jsx(F,{title:"Bạn có chắc chắn muốn mở khóa địa chỉ IP này?",onConfirm:()=>U(n.id),okText:"Có",cancelText:"Không",children:e.jsx(d,{size:"small",children:"Mở khóa"})})}],ee=[{title:"Thời gian",dataIndex:"timestamp",key:"timestamp"},{title:"Hành động",dataIndex:"action",key:"action",render:(t,n)=>{const a={success:"green",error:"red",warning:"orange"};return e.jsx(ge,{color:a[n.status],children:t})}},{title:"Người dùng",dataIndex:"user",key:"user"},{title:"Địa chỉ IP",dataIndex:"ip",key:"ip"},{title:"Thiết bị",dataIndex:"device",key:"device"}];return e.jsx("div",{style:{padding:"24px"},children:e.jsxs(s,{children:[e.jsxs(je,{level:2,children:[e.jsx(ne,{})," Cài đặt bảo mật"]}),e.jsx(u,{children:"Quản lý các cài đặt bảo mật, mật khẩu, xác thực hai lớp và theo dõi hoạt động đăng nhập."}),e.jsxs(N,{activeKey:$,onChange:H,children:[e.jsx(m,{tab:e.jsxs("span",{children:[e.jsx(R,{})," Mật khẩu"]}),children:e.jsxs(l,{gutter:[24,24],children:[e.jsx(i,{xs:24,md:16,lg:12,children:e.jsx(s,{title:"Đổi mật khẩu",bordered:!1,children:e.jsxs(h,{form:w,layout:"vertical",onFinish:q,children:[e.jsx(h.Item,{name:"currentPassword",label:"Mật khẩu hiện tại",rules:[{required:!0,message:"Vui lòng nhập mật khẩu hiện tại!"}],children:e.jsx(C,{prefix:e.jsx(R,{}),placeholder:"Nhập mật khẩu hiện tại"})}),e.jsx(h.Item,{name:"newPassword",label:"Mật khẩu mới",rules:[{required:!0,message:"Vui lòng nhập mật khẩu mới!"},{min:8,message:"Mật khẩu phải có ít nhất 8 ký tự!"},{pattern:/^(?=.*[A-Z])(?=.*[a-z])(?=.*\d)(?=.*[!@#$%^&*()_+])[A-Za-z\d!@#$%^&*()_+]{8,}$/,message:"Mật khẩu phải bao gồm chữ hoa, chữ thường, số và ký tự đặc biệt!"}],hasFeedback:!0,children:e.jsx(C,{prefix:e.jsx(M,{}),placeholder:"Nhập mật khẩu mới"})}),e.jsx(h.Item,{name:"confirmPassword",label:"Xác nhận mật khẩu mới",dependencies:["newPassword"],hasFeedback:!0,rules:[{required:!0,message:"Vui lòng xác nhận mật khẩu mới!"},({getFieldValue:t})=>({validator(n,a){return!a||t("newPassword")===a?Promise.resolve():Promise.reject(new Error("Hai mật khẩu không khớp nhau!"))}})],children:e.jsx(C,{prefix:e.jsx(M,{}),placeholder:"Xác nhận mật khẩu mới"})}),e.jsx(h.Item,{children:e.jsx(d,{type:"primary",htmlType:"submit",icon:e.jsx(se,{}),children:"Cập nhật mật khẩu"})})]})})}),e.jsx(i,{xs:24,md:8,lg:12,children:e.jsxs(s,{title:"Yêu cầu mật khẩu",bordered:!1,children:[e.jsx(x,{size:"small",dataSource:["Tối thiểu 8 ký tự","Có ít nhất một chữ hoa","Có ít nhất một chữ thường","Có ít nhất một chữ số","Có ít nhất một ký tự đặc biệt","Không giống với 3 mật khẩu gần nhất"],renderItem:t=>e.jsx(x.Item,{children:e.jsxs(T,{children:[e.jsx(ie,{style:{color:"#52c41a",marginRight:8}})," ",t]})})}),e.jsx(y,{}),e.jsxs(u,{children:[e.jsx(B,{style:{marginRight:8}}),"Hệ thống sẽ yêu cầu bạn đổi mật khẩu mỗi 90 ngày để đảm bảo an toàn cho tài khoản."]})]})})]})},"password"),e.jsx(m,{tab:e.jsxs("span",{children:[e.jsx(re,{})," Xác thực hai lớp"]}),children:e.jsxs(l,{gutter:[24,24],children:[e.jsx(i,{xs:24,md:12,children:e.jsxs(s,{bordered:!1,children:[e.jsxs(c,{title:"Trạng thái xác thực hai lớp",bordered:!0,column:1,children:[e.jsx(c.Item,{label:"Trạng thái",children:g?e.jsx(f,{status:"success",text:"Đã kích hoạt"}):e.jsx(f,{status:"error",text:"Chưa kích hoạt"})}),e.jsx(c.Item,{label:"Phương thức",children:g?"Ứng dụng xác thực (Google Authenticator)":"Không có"}),e.jsx(c.Item,{label:"Kích hoạt",children:e.jsx(I,{checked:g,onChange:W,checkedChildren:"Bật",unCheckedChildren:"Tắt"})})]}),e.jsx(y,{}),e.jsxs(u,{children:[e.jsx(B,{style:{marginRight:8}}),"Xác thực hai lớp (2FA) giúp bảo vệ tài khoản của bạn bằng cách yêu cầu một mã xác thực thứ hai ngoài mật khẩu mỗi khi đăng nhập."]})]})}),K&&e.jsx(i,{xs:24,md:12,children:e.jsxs(s,{title:"Thiết lập xác thực hai lớp",bordered:!1,children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:24},children:[e.jsx("img",{src:"https://via.placeholder.com/200x200?text=QR+Code",alt:"QR Code",style:{width:200,height:200}}),e.jsx(u,{children:"Quét mã QR này bằng ứng dụng Google Authenticator trên điện thoại của bạn"})]}),e.jsxs(h,{layout:"vertical",onFinish:Y,children:[e.jsx(h.Item,{name:"verificationCode",label:"Nhập mã xác thực từ ứng dụng",rules:[{required:!0,message:"Vui lòng nhập mã xác thực!"}],children:e.jsx(L,{maxLength:6,placeholder:"Nhập mã 6 số"})}),e.jsx(h.Item,{children:e.jsx(d,{type:"primary",htmlType:"submit",children:"Xác nhận thiết lập"})})]})]})}),e.jsx(i,{xs:24,children:e.jsxs(s,{title:"Mã khôi phục khẩn cấp",bordered:!1,children:[e.jsx(he,{message:"Lưu trữ mã khôi phục ở nơi an toàn",description:"Nếu bạn mất thiết bị đã đăng ký xác thực hai lớp, bạn sẽ cần các mã khôi phục này để truy cập vào tài khoản của mình.",type:"warning",showIcon:!0,style:{marginBottom:16}}),g?e.jsxs("div",{children:[e.jsx(l,{gutter:[16,16],children:["ABCD-EFGH-IJKL","MNOP-QRST-UVWX","YZAB-CDEF-GHIJ","KLMN-OPQR-STUV","WXYZ-1234-5678"].map((t,n)=>e.jsx(i,{span:8,children:e.jsx(s,{size:"small",children:e.jsx(T,{code:!0,children:t})})},n))}),e.jsx("div",{style:{marginTop:16},children:e.jsx(d,{type:"default",icon:e.jsx(ce,{}),children:"Tải xuống mã khôi phục"})})]}):e.jsx(ae,{description:"Mã khôi phục sẽ được tạo khi bạn kích hoạt xác thực hai lớp"})]})})]})},"2fa"),e.jsx(m,{tab:e.jsxs("span",{children:[e.jsx(le,{})," Quản lý phiên"]}),children:e.jsxs(s,{title:"Phiên đăng nhập hiện tại",bordered:!1,extra:e.jsx(d,{danger:!0,onClick:_,disabled:j.length<=1,children:"Kết thúc tất cả phiên khác"}),children:[e.jsx(u,{children:"Danh sách các phiên đăng nhập hiện tại trên các thiết bị của bạn. Bạn có thể kết thúc bất kỳ phiên nào nếu phát hiện đáng ngờ."}),e.jsx(v,{columns:Z,dataSource:j,rowKey:"id",pagination:!1}),e.jsx(y,{}),e.jsxs(l,{gutter:24,children:[e.jsx(i,{span:12,children:e.jsx(h.Item,{label:"Giới hạn thời gian phiên đăng nhập",tooltip:"Phiên đăng nhập sẽ tự động hết hạn sau số ngày đã chọn",children:e.jsxs(V,{value:Q,onChange:D,style:{width:200},children:[e.jsx(p,{value:1,children:"1 ngày"}),e.jsx(p,{value:7,children:"7 ngày"}),e.jsx(p,{value:14,children:"14 ngày"}),e.jsx(p,{value:30,children:"30 ngày"}),e.jsx(p,{value:90,children:"90 ngày"})]})})}),e.jsx(i,{span:12,children:e.jsx(h.Item,{label:"Thông báo khi có đăng nhập mới",tooltip:"Gửi thông báo qua email khi phát hiện đăng nhập từ thiết bị mới",children:e.jsx(I,{checked:X,onChange:z,checkedChildren:"Bật",unCheckedChildren:"Tắt"})})})]})]})},"sessions"),e.jsx(m,{tab:e.jsxs("span",{children:[e.jsx(de,{})," Quyền riêng tư & Bảo mật"]}),children:e.jsxs(l,{gutter:[24,24],children:[e.jsx(i,{span:24,children:e.jsx(s,{title:"Địa chỉ IP bị chặn",bordered:!1,children:e.jsx(v,{columns:J,dataSource:S,rowKey:"id",pagination:!1})})}),e.jsx(i,{span:24,children:e.jsx(s,{title:"Cài đặt quyền riêng tư",bordered:!1,children:e.jsx(x,{itemLayout:"horizontal",dataSource:[{title:"Nhật ký hoạt động",description:"Lưu trữ thông tin về các hoạt động của bạn trong hệ thống",defaultValue:!0},{title:"Dữ liệu vị trí",description:"Thu thập thông tin về vị trí đăng nhập",defaultValue:!0},{title:"Thông tin thiết bị",description:"Thu thập thông tin về thiết bị đăng nhập",defaultValue:!0},{title:"Cookie phân tích",description:"Cho phép sử dụng cookie để phân tích hành vi sử dụng",defaultValue:!1}],renderItem:t=>e.jsx(x.Item,{actions:[e.jsx(I,{defaultChecked:t.defaultValue,checkedChildren:"Bật",unCheckedChildren:"Tắt"})],children:e.jsx(x.Item.Meta,{title:t.title,description:t.description})})})})})]})},"privacy"),e.jsxs(m,{tab:e.jsxs("span",{children:[e.jsx(xe,{})," Nhật ký bảo mật"]}),children:[e.jsx(s,{title:"Nhật ký bảo mật gần đây",bordered:!1,children:e.jsx(v,{columns:ee,dataSource:O,rowKey:"id",pagination:{pageSize:10}})}),e.jsx("div",{style:{marginTop:16},children:e.jsxs(l,{gutter:16,children:[e.jsx(i,{span:12,children:e.jsx(s,{title:"Thống kê hoạt động",bordered:!1,children:e.jsxs(c,{column:1,children:[e.jsx(c.Item,{label:"Tổng số đăng nhập thành công",children:"45"}),e.jsx(c.Item,{label:"Tổng số đăng nhập thất bại",children:"3"}),e.jsx(c.Item,{label:"Đăng nhập từ thiết bị lạ",children:"2"}),e.jsx(c.Item,{label:"Thay đổi mật khẩu gần đây",children:oe().subtract(10,"days").format("DD/MM/YYYY")})]})})}),e.jsx(i,{span:12,children:e.jsx(s,{title:"Hoạt động đáng chú ý",bordered:!1,children:e.jsxs(k,{children:[e.jsxs(k.Item,{color:"red",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Đăng nhập thất bại"})," - từ IP lạ (45.23.126.42)"]}),e.jsx("p",{children:e.jsx("small",{children:"2023-09-02 09:15:40"})})]}),e.jsxs(k.Item,{color:"orange",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Nhiều lần đăng nhập thất bại"})," - từ IP 192.168.1.100"]}),e.jsx("p",{children:e.jsx("small",{children:"2023-08-15 14:30:22"})})]}),e.jsxs(k.Item,{color:"green",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Thiết lập xác thực hai lớp"})," thành công"]}),e.jsx("p",{children:e.jsx("small",{children:"2023-08-25 11:10:15"})})]})]})})})]})})]},"logs")]})]})})};export{ve as default};
