import{_ as t,a as e,p as n,b as r,c as i,n as a,o}from"./polyfills-BjGv5uaK.js";import{k as s}from"./vendor-antv-g-lite-BsxRpwbw.js";import{B as d}from"./vendor-antv-util-BIOdtugi.js";
/*!
 * @antv/g-plugin-dragndrop
 * @description A G plugin for Drag n Drop implemented with PointerEvents
 * @version 2.0.35
 * @date 5/9/2025, 8:20:14 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var p=function(){function t(e){r(this,t),this.dragndropPluginOptions=e}return e(t,[{key:"apply",value:function(e){var n=this,r=e.renderingService,i=e.renderingContext.root.ownerDocument,s=i.defaultView,p=function(t){var e=t.target,r=e===i,p=r&&n.dragndropPluginOptions.isDocumentDraggable?i:e.closest&&e.closest("[draggable=true]");if(p){var l=!1,c=t.timeStamp,u=[t.clientX,t.clientY],g=null,v=[t.clientX,t.clientY],h=function(){var t=a(o().mark(function t(a){var s,h,f,m,y,E;return o().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(l){t.next=8;break}if(s=a.timeStamp-c,h=d([a.clientX,a.clientY],u),!(s<=n.dragndropPluginOptions.dragstartTimeThreshold||h<=n.dragndropPluginOptions.dragstartDistanceThreshold)){t.next=5;break}return t.abrupt("return");case 5:a.type="dragstart",p.dispatchEvent(a),l=!0;case 8:if(a.type="drag",a.dx=a.clientX-v[0],a.dy=a.clientY-v[1],p.dispatchEvent(a),v=[a.clientX,a.clientY],r){t.next=21;break}return f="pointer"===n.dragndropPluginOptions.overlap?[a.canvasX,a.canvasY]:e.getBounds().center,t.next=17,i.elementsFromPoint(f[0],f[1]);case 17:m=t.sent,y=m[m.indexOf(e)+1],E=(null==y?void 0:y.closest("[droppable=true]"))||(n.dragndropPluginOptions.isDocumentDroppable?i:null),g!==E&&(g&&(a.type="dragleave",a.target=g,g.dispatchEvent(a)),E&&(a.type="dragenter",a.target=E,E.dispatchEvent(a)),(g=E)&&(a.type="dragover",a.target=g,g.dispatchEvent(a)));case 21:case"end":return t.stop()}},t)}));return function(e){return t.apply(this,arguments)}}();s.addEventListener("pointermove",h);var f=function(t){if(l){t.detail={preventClick:!0};var e=t.clone();g&&(e.type="drop",e.target=g,g.dispatchEvent(e)),e.type="dragend",p.dispatchEvent(e),l=!1}s.removeEventListener("pointermove",h)};e.addEventListener("pointerup",f,{once:!0}),e.addEventListener("pointerupoutside",f,{once:!0})}};r.hooks.init.tap(t.tag,function(){s.addEventListener("pointerdown",p)}),r.hooks.destroy.tap(t.tag,function(){s.removeEventListener("pointerdown",p)})}}])}();p.tag="Dragndrop";var l=function(){function a(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r(this,a),(t=i(this,a)).name="dragndrop",t.options=e,t}return t(a,s),e(a,[{key:"init",value:function(){this.addRenderingPlugin(new p(n({overlap:"pointer",isDocumentDraggable:!1,isDocumentDroppable:!1,dragstartDistanceThreshold:0,dragstartTimeThreshold:0},this.options)))}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}},{key:"setOptions",value:function(t){Object.assign(this.plugins[0].dragndropPluginOptions,t)}}])}();export{l as P};
