import{r as e,j as s}from"./react-vendor-D_ybsntB.js";import{e as r}from"./ai-features-Dvk3-MnK.js";import{d as n}from"./datetime-CZsEG1Fw.js";import{P as t,M as i}from"./common-components-txC0VjBx.js";import{m as a,B as o,R as c,a as l,A as d,T as h,L as p,S as m,g as j,C as u,I as x,b as g,F as v,w as y,d as k,j as f,p as _,k as b,t as w,l as C,h as T,e as S,P as I,U as z,c as N,f as V,u as q}from"./antd-core-DVlmEpkB.js";import{H as B,y as F,U as H,F as A,f as M,b as $,B as D,bI as L,I as P,j as G,M as K,d as E,P as U,C as Y}from"./antd-icons-DMCzxaTm.js";import"./vendor-remix-run-router-UjR1oCxX.js";import"./vendor-prop-types-DQeQIVKZ.js";import"./vendor-fast-equals-51KNnk-7.js";import"./vendor-dnd-core-B9A4u1lA.js";import"./vendor-redux-DjMjAQeN.js";import"./vendor-react-dnd-invariant-3ejajjRq.js";import"./vendor-react-dnd-asap-CbVDrjlw.js";import"./vendor-react-dnd-shallowequal-DKwLR6sW.js";import"./vendor-fast-deep-equal-n3nGrwQy.js";import"./vendor-scheduler-Dmo4AZZp.js";import"./http-ztdpVPaQ.js";import"./admin-pages-CT-0otSU.js";import"./vendor-ant-design-plots-DP6i501V.js";import"./utils-CXADxxMH.js";import"./vendor-ant-design-charts-util-D2l6Hs-R.js";import"./vendor-antv-event-emitter-B_sETjLv.js";import"./vendor-antv-g2-extension-plot-ByDryGZ7.js";import"./vendor-antv-util-BIOdtugi.js";import"./vendor-tslib-BRpNZtt8.js";import"./charts-BOmscTYX.js";import"./vendor-internmap-B8oPgqVZ.js";import"./vendor-clsx-BeLtu-UY.js";import"./vendor-decimal.js-light-DxGkYd4s.js";import"./vendor-tiny-invariant-BM5KeS_Z.js";import"./vendor-victory-vendor-DB58CTWg.js";import"./vendor-antv-g2-sYywoIZv.js";import"./vendor-antv-g-camera-api-D5xCKgeg.js";import"./vendor-antv-g-lite-DrII67Nr.js";import"./polyfills-B4r5O4me.js";import"./vendor-eventemitter3-QYUf1tj-.js";import"./vendor-gl-matrix-DC4KmxQg.js";import"./vendor-antv-g-math-eKXG1hIb.js";import"./vendor-antv-g-web-animations-api-CyIt6i3N.js";import"./vendor-antv-g-canvas-CFhHHQFj.js";import"./vendor-antv-g-plugin-canvas-path-generator-CVNLD-z9.js";import"./vendor-antv-g-plugin-canvas-picker-BOqhFghs.js";import"./vendor-antv-g-plugin-canvas-renderer-CY8wHYb_.js";import"./vendor-antv-g-plugin-image-loader-Cv9gb-Q_.js";import"./vendor-antv-g-plugin-dom-interaction-BFQu-fjp.js";import"./vendor-antv-g-plugin-html-renderer-CKtkyHRF.js";import"./vendor-antv-g-plugin-dragndrop-C-fhZn1r.js";import"./vendor-antv-expr-DNWszLhl.js";import"./vendor-antv-scale-WmY3yw3x.js";import"./vendor-fecha-eoCYq76Q.js";import"./vendor-color-string-DlpZsNR2.js";import"./vendor-color-name-BQ5IbGbl.js";import"./vendor-simple-swizzle-CbuEe9Q8.js";import"./vendor-is-arrayish-CLsR9Wfx.js";import"./vendor-antv-component-B7Ic6yCK.js";import"./vendor-antv-vendor-5QXjnyZt.js";import"./vendor-antv-coord-C7ivB7vC.js";import"./vendor-flru-frKw_lgq.js";import"./vendor-pdfast-DvPkUa4Y.js";import"./vendor-crypto-js-DSoR22t1.js";import"./i18n-Bumj-RJR.js";import"./vendor-i18next-browser-languagedetector-F0gxWJsw.js";import"./vendor-rc-util-Cfhh6bGy.js";import"./vendor-ant-design-cssinjs-C7YRSOqU.js";import"./vendor-emotion-hash-DFFAhID7.js";import"./vendor-emotion-unitless-BWzHn38B.js";import"./vendor-stylis-C44NkLFc.js";import"./vendor-ant-design-cssinjs-utils-Z_ZGHKpv.js";import"./vendor-classnames-Bjqz8XQ3.js";import"./vendor-rc-resize-observer-DnkXipSO.js";import"./vendor-resize-observer-polyfill-C7U_o75s.js";import"./vendor-rc-motion-CgrNkiVN.js";import"./vendor-rc-collapse-BuUnFyUq.js";import"./vendor-rc-component-color-picker-D7vz9aAI.js";import"./vendor-ant-design-fast-color-BHo3zH90.js";import"./vendor-rc-overflow-Dz8RHsDo.js";import"./vendor-rc-picker-CgWv_2bo.js";import"./vendor-rc-component-trigger-B5dN-W7a.js";import"./vendor-rc-component-portal-B-ypBxqm.js";import"./vendor-rc-tabs-BwJDg3wn.js";import"./vendor-rc-dropdown-CZ0JW4x5.js";import"./vendor-rc-menu-YCSbwFbq.js";import"./vendor-rc-select-C-imgKkB.js";import"./vendor-rc-virtual-list-1kJCu580.js";import"./vendor-rc-segmented-DxRxYTwA.js";import"./vendor-rc-input-number-V0sWhVt2.js";import"./vendor-rc-component-mini-decimal-4AYFSTmh.js";import"./vendor-rc-input-CfgQgibu.js";import"./vendor-rc-slider-CdAUgrbY.js";import"./vendor-rc-drawer-CfIZZ8r4.js";import"./vendor-rc-field-form-zLN4ynZ6.js";import"./vendor-rc-component-async-validator-B0ws6RHn.js";import"./vendor-rc-image-FcAViups.js";import"./vendor-rc-dialog-CVbglhWq.js";import"./vendor-rc-notification-DBgLjbT1.js";import"./vendor-rc-tooltip-UDagiryc.js";import"./vendor-rc-component-qrcode-B0fCpeCY.js";import"./vendor-rc-rate-BYpgyvg8.js";import"./vendor-rc-steps-DyuNxNH9.js";import"./vendor-rc-switch-672QdYAA.js";import"./vendor-rc-table-BPXMAkvW.js";import"./vendor-rc-component-context-Bh07HgIq.js";import"./vendor-rc-tree-BEpjp_Ur.js";import"./vendor-rc-checkbox-C1_4jhQP.js";import"./vendor-scroll-into-view-if-needed-BuydUqPn.js";import"./vendor-compute-scroll-into-view-Cfyw3hb3.js";import"./vendor-rc-pagination-BepwSdzG.js";import"./vendor-throttle-debounce-w9OM8Bxz.js";import"./vendor-ant-design-colors-BZ2r7Wqn.js";import"./vendor-rc-textarea-5awn-jGw.js";import"./vendor-copy-to-clipboard-1ydfzSJH.js";import"./vendor-toggle-selection-v3K3UlSB.js";import"./vendor-rc-upload-DMmmAkHe.js";import"./vendor-rc-progress-CgK8Nc6A.js";const{Search:O}=x,{Option:X}=g,{TabPane:Q}=j,{Title:R,Text:W}=h,{TextArea:J}=x,{Dragger:Z}=z,ee=()=>{const[h,z]=e.useState(!1),[ee,se]=e.useState([]),[re,ne]=e.useState([]),[te,ie]=e.useState([]),[ae,oe]=e.useState([]),[ce,le]=e.useState({}),[de,he]=e.useState([]),[pe,me]=e.useState([]),[je,ue]=e.useState(null),[xe,ge]=e.useState(!1),[ve,ye]=e.useState(!1),[ke,fe]=e.useState(!1),[_e,be]=e.useState(!1),[we,Ce]=e.useState(!1),[Te,Se]=e.useState(null),[Ie,ze]=e.useState(""),[Ne,Ve]=e.useState("all"),[qe,Be]=e.useState("all"),[Fe]=a.useForm(),[He]=a.useForm(),[Ae]=a.useForm();e.useEffect(()=>{Me()},[]),e.useEffect(()=>{Ee()},[ee,Ie,Ne,qe]);const Me=async()=>{z(!0);try{await Promise.all([$e(),De(),Le(),Pe(),Ge(),Ke()])}catch(e){}finally{z(!1)}},$e=async()=>{try{const e=await r.get("/products",{params:{include_inventory:!0,limit:1e3}});e.data.success&&se(e.data.data.products||[])}catch(e){se([{id:1,name:"Coca Cola 330ml",sku:"CC-330-001",barcode:"8934673123456",category:"Beverages",supplier_id:1,supplier_name:"Coca Cola Vietnam",cost_price:8e3,selling_price:12e3,current_stock:150,reorder_point:50,max_stock:500,unit:"can",status:"active",last_restock:"2024-03-10",expiry_date:"2024-12-31"},{id:2,name:"Bánh mì sandwich",sku:"BM-SW-001",barcode:"8934673123457",category:"Food",supplier_id:2,supplier_name:"ABC Bakery",cost_price:15e3,selling_price:25e3,current_stock:25,reorder_point:30,max_stock:100,unit:"piece",status:"low_stock",last_restock:"2024-03-15",expiry_date:"2024-03-17"},{id:3,name:"Mì tôm Hảo Hảo",sku:"MT-HH-001",barcode:"8934673123458",category:"Food",supplier_id:3,supplier_name:"Acecook Vietnam",cost_price:3500,selling_price:5e3,current_stock:5,reorder_point:20,max_stock:200,unit:"pack",status:"critical",last_restock:"2024-03-05",expiry_date:"2024-09-30"}])}},De=async()=>{try{const e=await r.get("/suppliers");e.data.success&&ie(e.data.data||[])}catch(e){ie([{id:1,name:"Coca Cola Vietnam",contact:"0901234567",email:"contact@cocacola.vn"},{id:2,name:"ABC Bakery",contact:"0907654321",email:"order@abcbakery.vn"},{id:3,name:"Acecook Vietnam",contact:"0912345678",email:"sales@acecook.vn"}])}},Le=async()=>{try{const e=await r.get("/categories");e.data.success&&oe(e.data.data.categories||[])}catch(e){oe([{id:1,name:"Beverages"},{id:2,name:"Food"},{id:3,name:"Snacks"},{id:4,name:"Personal Care"}])}},Pe=async()=>{try{const e=await r.get("/inventory/stats");e.data.success&&le(e.data.data)}catch(e){le({totalProducts:156,totalValue:456e5,lowStockItems:12,outOfStockItems:3,criticalItems:5,turnoverRate:4.2,stockAccuracy:98.5,reorderAlerts:8})}},Ge=async()=>{try{const e=await r.get("/inventory/alerts");e.data.success&&he(e.data.data||[])}catch(e){he([{id:1,product_name:"Mì tôm Hảo Hảo",current_stock:5,reorder_point:20,status:"critical"},{id:2,product_name:"Bánh mì sandwich",current_stock:25,reorder_point:30,status:"low"},{id:3,product_name:"Nước suối",current_stock:15,reorder_point:25,status:"low"}])}},Ke=async()=>{try{const e=await r.get("/inventory/movements",{params:{limit:50}});e.data.success&&me(e.data.data||[])}catch(e){me([{id:1,product_name:"Coca Cola 330ml",type:"in",quantity:100,reason:"Purchase Order #PO-001",user_name:"Admin",created_at:"2024-03-15T10:30:00"},{id:2,product_name:"Bánh mì sandwich",type:"out",quantity:5,reason:"Sale Order #ORD-123",user_name:"Cashier",created_at:"2024-03-15T14:20:00"}])}},Ee=()=>{let e=ee;if(Ie&&(e=e.filter(e=>e.name.toLowerCase().includes(Ie.toLowerCase())||e.sku.toLowerCase().includes(Ie.toLowerCase())||e.barcode?.includes(Ie))),"all"!==Ne&&(e=e.filter(e=>e.category===Ne)),"all"!==qe)switch(qe){case"low":e=e.filter(e=>"low_stock"===e.status);break;case"critical":e=e.filter(e=>"critical"===e.status);break;case"out":e=e.filter(e=>0===e.current_stock);break;case"normal":e=e.filter(e=>"active"===e.status)}ne(e)},Ue=e=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e),Ye=e=>0===e.current_stock?{status:"error",text:"Hết hàng"}:e.current_stock<=.5*e.reorder_point?{status:"error",text:"Nguy hiểm"}:e.current_stock<=e.reorder_point?{status:"warning",text:"Thấp"}:{status:"success",text:"Bình thường"},Oe=e=>{switch(Ye(e).status){case"error":return"#ff4d4f";case"warning":return"#faad14";case"success":return"#52c41a";default:return"#d9d9d9"}},Xe=[{title:"Sản phẩm",dataIndex:"name",key:"name",render:(e,r)=>s.jsxs(m,{children:[s.jsx(C,{icon:s.jsx(G,{})}),s.jsxs("div",{children:[s.jsx("div",{style:{fontWeight:500},children:e}),s.jsxs(W,{type:"secondary",style:{fontSize:"12px"},children:["SKU: ",r.sku]})]})]})},{title:"Danh mục",dataIndex:"category",key:"category",render:e=>s.jsx(k,{children:e})},{title:"Tồn kho",key:"stock",render:(e,r)=>{const n=Ye(r);return s.jsxs(m,{children:[s.jsx(N,{status:n.status}),s.jsxs("span",{style:{color:Oe(r),fontWeight:"bold"},children:[r.current_stock," ",r.unit]})]})}},{title:"Điểm đặt lại",dataIndex:"reorder_point",key:"reorder_point",render:(e,s)=>`${e} ${s.unit}`},{title:"Giá vốn",dataIndex:"cost_price",key:"cost_price",render:e=>Ue(e)},{title:"Giá bán",dataIndex:"selling_price",key:"selling_price",render:e=>Ue(e)},{title:"Nhà cung cấp",dataIndex:"supplier_name",key:"supplier_name"},{title:"Thao tác",key:"actions",render:(e,n)=>s.jsxs(m,{children:[s.jsx(V,{title:"Xem chi tiết",children:s.jsx(o,{type:"text",icon:s.jsx(E,{}),onClick:()=>(async e=>{ue(e),be(!0);try{const s=await r.get(`/products/${e.id}`,{params:{include_movements:!0}});s.data.success&&ue(s.data.data)}catch(s){}})(n)})}),s.jsx(V,{title:"Điều chỉnh tồn kho",children:s.jsx(o,{type:"text",icon:s.jsx(U,{}),onClick:()=>(ue(n),He.resetFields(),void ye(!0))})}),s.jsx(V,{title:"Chỉnh sửa",children:s.jsx(o,{type:"text",icon:s.jsx(P,{}),onClick:()=>{return Se(e=n),Fe.setFieldsValue(e),void ge(!0);var e}})}),s.jsx(q,{title:"Bạn có chắc chắn muốn xóa sản phẩm này?",onConfirm:()=>(async e=>{try{z(!0),(await r.delete(`/products/${e}`)).data.success&&(b.success("Xóa sản phẩm thành công"),$e())}catch(s){b.error("Có lỗi xảy ra khi xóa sản phẩm")}finally{z(!1)}})(n.id),okText:"Xóa",cancelText:"Hủy",children:s.jsx(V,{title:"Xóa",children:s.jsx(o,{type:"text",icon:s.jsx(Y,{}),danger:!0})})})]})}];return s.jsxs("div",{children:[s.jsx(t,{title:"Quản lý kho hàng",subtitle:"Quản lý tồn kho, nhập xuất hàng và cảnh báo",icon:"cart",actions:[s.jsx(o,{icon:s.jsx(B,{}),onClick:()=>Ce(!0),children:"Import"},"import"),s.jsx(o,{icon:s.jsx(F,{}),children:"Export"},"export"),s.jsx(o,{icon:s.jsx(H,{}),children:"In báo cáo"},"print"),s.jsx(o,{type:"primary",icon:s.jsx(A,{}),onClick:()=>{Se(null),Fe.resetFields(),ge(!0)},children:"Thêm sản phẩm"},"add")]}),s.jsxs("div",{style:{padding:"0 24px 24px"},children:[s.jsxs(c,{gutter:[16,16],style:{marginBottom:24},children:[s.jsx(l,{xs:24,sm:12,lg:6,children:s.jsx(i,{title:"Tổng sản phẩm",value:ce.totalProducts,icon:"cart",color:"primary",loading:h})}),s.jsx(l,{xs:24,sm:12,lg:6,children:s.jsx(i,{title:"Giá trị tồn kho",value:Ue(ce.totalValue),icon:"dollar",color:"success",loading:h})}),s.jsx(l,{xs:24,sm:12,lg:6,children:s.jsx(i,{title:"Cảnh báo tồn kho",value:ce.reorderAlerts,icon:"chart",color:"warning",loading:h})}),s.jsx(l,{xs:24,sm:12,lg:6,children:s.jsx(i,{title:"Độ chính xác",value:`${ce.stockAccuracy}%`,icon:"chart",color:"success",loading:h})})]}),de.length>0&&s.jsx(d,{message:"Cảnh báo tồn kho thấp",description:s.jsxs("div",{children:[s.jsxs(W,{children:["Có ",de.length," sản phẩm cần được nhập thêm hàng:"]}),s.jsx(p,{size:"small",dataSource:de.slice(0,3),renderItem:e=>s.jsx(p.Item,{children:s.jsxs(m,{children:[s.jsx(M,{style:{color:"critical"===e.status?"#ff4d4f":"#faad14"}}),s.jsx(W,{children:e.product_name}),s.jsxs(W,{type:"secondary",children:["Còn ",e.current_stock,", cần nhập khi dưới ",e.reorder_point]})]})})}),de.length>3&&s.jsxs(W,{type:"secondary",children:["và ",de.length-3," sản phẩm khác..."]})]}),type:"warning",showIcon:!0,style:{marginBottom:24}}),s.jsxs(j,{defaultActiveKey:"products",children:[s.jsxs(Q,{tab:"Danh sách sản phẩm",children:[s.jsx(u,{style:{marginBottom:16},children:s.jsxs(c,{gutter:[16,16],align:"middle",children:[s.jsx(l,{xs:24,sm:12,lg:6,children:s.jsx(O,{placeholder:"Tìm kiếm sản phẩm...",value:Ie,onChange:e=>ze(e.target.value),allowClear:!0})}),s.jsx(l,{xs:24,sm:12,lg:4,children:s.jsxs(g,{value:Ne,onChange:Ve,style:{width:"100%"},placeholder:"Danh mục",children:[s.jsx(X,{value:"all",children:"Tất cả danh mục"}),ae.map(e=>s.jsx(X,{value:e.name,children:e.name},e.id))]})}),s.jsx(l,{xs:24,sm:12,lg:4,children:s.jsxs(g,{value:qe,onChange:Be,style:{width:"100%"},placeholder:"Trạng thái tồn kho",children:[s.jsx(X,{value:"all",children:"Tất cả"}),s.jsx(X,{value:"normal",children:"Bình thường"}),s.jsx(X,{value:"low",children:"Tồn kho thấp"}),s.jsx(X,{value:"critical",children:"Nguy hiểm"}),s.jsx(X,{value:"out",children:"Hết hàng"})]})}),s.jsx(l,{xs:24,sm:24,lg:10,children:s.jsx(m,{style:{float:"right"},children:s.jsxs(W,{type:"secondary",children:["Hiển thị ",re.length," / ",ee.length," sản phẩm"]})})})]})}),s.jsx(u,{children:s.jsx(v,{columns:Xe,dataSource:re,rowKey:"id",loading:h,pagination:{pageSize:20,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,s)=>`${s[0]}-${s[1]} của ${e} sản phẩm`},rowClassName:e=>{const s=Ye(e);return"error"===s.status?"critical-row":"warning"===s.status?"warning-row":""}})})]},"products"),s.jsx(Q,{tab:"Lịch sử nhập xuất",children:s.jsx(u,{children:s.jsx(y,{children:pe.map(e=>s.jsx(y.Item,{dot:"in"===e.type?s.jsx($,{style:{color:"#52c41a"}}):s.jsx(D,{style:{color:"#ff4d4f"}}),children:s.jsxs("div",{children:[s.jsx(W,{strong:!0,children:e.product_name}),s.jsx("div",{children:s.jsxs(m,{children:[s.jsxs(k,{color:"in"===e.type?"green":"red",children:["in"===e.type?"+":"-",e.quantity]}),s.jsx(W,{children:e.reason})]})}),s.jsx("div",{children:s.jsxs(W,{type:"secondary",style:{fontSize:"12px"},children:[n(e.created_at).format("DD/MM/YYYY HH:mm")," - ",e.user_name]})})]})},e.id))})})},"movements"),s.jsx(Q,{tab:"Nhà cung cấp",children:s.jsx(u,{children:s.jsxs(c,{gutter:[16,16],children:[te.map(e=>s.jsx(l,{xs:24,sm:12,lg:8,children:s.jsx(u,{size:"small",title:e.name,extra:s.jsx(o,{type:"text",icon:s.jsx(P,{}),onClick:()=>{Ae.setFieldsValue(e),fe(!0)}}),children:s.jsxs(m,{direction:"vertical",size:"small",children:[s.jsxs(W,{children:[s.jsx(L,{})," ",e.contact]}),s.jsx(W,{children:e.email})]})})},e.id)),s.jsx(l,{xs:24,sm:12,lg:8,children:s.jsx(u,{size:"small",style:{border:"2px dashed #d9d9d9",textAlign:"center",cursor:"pointer"},onClick:()=>{Ae.resetFields(),fe(!0)},children:s.jsxs("div",{style:{padding:"20px 0"},children:[s.jsx(A,{style:{fontSize:"24px",color:"#d9d9d9"}}),s.jsx("div",{style:{marginTop:8},children:s.jsx(W,{type:"secondary",children:"Thêm nhà cung cấp"})})]})})})]})})},"suppliers")]}),s.jsx(f,{title:Te?"Chỉnh sửa sản phẩm":"Thêm sản phẩm mới",open:xe,onCancel:()=>ge(!1),footer:null,width:800,children:s.jsxs(a,{form:Fe,layout:"vertical",onFinish:async e=>{try{if(z(!0),Te){(await r.put(`/products/${Te.id}`,e)).data.success&&(b.success("Cập nhật sản phẩm thành công"),$e())}else{(await r.post("/products",e)).data.success&&(b.success("Tạo sản phẩm thành công"),$e())}ge(!1),Fe.resetFields()}catch(s){b.error("Có lỗi xảy ra khi lưu sản phẩm")}finally{z(!1)}},style:{marginTop:16},children:[s.jsxs(c,{gutter:16,children:[s.jsx(l,{span:12,children:s.jsx(a.Item,{name:"name",label:"Tên sản phẩm",rules:[{required:!0,message:"Vui lòng nhập tên sản phẩm"}],children:s.jsx(x,{placeholder:"Nhập tên sản phẩm"})})}),s.jsx(l,{span:12,children:s.jsx(a.Item,{name:"sku",label:"Mã SKU",rules:[{required:!0,message:"Vui lòng nhập mã SKU"}],children:s.jsx(x,{placeholder:"Nhập mã SKU"})})})]}),s.jsxs(c,{gutter:16,children:[s.jsx(l,{span:12,children:s.jsx(a.Item,{name:"barcode",label:"Mã vạch",children:s.jsx(x,{placeholder:"Nhập mã vạch"})})}),s.jsx(l,{span:12,children:s.jsx(a.Item,{name:"category",label:"Danh mục",rules:[{required:!0,message:"Vui lòng chọn danh mục"}],children:s.jsx(g,{placeholder:"Chọn danh mục",children:ae.map(e=>s.jsx(X,{value:e.name,children:e.name},e.id))})})})]}),s.jsxs(c,{gutter:16,children:[s.jsx(l,{span:12,children:s.jsx(a.Item,{name:"supplier_id",label:"Nhà cung cấp",rules:[{required:!0,message:"Vui lòng chọn nhà cung cấp"}],children:s.jsx(g,{placeholder:"Chọn nhà cung cấp",children:te.map(e=>s.jsx(X,{value:e.id,children:e.name},e.id))})})}),s.jsx(l,{span:12,children:s.jsx(a.Item,{name:"unit",label:"Đơn vị tính",rules:[{required:!0,message:"Vui lòng nhập đơn vị tính"}],children:s.jsx(x,{placeholder:"VD: cái, hộp, kg..."})})})]}),s.jsxs(c,{gutter:16,children:[s.jsx(l,{span:8,children:s.jsx(a.Item,{name:"cost_price",label:"Giá vốn",rules:[{required:!0,message:"Vui lòng nhập giá vốn"}],children:s.jsx(_,{style:{width:"100%"},formatter:e=>`${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>e.replace(/\$\s?|(,*)/g,""),min:0})})}),s.jsx(l,{span:8,children:s.jsx(a.Item,{name:"selling_price",label:"Giá bán",rules:[{required:!0,message:"Vui lòng nhập giá bán"}],children:s.jsx(_,{style:{width:"100%"},formatter:e=>`${e}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:e=>e.replace(/\$\s?|(,*)/g,""),min:0})})}),s.jsx(l,{span:8,children:s.jsx(a.Item,{name:"current_stock",label:"Tồn kho hiện tại",rules:[{required:!0,message:"Vui lòng nhập tồn kho"}],children:s.jsx(_,{style:{width:"100%"},min:0})})})]}),s.jsxs(c,{gutter:16,children:[s.jsx(l,{span:12,children:s.jsx(a.Item,{name:"reorder_point",label:"Điểm đặt hàng lại",rules:[{required:!0,message:"Vui lòng nhập điểm đặt hàng lại"}],children:s.jsx(_,{style:{width:"100%"},min:0})})}),s.jsx(l,{span:12,children:s.jsx(a.Item,{name:"max_stock",label:"Tồn kho tối đa",rules:[{required:!0,message:"Vui lòng nhập tồn kho tối đa"}],children:s.jsx(_,{style:{width:"100%"},min:0})})})]}),s.jsx(c,{gutter:16,children:s.jsx(l,{span:24,children:s.jsx(a.Item,{name:"description",label:"Mô tả",children:s.jsx(J,{placeholder:"Nhập mô tả sản phẩm",rows:3})})})}),s.jsxs(c,{gutter:16,style:{marginTop:24},children:[s.jsx(l,{span:12,children:s.jsx(o,{size:"large",block:!0,onClick:()=>ge(!1),children:"Hủy"})}),s.jsx(l,{span:12,children:s.jsx(o,{type:"primary",size:"large",block:!0,htmlType:"submit",loading:h,children:Te?"Cập nhật":"Tạo mới"})})]})]})}),s.jsx(f,{title:"Điều chỉnh tồn kho",open:ve,onCancel:()=>ye(!1),footer:null,width:500,children:je&&s.jsxs("div",{children:[s.jsxs(u,{size:"small",style:{marginBottom:16},children:[s.jsx(W,{strong:!0,children:je.name}),s.jsxs("div",{children:[s.jsx(W,{type:"secondary",children:"Tồn kho hiện tại: "}),s.jsxs(W,{strong:!0,children:[je.current_stock," ",je.unit]})]})]}),s.jsxs(a,{form:He,layout:"vertical",onFinish:async e=>{try{z(!0);(await r.post("/inventory/adjust",{product_id:je.id,...e})).data.success&&(b.success("Điều chỉnh tồn kho thành công"),$e(),Ke()),ye(!1),He.resetFields()}catch(s){b.error("Có lỗi xảy ra khi điều chỉnh tồn kho")}finally{z(!1)}},children:[s.jsx(a.Item,{name:"type",label:"Loại điều chỉnh",rules:[{required:!0,message:"Vui lòng chọn loại điều chỉnh"}],children:s.jsxs(g,{placeholder:"Chọn loại điều chỉnh",children:[s.jsx(X,{value:"in",children:"Nhập kho"}),s.jsx(X,{value:"out",children:"Xuất kho"}),s.jsx(X,{value:"adjust",children:"Điều chỉnh"})]})}),s.jsx(a.Item,{name:"quantity",label:"Số lượng",rules:[{required:!0,message:"Vui lòng nhập số lượng"}],children:s.jsx(_,{style:{width:"100%"},min:1,placeholder:"Nhập số lượng"})}),s.jsx(a.Item,{name:"reason",label:"Lý do",rules:[{required:!0,message:"Vui lòng nhập lý do"}],children:s.jsx(J,{placeholder:"Nhập lý do điều chỉnh",rows:3})}),s.jsxs(c,{gutter:16,style:{marginTop:24},children:[s.jsx(l,{span:12,children:s.jsx(o,{size:"large",block:!0,onClick:()=>ye(!1),children:"Hủy"})}),s.jsx(l,{span:12,children:s.jsx(o,{type:"primary",size:"large",block:!0,htmlType:"submit",loading:h,children:"Xác nhận"})})]})]})]})}),s.jsx(f,{title:"Thông tin nhà cung cấp",open:ke,onCancel:()=>fe(!1),footer:null,width:500,children:s.jsxs(a,{form:Ae,layout:"vertical",onFinish:async e=>{try{z(!0);(await r.post("/suppliers",e)).data.success&&(b.success("Lưu nhà cung cấp thành công"),De(),fe(!1))}catch(s){b.error("Có lỗi xảy ra")}finally{z(!1)}},children:[s.jsx(a.Item,{name:"name",label:"Tên nhà cung cấp",rules:[{required:!0,message:"Vui lòng nhập tên nhà cung cấp"}],children:s.jsx(x,{placeholder:"Nhập tên nhà cung cấp"})}),s.jsx(a.Item,{name:"contact",label:"Số điện thoại",rules:[{required:!0,message:"Vui lòng nhập số điện thoại"}],children:s.jsx(x,{placeholder:"Nhập số điện thoại"})}),s.jsx(a.Item,{name:"email",label:"Email",rules:[{type:"email",message:"Email không hợp lệ"}],children:s.jsx(x,{placeholder:"Nhập email"})}),s.jsx(a.Item,{name:"address",label:"Địa chỉ",children:s.jsx(J,{placeholder:"Nhập địa chỉ",rows:3})}),s.jsxs(c,{gutter:16,style:{marginTop:24},children:[s.jsx(l,{span:12,children:s.jsx(o,{size:"large",block:!0,onClick:()=>fe(!1),children:"Hủy"})}),s.jsx(l,{span:12,children:s.jsx(o,{type:"primary",size:"large",block:!0,htmlType:"submit",loading:h,children:"Lưu"})})]})]})}),s.jsx(w,{title:"Chi tiết sản phẩm",placement:"right",onClose:()=>be(!1),open:_e,width:600,children:je&&s.jsxs("div",{children:[s.jsxs(u,{style:{marginBottom:16},children:[s.jsxs(c,{align:"middle",gutter:16,children:[s.jsx(l,{children:s.jsx(C,{size:64,icon:s.jsx(G,{})})}),s.jsxs(l,{flex:1,children:[s.jsx(R,{level:4,style:{margin:0},children:je.name}),s.jsxs(m,{children:[s.jsx(k,{children:je.category}),s.jsxs(W,{type:"secondary",children:["SKU: ",je.sku]})]})]})]}),s.jsx(T,{}),s.jsxs(c,{gutter:[16,16],children:[s.jsx(l,{span:12,children:s.jsxs(m,{direction:"vertical",size:"small",children:[s.jsx(W,{type:"secondary",children:"Thông tin cơ bản"}),s.jsxs("div",{children:["Mã vạch: ",s.jsx(W,{strong:!0,children:je.barcode})]}),s.jsxs("div",{children:["Đơn vị: ",s.jsx(W,{strong:!0,children:je.unit})]}),s.jsxs("div",{children:["Nhà cung cấp: ",s.jsx(W,{strong:!0,children:je.supplier_name})]})]})}),s.jsx(l,{span:12,children:s.jsxs(m,{direction:"vertical",size:"small",children:[s.jsx(W,{type:"secondary",children:"Giá cả"}),s.jsxs("div",{children:["Giá vốn: ",s.jsx(W,{strong:!0,children:Ue(je.cost_price)})]}),s.jsxs("div",{children:["Giá bán: ",s.jsx(W,{strong:!0,children:Ue(je.selling_price)})]}),s.jsxs("div",{children:["Lợi nhuận: ",s.jsx(W,{strong:!0,style:{color:"#52c41a"},children:Ue(je.selling_price-je.cost_price)})]})]})})]})]}),s.jsxs(u,{title:"Thông tin tồn kho",style:{marginBottom:16},children:[s.jsxs(c,{gutter:[16,16],children:[s.jsx(l,{span:8,children:s.jsx(S,{title:"Tồn kho hiện tại",value:je.current_stock,suffix:je.unit,valueStyle:{color:Oe(je)}})}),s.jsx(l,{span:8,children:s.jsx(S,{title:"Điểm đặt lại",value:je.reorder_point,suffix:je.unit})}),s.jsx(l,{span:8,children:s.jsx(S,{title:"Tồn kho tối đa",value:je.max_stock,suffix:je.unit})})]}),s.jsx("div",{style:{marginTop:16},children:s.jsx(I,{percent:je.current_stock/je.max_stock*100,strokeColor:Oe(je),format:()=>`${je.current_stock}/${je.max_stock}`})})]}),s.jsx(u,{title:"Lịch sử giao dịch gần đây",children:s.jsx(y,{size:"small",children:(je.recent_movements||[]).map((e,r)=>s.jsx(y.Item,{dot:"in"===e.type?s.jsx($,{style:{color:"#52c41a"}}):s.jsx(D,{style:{color:"#ff4d4f"}}),children:s.jsxs("div",{children:[s.jsxs(m,{children:[s.jsxs(k,{color:"in"===e.type?"green":"red",children:["in"===e.type?"+":"-",e.quantity]}),s.jsx(W,{children:e.reason})]}),s.jsx("div",{children:s.jsx(W,{type:"secondary",style:{fontSize:"12px"},children:n(e.created_at).format("DD/MM/YYYY HH:mm")})})]})},r))})})]})}),s.jsx(f,{title:"Import sản phẩm từ Excel",open:we,onCancel:()=>Ce(!1),footer:null,width:600,children:s.jsxs("div",{style:{textAlign:"center",padding:"20px 0"},children:[s.jsxs(Z,{name:"file",multiple:!1,accept:".xlsx,.xls",beforeUpload:()=>!1,onChange:e=>{},children:[s.jsx("p",{className:"ant-upload-drag-icon",children:s.jsx(K,{style:{fontSize:"48px",color:"#52c41a"}})}),s.jsx("p",{className:"ant-upload-text",children:"Kéo thả file Excel vào đây hoặc click để chọn"}),s.jsx("p",{className:"ant-upload-hint",children:"Hỗ trợ file .xlsx và .xls. Tải template mẫu để biết định dạng."})]}),s.jsx("div",{style:{marginTop:16},children:s.jsx(o,{icon:s.jsx(K,{}),children:"Tải template mẫu"})})]})}),s.jsx("style",{jsx:!0,global:!0,children:"\n        .critical-row {\n          background-color: #fff2f0 !important;\n        }\n        .warning-row {\n          background-color: #fffbe6 !important;\n        }\n      "})]})]})};export{ee as default};
