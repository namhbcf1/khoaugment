import{r as t,g as i,f as o,h as a,i as s,j as n}from"./vendor-antv-g-lite-DrII67Nr.js";import{_ as e,a as r,b as l,c as h}from"./polyfills-B4r5O4me.js";import{c as m,d as u}from"./vendor-antv-util-BIOdtugi.js";import{s as d,o as v,p as c,q as p,e as f,r as g,u as y,v as P,w as A,x as k,y as x,l as R,z,A as I}from"./vendor-gl-matrix-DC4KmxQg.js";
/*!
 * @antv/g-camera-api
 * @description A simple implementation of Camera API.
 * @version 2.0.38
 * @date 5/9/2025, 8:19:12 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var E=function(){function E(){var t;l(this,E);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(t=h(this,E,[].concat(o))).landmarks=[],t}return e(E,n),r(E,[{key:"rotate",value:function(t,s,n){if(this.relElevation=i(s),this.relAzimuth=i(t),this.relRoll=i(n),this.elevation+=this.relElevation,this.azimuth+=this.relAzimuth,this.roll+=this.relRoll,this.type===o.EXPLORING){var e=d(v(),[1,0,0],a((this.rotateWorld?1:-1)*this.relElevation)),r=d(v(),[0,1,0],a((this.rotateWorld?1:-1)*this.relAzimuth)),l=d(v(),[0,0,1],a(this.relRoll)),h=c(v(),r,e);h=c(v(),h,l);var m=p(f(),h);g(this.matrix,this.matrix,[0,0,-this.distance]),y(this.matrix,this.matrix,m),g(this.matrix,this.matrix,[0,0,this.distance])}else{if(Math.abs(this.elevation)>90)return this;this.computeMatrix()}return this._getAxes(),this.type===o.ORBITING||this.type===o.EXPLORING?this._getPosition():this.type===o.TRACKING&&this._getFocalPoint(),this._update(),this}},{key:"pan",value:function(t,i){var o=s(t,i,0),a=P(this.position);return A(a,a,k(x(),this.right,o[0])),A(a,a,k(x(),this.up,o[1])),this._setPosition(a),this.triggerUpdate(),this}},{key:"dolly",value:function(t){var i=this.forward,a=P(this.position),s=this.dollyingStep,n=this.distance+t*this.dollyingStep;return s=Math.max(Math.min(n,this.maxDistance),this.minDistance)-this.distance,a[0]+=s*i[0],a[1]+=s*i[1],a[2]+=s*i[2],this._setPosition(a),this.type===o.ORBITING||this.type===o.EXPLORING?this._getDistance():this.type===o.TRACKING&&A(this.focalPoint,a,this.distanceVector),this.triggerUpdate(),this}},{key:"cancelLandmarkAnimation",value:function(){void 0!==this.landmarkAnimationID&&this.canvas.cancelAnimationFrame(this.landmarkAnimationID)}},{key:"createLandmark",value:function(i){var o,a,s,n,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.position,l=void 0===r?this.position:r,h=e.focalPoint,m=void 0===h?this.focalPoint:h,u=e.roll,d=e.zoom,v=new t.CameraContribution;v.setType(this.type,void 0),v.setPosition(l[0],null!==(o=l[1])&&void 0!==o?o:this.position[1],null!==(a=l[2])&&void 0!==a?a:this.position[2]),v.setFocalPoint(m[0],null!==(s=m[1])&&void 0!==s?s:this.focalPoint[1],null!==(n=m[2])&&void 0!==n?n:this.focalPoint[2]),v.setRoll(null!=u?u:this.roll),v.setZoom(null!=d?d:this.zoom);var c={name:i,matrix:R(v.getWorldTransform()),right:P(v.right),up:P(v.up),forward:P(v.forward),position:P(v.getPosition()),focalPoint:P(v.getFocalPoint()),distanceVector:P(v.getDistanceVector()),distance:v.getDistance(),dollyingStep:v.getDollyingStep(),azimuth:v.getAzimuth(),elevation:v.getElevation(),roll:v.getRoll(),relAzimuth:v.relAzimuth,relElevation:v.relElevation,relRoll:v.relRoll,zoom:v.getZoom()};return this.landmarks.push(c),c}},{key:"gotoLandmark",value:function(i){var o=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=m(i)?this.landmarks.find(function(t){return t.name===i}):i;if(s){var n=u(a)?{duration:a}:a,e=n.easing,r=void 0===e?"linear":e,l=n.duration,h=void 0===l?100:l,d=n.easingFunction,v=void 0===d?void 0:d,c=n.onfinish,p=void 0===c?void 0:c,f=n.onframe,g=void 0===f?void 0:f;this.cancelLandmarkAnimation();var y,P=s.position,A=s.focalPoint,k=s.zoom,R=s.roll,E=v||t.EasingFunction(r),F=function(){o.setFocalPoint(A),o.setPosition(P),o.setRoll(R),o.setZoom(k),o.computeMatrix(),o.triggerUpdate(),null==p||p()};if(0===h)return F();var D=function(t){void 0===y&&(y=t);var i=t-y;if(i>=h)F();else{var a,s,n=E(i/h),e=x(),r=x();if(z(e,o.focalPoint,A,n),z(r,o.position,P,n),s=o.roll*(1-n)+R*n,a=o.zoom*(1-n)+k*n,o.setFocalPoint(e),o.setPosition(r),o.setRoll(s),o.setZoom(a),I(e,A)+I(r,P)<=.01&&void 0===k&&void 0===R)return F();o.computeMatrix(),o.triggerUpdate(),i<h&&(null==g||g(n),o.landmarkAnimationID=o.canvas.requestAnimationFrame(D))}};this.canvas.requestAnimationFrame(D)}}}])}();t.CameraContribution=E;
