import{j as e}from"./index-DPVYnWcF.js";import{r as c}from"./vendor-DD54NZMZ.js";import{z as T,f as h,e as g,C as l,T as ae,$ as F,B as M,R as se,N as re,m as u,o as k,g as le,aY as S,ab as ie,a6 as oe,u as P,Q as ce,y as he,b0 as de,aV as ge,aP as x,S as me,b1 as ue,A as xe,H as fe}from"./antd-pmzi8FkM.js";import{P as C}from"./index-J5Y8oacM.js";import{C as f}from"./index-BWtZXrxb.js";import"./utils-Db1EesZb.js";import"./defaultLocale-Baf4yPCw.js";const{Title:pe,Text:je,Paragraph:I}=ae,{Option:m}=F,{TabPane:D}=P,Ie=()=>{const[s,d]=c.useState(!0),[p,R]=c.useState("year"),[j,V]=c.useState([]),[y,N]=c.useState([]),[$,w]=c.useState([]),[ye,B]=c.useState([]),[v,K]=c.useState([]),[O,Y]=c.useState([]),[A,q]=c.useState([]);c.useEffect(()=>{d(!0),setTimeout(()=>{const t=[{segment:"Khách hàng VIP",value:52,percentage:5.2,color:"#722ed1"},{segment:"Khách hàng trung thành",value:187,percentage:18.7,color:"#2f54eb"},{segment:"Khách hàng tiềm năng",value:245,percentage:24.5,color:"#1890ff"},{segment:"Khách hàng mới",value:321,percentage:32.1,color:"#52c41a"},{segment:"Khách hàng không hoạt động",value:195,percentage:19.5,color:"#faad14"}],n=E(),a=G(),r=L(),i=z(),o=H(),ne=Q();V(t),B(n),N(a),w(r),K(i),Y(o),q(ne),d(!1)},1500)},[p]);const E=()=>{const t=[];for(let n=1;n<=5;n++)for(let a=1;a<=5;a++)for(let r=1;r<=5;r++){let i="",o=0;n>=4&&a>=4&&r>=4?(i="VIP",o=Math.floor(Math.random()*10)+5):n>=3&&a>=3&&r>=3?(i="Trung thành",o=Math.floor(Math.random()*20)+10):n>=3&&(a>=3||r>=3)?(i="Tiềm năng",o=Math.floor(Math.random()*30)+15):n<=2&&a<=2&&r<=2?(i="Ngủ đông",o=Math.floor(Math.random()*25)+10):(i="Trung bình",o=Math.floor(Math.random()*40)+20),t.push({r:n,f:a,m:r,segment:i,value:o})}return t},G=()=>[{category:"Dưới 1tr",value:352,color:"#d9d9d9"},{category:"1tr - 5tr",value:421,color:"#faad14"},{category:"5tr - 15tr",value:127,color:"#52c41a"},{category:"15tr - 30tr",value:68,color:"#1890ff"},{category:"Trên 30tr",value:32,color:"#722ed1"}],L=()=>[{time:"0-7 ngày",value:143},{time:"8-30 ngày",value:205},{time:"31-60 ngày",value:187},{time:"61-90 ngày",value:139},{time:"91-180 ngày",value:117},{time:"181-365 ngày",value:112},{time:"Trên 365 ngày",value:97}],z=()=>{const t=[],n=T().subtract(12,"months");for(let a=0;a<12;a++){const r=n.clone().add(a,"months").format("MM/YYYY");t.push({month:r,Mới:Math.floor(Math.random()*2e5)+1e5,"0-6 tháng":Math.floor(Math.random()*5e5)+3e5,"6-12 tháng":Math.floor(Math.random()*8e5)+5e5,"1-2 năm":Math.floor(Math.random()*12e5)+8e5,"Trên 2 năm":Math.floor(Math.random()*2e6)+12e5})}return t},H=()=>[{age:"18-24",male:87,female:95},{age:"25-34",male:147,female:158},{age:"35-44",male:118,female:103},{age:"45-54",male:73,female:67},{age:"55-64",male:52,female:48},{age:"65+",male:32,female:20}],Q=()=>[{id:1,name:"Nguyễn Văn A",orders:12,totalSpent:458e5,lastOrder:"2023-06-18",segment:"VIP"},{id:2,name:"Trần Thị B",orders:8,totalSpent:385e5,lastOrder:"2023-06-22",segment:"Trung thành"},{id:3,name:"Lê Minh C",orders:15,totalSpent:372e5,lastOrder:"2023-06-10",segment:"VIP"},{id:4,name:"Phạm Văn D",orders:10,totalSpent:326e5,lastOrder:"2023-06-15",segment:"Trung thành"},{id:5,name:"Hoàng Thị E",orders:7,totalSpent:289e5,lastOrder:"2023-06-05",segment:"Tiềm năng"}],b=t=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(t),W=t=>{R(t),d(!0),setTimeout(()=>d(!1),1e3)},X={data:j,angleField:"value",colorField:"segment",radius:.8,label:{type:"outer",content:"{name}: {percentage}"},color:({segment:t})=>{const n=j.find(a=>a.segment===t);return n?n.color:"#1890ff"},interactions:[{type:"element-active"}]},J={data:y,angleField:"value",colorField:"category",radius:.8,label:{type:"inner",content:"{percentage}"},color:({category:t})=>{const n=y.find(a=>a.category===t);return n?n.color:"#1890ff"},interactions:[{type:"element-active"}]},U={data:$,xField:"time",yField:"value",color:"#1890ff",label:{position:"middle",style:{fill:"#FFFFFF",opacity:.6}}},Z={data:v,xField:"month",yField:"value",seriesField:"segment",isStack:!0,label:!1,legend:{position:"top"},color:["#1890ff","#52c41a","#faad14","#eb2f96","#722ed1"]},_=v.reduce((t,n)=>{const{month:a,...r}=n;return Object.entries(r).forEach(([i,o])=>{t.push({month:a,segment:i,value:o})}),t},[]),ee={data:O,xField:"age",yField:["male","female"],isGroup:!0,color:["#1890ff","#eb2f96"],label:{position:"middle",layout:[{type:"interval-adjust-position"},{type:"interval-hide-overlap"},{type:"adjust-color"}]},legend:{position:"top-right",itemName:{formatter:t=>t==="male"?"Nam":t==="female"?"Nữ":t}}},te=[{title:"Khách hàng",dataIndex:"name",key:"name"},{title:"Đơn hàng",dataIndex:"orders",key:"orders",align:"right"},{title:"Tổng chi tiêu",dataIndex:"totalSpent",key:"totalSpent",align:"right",render:t=>b(t)},{title:"Mua gần nhất",dataIndex:"lastOrder",key:"lastOrder",render:t=>T(t).format("DD/MM/YYYY")},{title:"Phân khúc",dataIndex:"segment",key:"segment",render:t=>{let n="";switch(t){case"VIP":n="#722ed1";break;case"Trung thành":n="#2f54eb";break;case"Tiềm năng":n="#1890ff";break;default:n="#1890ff"}return e.jsx(fe,{color:n,children:t})}}];return e.jsxs("div",{className:"customer-segmentation",children:[e.jsx(h,{bordered:!1,className:"header-card",children:e.jsxs(g,{justify:"space-between",align:"middle",gutter:[24,24],children:[e.jsxs(l,{xs:24,sm:12,children:[e.jsx(pe,{level:3,children:"Phân khúc khách hàng"}),e.jsx(je,{type:"secondary",children:"Phân tích và phân khúc khách hàng để hiểu rõ hơn về đối tượng mục tiêu"})]}),e.jsx(l,{xs:24,sm:12,children:e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"8px",flexWrap:"wrap"},children:[e.jsxs(F,{style:{width:120},value:p,onChange:W,loading:s,children:[e.jsx(m,{value:"month",children:"30 ngày qua"}),e.jsx(m,{value:"quarter",children:"90 ngày qua"}),e.jsx(m,{value:"year",children:"365 ngày qua"}),e.jsx(m,{value:"all",children:"Tất cả thời gian"})]}),e.jsx(M,{icon:e.jsx(se,{}),onClick:()=>{d(!0),setTimeout(()=>d(!1),1e3)},loading:s,children:"Làm mới"}),e.jsx(M,{icon:e.jsx(re,{}),disabled:s,children:"Xuất báo cáo"})]})})]})}),e.jsxs(g,{gutter:[24,24],style:{marginTop:"24px"},children:[e.jsx(l,{xs:24,sm:8,children:e.jsx(h,{bordered:!1,loading:s,children:e.jsx(u,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(le,{}),e.jsx("span",{children:"Tổng khách hàng"})]}),value:1e3,suffix:e.jsxs("div",{style:{fontSize:"14px",color:"#52c41a"},children:[e.jsx(k,{})," +12.5% so với kỳ trước"]})})})}),e.jsx(l,{xs:24,sm:8,children:e.jsx(h,{bordered:!1,loading:s,children:e.jsx(u,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(S,{}),e.jsx("span",{children:"Giá trị trung bình"})]}),value:1245e4,precision:0,formatter:t=>b(t),suffix:e.jsxs("div",{style:{fontSize:"14px",color:"#52c41a"},children:[e.jsx(k,{})," +8.3% so với kỳ trước"]})})})}),e.jsx(l,{xs:24,sm:8,children:e.jsx(h,{bordered:!1,loading:s,children:e.jsx(u,{title:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"8px"},children:[e.jsx(ie,{}),e.jsx("span",{children:"Tỷ lệ mua lại"})]}),value:42.5,suffix:"%",precision:1,valueStyle:{color:"#1890ff"}})})})]}),e.jsxs(g,{gutter:[24,24],style:{marginTop:"24px"},children:[e.jsx(l,{xs:24,lg:12,children:e.jsx(h,{title:e.jsxs("span",{children:[e.jsx(oe,{})," Phân khúc khách hàng"]}),bordered:!1,loading:s,children:e.jsx(C,{...X,height:300})})}),e.jsx(l,{xs:24,lg:12,children:e.jsxs(P,{defaultActiveKey:"value",children:[e.jsx(D,{tab:e.jsxs("span",{children:[e.jsx(S,{})," Phân bố giá trị"]}),children:e.jsx(h,{bordered:!1,loading:s,bodyStyle:{padding:"12px"},children:e.jsx(C,{...J,height:300})})},"value"),e.jsx(D,{tab:e.jsxs("span",{children:[e.jsx(ce,{})," Thời gian mua gần nhất"]}),children:e.jsx(h,{bordered:!1,loading:s,bodyStyle:{padding:"12px"},children:e.jsx(f,{...U,height:300})})},"recency")]})})]}),e.jsxs(g,{gutter:[24,24],style:{marginTop:"24px"},children:[e.jsx(l,{xs:24,lg:12,children:e.jsx(h,{title:e.jsxs("span",{children:[e.jsx(de,{})," Top khách hàng giá trị"]}),bordered:!1,loading:s,children:e.jsx(he,{dataSource:A,columns:te,pagination:!1,rowKey:"id"})})}),e.jsx(l,{xs:24,lg:12,children:e.jsx(h,{title:e.jsxs("span",{children:[e.jsx(ge,{})," Phân bố khách hàng theo độ tuổi và giới tính"]}),bordered:!1,loading:s,children:e.jsx(f,{...ee,height:300})})})]}),e.jsx(g,{gutter:[24,24],style:{marginTop:"24px"},children:e.jsx(l,{xs:24,children:e.jsxs(h,{title:e.jsxs("span",{children:[e.jsx(ue,{})," Giá trị khách hàng theo vòng đời"]}),bordered:!1,loading:s,children:[e.jsx("div",{style:{marginBottom:"16px"},children:e.jsxs(x.Group,{defaultValue:"stack",buttonStyle:"solid",children:[e.jsx(x.Button,{value:"stack",children:"Biểu đồ xếp chồng"}),e.jsx(x.Button,{value:"line",children:"Biểu đồ đường"})]})}),e.jsx("div",{style:{height:"350px"},children:s?e.jsx("div",{style:{height:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsx(me,{})}):e.jsx(f,{height:350,...Z,data:_})})]})})}),e.jsx(g,{gutter:[24,24],style:{marginTop:"24px"},children:e.jsx(l,{xs:24,children:e.jsx(xe,{message:"Phân tích phân khúc khách hàng RFM",description:e.jsxs(e.Fragment,{children:[e.jsx(I,{children:"Phân tích RFM là phương pháp phân tích khách hàng dựa trên ba chỉ số:"}),e.jsxs("ul",{children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Recency (R):"})," Độ gần đây của lần mua hàng cuối cùng"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Frequency (F):"})," Tần suất mua hàng"]}),e.jsxs("li",{children:[e.jsx("strong",{children:"Monetary (M):"})," Giá trị chi tiêu"]})]}),e.jsx(I,{children:"Mỗi khách hàng được chấm điểm từ 1-5 cho mỗi chỉ số, với 5 là tốt nhất. Khách hàng có điểm cao ở cả 3 chỉ số (VIP) là đối tượng cần được chăm sóc đặc biệt."})]}),type:"info",showIcon:!0})})})]})};export{Ie as default};
