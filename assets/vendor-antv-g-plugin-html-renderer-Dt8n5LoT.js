import{_ as e,a as t,b as a,c as r}from"./polyfills-BjGv5uaK.js";import{k as n,v as i,E as s,l as o,y as l,w as c,S as d}from"./vendor-antv-g-lite-BsxRpwbw.js";import{q as y,d as v,c as m}from"./vendor-antv-util-BIOdtugi.js";
/*!
 * @antv/g-plugin-html-renderer
 * @description A G plugin for rendering HTML
 * @version 2.1.24
 * @date 5/9/2025, 8:20:22 AM
 * @author AntVis
 * @docs https://g.antv.antgroup.com/
 */var p=function(){function e(){a(this,e),this.displayObjectHTMLElementMap=new WeakMap}return t(e,[{key:"joinTransformMatrix",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0];return"matrix(".concat([e[0],e[1],e[4],e[5],e[12]+t[0],e[13]+t[1]].join(","),")")}},{key:"apply",value:function(t,a){var r=this,n=t.camera,l=t.renderingContext,c=t.renderingService;this.context=t;var y=l.root.ownerDocument.defaultView,v=y.context.eventService.nativeHTMLMap,m=function(e,t){t.style.transform=r.joinTransformMatrix(e.getWorldTransform(),e.getOrigin())},p=function(e){var t=e.target;if(t.nodeName===d.HTML){r.$camera||(r.$camera=r.createCamera(n));var a=r.getOrCreateEl(t);r.$camera.appendChild(a),Object.keys(t.attributes).forEach(function(e){r.updateAttribute(e,t)}),m(t,a),v.set(a,t)}},f=function(e){var t=e.target;if(t.nodeName===d.HTML&&r.$camera){var a=r.getOrCreateEl(t);a&&(a.remove(),v.delete(a))}},u=function(e){var t=e.target;if(t.nodeName===d.HTML){var a=e.attrName;r.updateAttribute(a,t)}},h=function(e){var t=e.target;(t.nodeName===d.FRAGMENT?t.childNodes:[t]).forEach(function(e){if(e.nodeName===d.HTML){var t=r.getOrCreateEl(e);m(e,t)}})},g=function(){if(r.$camera){var e=r.context.config,t=e.width,a=e.height;r.$camera.parentElement.style.width="".concat(t||0,"px"),r.$camera.parentElement.style.height="".concat(a||0,"px")}};c.hooks.init.tap(e.tag,function(){y.addEventListener(i.RESIZE,g),y.addEventListener(s.MOUNTED,p),y.addEventListener(s.UNMOUNTED,f),y.addEventListener(s.ATTR_MODIFIED,u),y.addEventListener(s.BOUNDS_CHANGED,h)}),c.hooks.endFrame.tap(e.tag,function(){r.$camera&&l.renderReasons.has(o.CAMERA_CHANGED)&&(r.$camera.style.transform=r.joinTransformMatrix(n.getOrthoMatrix()))}),c.hooks.destroy.tap(e.tag,function(){r.$camera&&r.$camera.remove(),y.removeEventListener(i.RESIZE,g),y.removeEventListener(s.MOUNTED,p),y.removeEventListener(s.UNMOUNTED,f),y.removeEventListener(s.ATTR_MODIFIED,u),y.removeEventListener(s.BOUNDS_CHANGED,h)})}},{key:"createCamera",value:function(e){var t=this.context.config,a=t.document,r=t.width,n=t.height,i=this.context.contextService.getDomElement(),s=i.parentNode;if(s){var o="g-canvas-camera",l=s.querySelector("#".concat(o));if(!l){var c=(a||document).createElement("div");c.style.overflow="hidden",c.style.pointerEvents="none",c.style.position="absolute",c.style.left="0px",c.style.top="0px",c.style.width="".concat(r||0,"px"),c.style.height="".concat(n||0,"px");var d=(a||document).createElement("div");l=d,d.id=o,d.style.position="absolute",d.style.left="".concat(i.offsetLeft||0,"px"),d.style.top="".concat(i.offsetTop||0,"px"),d.style.transformOrigin="left top",d.style.transform=this.joinTransformMatrix(e.getOrthoMatrix()),d.style.pointerEvents="none",d.style.width="100%",d.style.height="100%",c.appendChild(d),s.appendChild(c)}return l}return null}},{key:"getOrCreateEl",value:function(e){var t=this.context.config.document,a=this.displayObjectHTMLElementMap.get(e);return a||(a=(t||document).createElement("div"),e.parsedStyle.$el=a,this.displayObjectHTMLElementMap.set(e,a),e.id&&(a.id=e.id),e.name&&a.setAttribute("name",e.name),e.className&&(a.className=e.className),a.style.position="absolute",a.style["will-change"]="transform",a.style.transform=this.joinTransformMatrix(e.getWorldTransform(),e.getOrigin())),a}},{key:"updateAttribute",value:function(e,t){var a=this.getOrCreateEl(t);switch(e){case"innerHTML":var r=t.parsedStyle.innerHTML;m(r)?a.innerHTML=r:(a.innerHTML="",a.appendChild(r));break;case"x":a.style.left="".concat(t.parsedStyle.x,"px");break;case"y":a.style.top="".concat(t.parsedStyle.y,"px");break;case"transformOrigin":var n=t.parsedStyle.transformOrigin;a.style["transform-origin"]="".concat(n[0].buildCSSText(null,null,"")," ").concat(n[1].buildCSSText(null,null,""));break;case"width":var i=t.parsedStyle.width;a.style.width=v(i)?"".concat(i,"px"):i.toString();break;case"height":var s=t.parsedStyle.height;a.style.height=v(s)?"".concat(s,"px"):s.toString();break;case"zIndex":var o=t.parsedStyle.zIndex;a.style["z-index"]="".concat(o);break;case"visibility":var d=t.parsedStyle.visibility;a.style.visibility=d;break;case"pointerEvents":var p=t.parsedStyle.pointerEvents,f=void 0===p?"auto":p;a.style.pointerEvents=f;break;case"opacity":var u=t.parsedStyle.opacity;a.style.opacity="".concat(u);break;case"fill":var h=t.parsedStyle.fill,g="";l(h)?g=h.isNone?"transparent":t.getAttribute("fill"):Array.isArray(h)?g=t.getAttribute("fill"):c(h),a.style.background=g;break;case"stroke":var E=t.parsedStyle.stroke,b="";l(E)?b=E.isNone?"transparent":t.getAttribute("stroke"):Array.isArray(E)?b=t.getAttribute("stroke"):c(E),a.style["border-color"]=b,a.style["border-style"]="solid";break;case"lineWidth":var x=t.parsedStyle.lineWidth;a.style["border-width"]="".concat(x||0,"px");break;case"lineDash":a.style["border-style"]="dashed";break;case"filter":var k=t.style.filter;a.style.filter=k;break;default:y(t.style[e])||""===t.style[e]||(a.style[e]=t.style[e])}}}])}();p.tag="HTMLRendering";var f=function(){function i(){var e;a(this,i);for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return(e=r(this,i,[].concat(n))).name="html-renderer",e}return e(i,n),t(i,[{key:"init",value:function(){this.addRenderingPlugin(new p)}},{key:"destroy",value:function(){this.removeAllRenderingPlugins()}}])}();export{f as P};
