import{j as e}from"./index-D0cJwDsb.js";import{r as l}from"./vendor-DD54NZMZ.js";import{F as s,T as xe,u as U,B as o,ag as E,y as L,a4 as G,O as je,A as ye,f as ve,e as f,C as a,as as d,$ as I,M as Q,I as B,J as Te,ax as Ce,a0 as be,l as F,aZ as z,ak as K,aF as _,ae as X,H as fe,s as g,a_ as J,a$ as Ie,aG as ke}from"./antd-pmzi8FkM.js";import"./utils-Db1EesZb.js";const{Title:Z,Text:Pe,Paragraph:Fe}=xe,{TabPane:M}=U,{Option:i}=I,{RangePicker:Ve}=be,{TextArea:N}=B,Me=()=>{const[W,Y]=l.useState("programs"),[q,ee]=l.useState(!0),[p,k]=l.useState([]),[x,V]=l.useState([]),[te,w]=l.useState(!1),[ne,D]=l.useState(!1),[j,R]=l.useState(null),[y,S]=l.useState(null),[u]=s.useForm(),[m]=s.useForm(),se=[{id:1,name:"Chương trình thành viên cơ bản",description:"Tích điểm cơ bản cho mọi đơn hàng",pointsPerVnd:1e-4,status:"active",startDate:"2023-01-01",endDate:null,memberCount:450,rules:["Tích 1 điểm cho mỗi 10,000 VND chi tiêu","Điểm có hiệu lực trong vòng 12 tháng","Áp dụng cho tất cả khách hàng đã đăng ký"]},{id:2,name:"Chương trình khách hàng VIP",description:"Đặc quyền cho khách hàng chi tiêu cao",pointsPerVnd:2e-4,status:"active",startDate:"2023-03-15",endDate:null,memberCount:85,rules:["Tích 1 điểm cho mỗi 5,000 VND chi tiêu","Ưu đãi giảm giá đặc biệt hàng tháng","Chỉ áp dụng cho khách hàng chi tiêu trên 50 triệu/năm","Tặng voucher sinh nhật trị giá 500,000 VND"]},{id:3,name:"Chương trình khuyến mãi hè 2023",description:"Tích điểm tăng gấp đôi trong mùa hè",pointsPerVnd:2e-4,status:"inactive",startDate:"2023-06-01",endDate:"2023-08-31",memberCount:320,rules:["Tích điểm gấp đôi cho tất cả đơn hàng","Áp dụng cho tất cả khách hàng","Có hiệu lực từ 01/06 đến 31/08/2023"]}],ie=[{id:1,name:"Voucher giảm giá 50,000 VND",description:"Áp dụng cho đơn hàng từ 500,000 VND",pointsCost:50,type:"voucher",status:"active",redemptionCount:125,expiryDays:30,image:"https://via.placeholder.com/100",conditions:"Áp dụng cho đơn hàng từ 500,000 VND"},{id:2,name:"Voucher giảm giá 100,000 VND",description:"Áp dụng cho đơn hàng từ 1,000,000 VND",pointsCost:90,type:"voucher",status:"active",redemptionCount:78,expiryDays:30,image:"https://via.placeholder.com/100",conditions:"Áp dụng cho đơn hàng từ 1,000,000 VND"},{id:3,name:"Quà tặng tai nghe không dây",description:"Tai nghe Bluetooth chất lượng cao",pointsCost:500,type:"gift",status:"active",redemptionCount:45,expiryDays:null,image:"https://via.placeholder.com/100",conditions:"Số lượng có hạn, chỉ áp dụng đến khi hết hàng"},{id:4,name:"Miễn phí vận chuyển",description:"Miễn phí vận chuyển cho đơn hàng bất kỳ",pointsCost:30,type:"shipping",status:"active",redemptionCount:210,expiryDays:15,image:"https://via.placeholder.com/100",conditions:"Áp dụng cho tất cả đơn hàng, không áp dụng cùng khuyến mãi khác"},{id:5,name:"Giảm giá 15%",description:"Giảm giá 15% cho đơn hàng",pointsCost:150,type:"discount",status:"inactive",redemptionCount:32,expiryDays:30,image:"https://via.placeholder.com/100",conditions:"Không áp dụng cho sản phẩm đã giảm giá"}];l.useEffect(()=>{setTimeout(()=>{k(se),V(ie),ee(!1)},1e3)},[]);const ae=()=>{R(null),u.resetFields(),w(!0)},H=t=>{R(t),u.setFieldsValue({name:t.name,description:t.description,pointsPerVnd:t.pointsPerVnd,status:t.status,dateRange:t.endDate?[new Date(t.startDate),new Date(t.endDate)]:[new Date(t.startDate),null],rules:t.rules.join(`
`)}),w(!0)},re=()=>{S(null),m.resetFields(),D(!0)},O=t=>{S(t),m.setFieldsValue({name:t.name,description:t.description,pointsCost:t.pointsCost,type:t.type,status:t.status,expiryDays:t.expiryDays,conditions:t.conditions}),D(!0)},ce=()=>{w(!1),R(null),u.resetFields()},le=()=>{D(!1),S(null),m.resetFields()},he=()=>{u.validateFields().then(t=>{const{name:n,description:h,pointsPerVnd:v,status:T,dateRange:r,rules:P}=t,C=P.split(`
`).filter(c=>c.trim()!=="");if(j){const c={...j,name:n,description:h,pointsPerVnd:v,status:T,startDate:r[0].toISOString().split("T")[0],endDate:r[1]?r[1].toISOString().split("T")[0]:null,rules:C},$=p.map(b=>b.id===j.id?c:b);k($),g.success("Cập nhật chương trình thành công!")}else{const c={id:p.length+1,name:n,description:h,pointsPerVnd:v,status:T,startDate:r[0].toISOString().split("T")[0],endDate:r[1]?r[1].toISOString().split("T")[0]:null,memberCount:0,rules:C};k([...p,c]),g.success("Thêm chương trình thành công!")}w(!1),R(null),u.resetFields()})},oe=()=>{m.validateFields().then(t=>{const{name:n,description:h,pointsCost:v,type:T,status:r,expiryDays:P,conditions:C}=t;if(y){const c={...y,name:n,description:h,pointsCost:v,type:T,status:r,expiryDays:P,conditions:C},$=x.map(b=>b.id===y.id?c:b);V($),g.success("Cập nhật phần thưởng thành công!")}else{const c={id:x.length+1,name:n,description:h,pointsCost:v,type:T,status:r,expiryDays:P,redemptionCount:0,image:"https://via.placeholder.com/100",conditions:C};V([...x,c]),g.success("Thêm phần thưởng thành công!")}D(!1),S(null),m.resetFields()})},de=t=>{k(p.filter(n=>n.id!==t)),g.success("Đã xóa chương trình!")},ue=t=>{V(x.filter(n=>n.id!==t)),g.success("Đã xóa phần thưởng!")},A=t=>{const n={active:"green",inactive:"orange",draft:"blue",expired:"red"},h={active:"Hoạt động",inactive:"Tạm dừng",draft:"Bản nháp",expired:"Hết hạn"};return e.jsx(fe,{color:n[t]||"default",children:h[t]||t})},me=t=>{switch(t){case"voucher":return e.jsx(J,{style:{color:"#1890ff"}});case"discount":return e.jsx(ke,{style:{color:"#52c41a"}});case"gift":return e.jsx(z,{style:{color:"#faad14"}});case"shipping":return e.jsx(Ie,{style:{color:"#722ed1"}});default:return e.jsx(J,{})}},ge=[{title:"Tên chương trình",dataIndex:"name",key:"name",render:(t,n)=>e.jsxs(F,{children:[e.jsx(z,{style:{color:"#faad14"}}),e.jsx("a",{onClick:()=>H(n),children:t})]})},{title:"Mô tả",dataIndex:"description",key:"description",ellipsis:!0},{title:"Tỷ lệ điểm",dataIndex:"pointsPerVnd",key:"pointsPerVnd",render:t=>`1 điểm / ${new Intl.NumberFormat("vi-VN").format(1/t)} VND`},{title:"Trạng thái",dataIndex:"status",key:"status",render:t=>A(t)},{title:"Thời gian",key:"time",render:(t,n)=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:["Bắt đầu: ",n.startDate]}),n.endDate&&e.jsxs("div",{children:["Kết thúc: ",n.endDate]})]})},{title:"Số thành viên",dataIndex:"memberCount",key:"memberCount",sorter:(t,n)=>t.memberCount-n.memberCount},{title:"Thao tác",key:"actions",render:(t,n)=>e.jsxs(F,{children:[e.jsx(o,{icon:e.jsx(K,{}),size:"small",onClick:()=>H(n)}),e.jsx(_,{title:"Bạn có chắc chắn muốn xóa chương trình này?",onConfirm:()=>de(n.id),okText:"Xóa",cancelText:"Hủy",children:e.jsx(o,{icon:e.jsx(X,{}),size:"small",danger:!0})})]})}],pe=[{title:"Phần thưởng",dataIndex:"name",key:"name",render:(t,n)=>e.jsxs(F,{children:[me(n.type),e.jsx("a",{onClick:()=>O(n),children:t})]})},{title:"Mô tả",dataIndex:"description",key:"description",ellipsis:!0},{title:"Loại",dataIndex:"type",key:"type",render:t=>({voucher:"Voucher",discount:"Giảm giá",gift:"Quà tặng",shipping:"Vận chuyển"})[t]||t},{title:"Điểm đổi",dataIndex:"pointsCost",key:"pointsCost",sorter:(t,n)=>t.pointsCost-n.pointsCost},{title:"Trạng thái",dataIndex:"status",key:"status",render:t=>A(t)},{title:"Đã đổi",dataIndex:"redemptionCount",key:"redemptionCount",sorter:(t,n)=>t.redemptionCount-n.redemptionCount},{title:"Thao tác",key:"actions",render:(t,n)=>e.jsxs(F,{children:[e.jsx(o,{icon:e.jsx(K,{}),size:"small",onClick:()=>O(n)}),e.jsx(_,{title:"Bạn có chắc chắn muốn xóa phần thưởng này?",onConfirm:()=>ue(n.id),okText:"Xóa",cancelText:"Hủy",children:e.jsx(o,{icon:e.jsx(X,{}),size:"small",danger:!0})})]})}];return e.jsxs("div",{children:[e.jsx(Z,{level:2,children:"Quản lý chương trình khách hàng thân thiết"}),e.jsxs(U,{activeKey:W,onChange:Y,children:[e.jsxs(M,{tab:"Chương trình thành viên",children:[e.jsx("div",{style:{marginBottom:16},children:e.jsx(o,{type:"primary",icon:e.jsx(E,{}),onClick:ae,children:"Thêm chương trình mới"})}),e.jsx(L,{columns:ge,dataSource:p,rowKey:"id",loading:q,expandable:{expandedRowRender:t=>e.jsxs("div",{children:[e.jsx(Z,{level:5,children:"Quy tắc chương trình:"}),e.jsx(G,{size:"small",bordered:!0,dataSource:t.rules,renderItem:n=>e.jsxs(G.Item,{children:[e.jsx(je,{style:{color:"#52c41a",marginRight:8}}),n]})})]})}})]},"programs"),e.jsxs(M,{tab:"Phần thưởng & Đổi điểm",children:[e.jsx("div",{style:{marginBottom:16},children:e.jsx(o,{type:"primary",icon:e.jsx(E,{}),onClick:re,children:"Thêm phần thưởng mới"})}),e.jsx(L,{columns:pe,dataSource:x,rowKey:"id",loading:q})]},"rewards"),e.jsx(M,{tab:"Thống kê & Báo cáo",children:e.jsx(ye,{message:"Báo cáo chương trình thành viên",description:"Chức năng báo cáo đang được phát triển và sẽ có sẵn trong phiên bản tới.",type:"info",showIcon:!0})},"stats"),e.jsx(M,{tab:"Thiết lập",children:e.jsx(ve,{title:"Thiết lập chung",children:e.jsxs(s,{layout:"vertical",children:[e.jsxs(f,{gutter:16,children:[e.jsx(a,{span:12,children:e.jsx(s.Item,{label:"Tỷ lệ tích điểm mặc định",tooltip:"Số điểm tích được cho mỗi VND chi tiêu",children:e.jsx(d,{style:{width:"100%"},min:0,step:1e-5,defaultValue:1e-4})})}),e.jsx(a,{span:12,children:e.jsx(s.Item,{label:"Thời hạn điểm (ngày)",tooltip:"Số ngày điểm có hiệu lực kể từ ngày tích lũy",children:e.jsx(d,{style:{width:"100%"},min:30,defaultValue:365})})})]}),e.jsxs(f,{gutter:16,children:[e.jsx(a,{span:12,children:e.jsx(s.Item,{label:"Số tiền tối thiểu để tích điểm",children:e.jsx(d,{style:{width:"100%"},min:0,step:1e4,defaultValue:0,formatter:t=>`${t}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:t=>t.replace(/\$\s?|(,*)/g,"")})})}),e.jsx(a,{span:12,children:e.jsx(s.Item,{label:"Giá trị tối thiểu để sử dụng điểm",children:e.jsx(d,{style:{width:"100%"},min:0,step:1e4,defaultValue:0,formatter:t=>`${t}`.replace(/\B(?=(\d{3})+(?!\d))/g,","),parser:t=>t.replace(/\$\s?|(,*)/g,"")})})})]}),e.jsx(s.Item,{label:"Các cấp độ thành viên",children:e.jsxs(I,{defaultValue:"basic",style:{width:"100%"},children:[e.jsx(i,{value:"basic",children:"Cơ bản (3 cấp độ)"}),e.jsx(i,{value:"advanced",children:"Nâng cao (5 cấp độ)"}),e.jsx(i,{value:"custom",children:"Tùy chỉnh"})]})}),e.jsx(s.Item,{children:e.jsx(o,{type:"primary",children:"Lưu thiết lập"})})]})})},"settings")]}),e.jsx(Q,{title:j?"Chỉnh sửa chương trình":"Thêm chương trình mới",visible:te,onOk:he,onCancel:ce,width:700,okText:j?"Cập nhật":"Thêm mới",cancelText:"Hủy",children:e.jsxs(s,{form:u,layout:"vertical",children:[e.jsx(s.Item,{name:"name",label:"Tên chương trình",rules:[{required:!0,message:"Vui lòng nhập tên chương trình"}],children:e.jsx(B,{})}),e.jsx(s.Item,{name:"description",label:"Mô tả",rules:[{required:!0,message:"Vui lòng nhập mô tả"}],children:e.jsx(N,{rows:3})}),e.jsxs(f,{gutter:16,children:[e.jsx(a,{span:12,children:e.jsx(s.Item,{name:"pointsPerVnd",label:e.jsxs("span",{children:["Tỷ lệ điểm",e.jsx(Te,{title:"Số điểm tích được cho mỗi VND chi tiêu",children:e.jsx(Ce,{style:{marginLeft:4}})})]}),rules:[{required:!0,message:"Vui lòng nhập tỷ lệ điểm"}],children:e.jsx(d,{style:{width:"100%"},min:0,step:1e-5})})}),e.jsx(a,{span:12,children:e.jsx(s.Item,{name:"status",label:"Trạng thái",rules:[{required:!0,message:"Vui lòng chọn trạng thái"}],children:e.jsxs(I,{children:[e.jsx(i,{value:"active",children:"Hoạt động"}),e.jsx(i,{value:"inactive",children:"Tạm dừng"}),e.jsx(i,{value:"draft",children:"Bản nháp"})]})})})]}),e.jsx(s.Item,{name:"dateRange",label:"Thời gian áp dụng",rules:[{required:!0,message:"Vui lòng chọn thời gian áp dụng"}],children:e.jsx(Ve,{style:{width:"100%"}})}),e.jsx(s.Item,{name:"rules",label:"Quy tắc chương trình (mỗi quy tắc một dòng)",children:e.jsx(N,{rows:5})})]})}),e.jsx(Q,{title:y?"Chỉnh sửa phần thưởng":"Thêm phần thưởng mới",visible:ne,onOk:oe,onCancel:le,width:700,okText:y?"Cập nhật":"Thêm mới",cancelText:"Hủy",children:e.jsxs(s,{form:m,layout:"vertical",children:[e.jsx(s.Item,{name:"name",label:"Tên phần thưởng",rules:[{required:!0,message:"Vui lòng nhập tên phần thưởng"}],children:e.jsx(B,{})}),e.jsx(s.Item,{name:"description",label:"Mô tả",rules:[{required:!0,message:"Vui lòng nhập mô tả"}],children:e.jsx(N,{rows:2})}),e.jsxs(f,{gutter:16,children:[e.jsx(a,{span:12,children:e.jsx(s.Item,{name:"pointsCost",label:"Số điểm đổi",rules:[{required:!0,message:"Vui lòng nhập số điểm đổi"}],children:e.jsx(d,{style:{width:"100%"},min:1})})}),e.jsx(a,{span:12,children:e.jsx(s.Item,{name:"type",label:"Loại phần thưởng",rules:[{required:!0,message:"Vui lòng chọn loại phần thưởng"}],children:e.jsxs(I,{children:[e.jsx(i,{value:"voucher",children:"Voucher"}),e.jsx(i,{value:"discount",children:"Giảm giá"}),e.jsx(i,{value:"gift",children:"Quà tặng"}),e.jsx(i,{value:"shipping",children:"Vận chuyển"})]})})})]}),e.jsxs(f,{gutter:16,children:[e.jsx(a,{span:12,children:e.jsx(s.Item,{name:"status",label:"Trạng thái",rules:[{required:!0,message:"Vui lòng chọn trạng thái"}],children:e.jsxs(I,{children:[e.jsx(i,{value:"active",children:"Hoạt động"}),e.jsx(i,{value:"inactive",children:"Tạm dừng"})]})})}),e.jsx(a,{span:12,children:e.jsx(s.Item,{name:"expiryDays",label:"Thời hạn (ngày)",tooltip:"Số ngày phần thưởng có hiệu lực sau khi đổi. Để trống nếu không có hạn",children:e.jsx(d,{style:{width:"100%"},min:1})})})]}),e.jsx(s.Item,{name:"conditions",label:"Điều kiện áp dụng",children:e.jsx(N,{rows:3})})]})})]})};export{Me as default};
