import{r as n,j as e,a as s,L as t}from"./react-vendor-D_ybsntB.js";import{c as h,e as i}from"./ai-features-Dvk3-MnK.js";import{d as r,r as l}from"./datetime-CZsEG1Fw.js";import{m as c,T as a,C as d,g as o,I as m,B as x,x as g,A as j,F as u,E as p,j as y,d as b,S as v,f,V as N,h as k,Y as T,y as S,v as w,w as _}from"./antd-core-DVlmEpkB.js";import{a7 as I,aE as C,D as Y,bx as M,v as D,b as V,c as H,r as P,w as K,f as z,au as $}from"./antd-icons-DMCzxaTm.js";r.extend(l),r.locale("vi");const{Title:L,Text:R,Paragraph:F}=a,{TabPane:q}=o,E=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const[s]=c.useForm(),[t,l]=n.useState(!1),[a,N]=n.useState(null),[k,T]=n.useState(null),[S,w]=n.useState("products"),[_,K]=n.useState(!1),[z,$]=n.useState(!1),[E,B]=n.useState(""),O=[{title:"Sản phẩm",dataIndex:"name",key:"name",render:(n,s)=>e.jsxs("div",{children:[e.jsx(R,{strong:!0,children:n}),e.jsx("div",{children:e.jsxs(R,{type:"secondary",style:{fontSize:"12px"},children:["Mã SN: ",s.serial_number]})})]})},{title:"Ngày mua",dataIndex:"purchase_date",key:"purchase_date",render:n=>r(n).format("DD/MM/YYYY")},{title:"Bảo hành",dataIndex:"warranty_expiry",key:"warranty",render:(n,s)=>{const t=(n=>{if(!n)return{status:"unknown",text:"Không xác định"};const e=r(),s=r(n).diff(e,"day");return s<0?{status:"expired",text:"Hết hạn",daysText:`Hết hạn ${Math.abs(s)} ngày trước`}:s<=30?{status:"expiring",text:"Sắp hết hạn",daysText:`Còn ${s} ngày`}:{status:"active",text:"Còn hiệu lực",daysText:`Còn ${s} ngày`}})(n);let h="green",i=e.jsx(V,{});return"expired"===t.status?(h="red",i=e.jsx(H,{})):"expiring"===t.status&&(h="orange",i=e.jsx(P,{})),e.jsxs("div",{children:[e.jsx(b,{color:h,icon:i,children:t.text}),e.jsx("div",{style:{marginTop:"4px"},children:e.jsx(R,{type:"secondary",style:{fontSize:"12px"},children:t.daysText})})]})}},{title:"Đơn hàng",dataIndex:"order_id",key:"order",render:n=>e.jsxs(x,{type:"link",size:"small",onClick:()=>w("orders"),children:["#",n]})}],U=[{title:"Mã đơn",dataIndex:"id",key:"id",render:n=>e.jsxs(R,{strong:!0,children:["#",n]})},{title:"Ngày mua",dataIndex:"created_at",key:"created_at",render:n=>r(n).format("DD/MM/YYYY")},{title:"Tổng tiền",dataIndex:"total",key:"total",render:n=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(n)},{title:"Trạng thái",dataIndex:"status",key:"status",render:n=>{let s="blue";return"completed"===n&&(s="green"),"cancelled"===n&&(s="red"),e.jsx(b,{color:s,children:"completed"===n?"Hoàn thành":"cancelled"===n?"Đã hủy":"Đang xử lý"})}},{title:"Hóa đơn",key:"actions",render:(n,s)=>e.jsxs(v,{size:"small",children:[e.jsx(f,{title:"Xem hóa đơn",children:e.jsx(x,{type:"text",icon:e.jsx(M,{}),onClick:()=>(async n=>{K(!0);try{const e=await i.get(`/customer/invoice/${n}/preview`,{responseType:"blob"}),s=URL.createObjectURL(e);B(s),$(!0)}catch(e){y.error({title:"Không thể xem hóa đơn",content:"Đã xảy ra lỗi khi tải hóa đơn. Vui lòng thử lại sau."})}finally{K(!1)}})(s.id),loading:_})}),e.jsx(f,{title:"Tải hóa đơn",children:e.jsx(x,{type:"text",icon:e.jsx(D,{}),onClick:()=>(async n=>{K(!0);try{await i.download(`/customer/invoice/${n}`,{},`hoa-don-${n}.pdf`)}catch(e){y.error({title:"Không thể tải hóa đơn",content:"Đã xảy ra lỗi khi tải hóa đơn. Vui lòng thử lại sau."})}finally{K(!1)}})(s.id),loading:_})})]})}];return e.jsxs("div",{children:[e.jsx(L,{level:2,className:"text-center mb-6",children:"Tra cứu sản phẩm & bảo hành"}),e.jsx(d,{className:"mb-6",children:e.jsxs(c,{form:s,layout:"vertical",onFinish:async n=>{l(!0),N(null),T(null);try{const e=`customer_lookup_${n.searchType}_${n.searchValue}`,s=await h.get(e);if(s)return T(s),void l(!1);const t=await i.get("/customer/lookup",{params:{type:n.searchType,value:n.searchValue}});h.set(e,t,300),T(t)}catch(e){N(e.message||"Không thể tìm thấy thông tin. Vui lòng kiểm tra lại số điện thoại hoặc mã đơn hàng.")}finally{l(!1)}},initialValues:{searchType:"phone"},children:[e.jsx(c.Item,{name:"searchType",label:"Tìm kiếm theo",children:e.jsxs(o,{onChange:n=>s.setFieldsValue({searchType:n}),children:[e.jsx(q,{tab:e.jsxs("span",{children:[e.jsx(I,{})," Số điện thoại"]})},"phone"),e.jsx(q,{tab:e.jsxs("span",{children:[e.jsx(C,{})," Mã đơn hàng"]})},"order")]})}),e.jsx(c.Item,{name:"searchValue",label:"Nhập thông tin tìm kiếm",rules:[{required:!0,message:"Vui lòng nhập thông tin tìm kiếm"},{validator:(n,e)=>{const t=s.getFieldValue("searchType");if("phone"===t&&e){if(!/^(0|\+84)[3|5|7|8|9][0-9]{8}$/.test(e))return Promise.reject("Số điện thoại không hợp lệ")}else if("order"===t&&e){if(!/^[a-zA-Z0-9-]{3,20}$/.test(e))return Promise.reject("Mã đơn hàng không hợp lệ")}return Promise.resolve()}}],children:e.jsx(m,{placeholder:"phone"===s.getFieldValue("searchType")?"Nhập số điện thoại":"Nhập mã đơn hàng",size:"large",allowClear:!0})}),e.jsx(c.Item,{children:e.jsx(x,{type:"primary",htmlType:"submit",icon:e.jsx(Y,{}),loading:t,size:"large",block:!0,children:"Tra cứu"})})]})}),t&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(g,{size:"large"}),e.jsx("div",{className:"mt-4",children:e.jsx(R,{type:"secondary",children:"Đang tìm kiếm thông tin..."})})]}),a&&e.jsx(j,{message:"Không tìm thấy thông tin",description:a,type:"error",showIcon:!0,className:"mb-6"}),k&&e.jsxs("div",{children:[e.jsx(d,{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center",children:[e.jsxs("div",{children:[e.jsx(L,{level:4,children:"Thông tin khách hàng"}),e.jsxs(F,{children:[e.jsx(R,{strong:!0,children:"Họ tên:"})," ",k.customer.name]}),e.jsxs(F,{children:[e.jsx(R,{strong:!0,children:"Số điện thoại:"})," ",k.customer.phone]}),k.customer.email&&e.jsxs(F,{children:[e.jsx(R,{strong:!0,children:"Email:"})," ",k.customer.email]})]}),e.jsxs("div",{className:"mt-4 sm:mt-0",children:[e.jsx(R,{type:"secondary",children:"Tổng sản phẩm đã mua: "}),e.jsx(R,{strong:!0,children:k.products.length}),e.jsx("br",{}),e.jsx(R,{type:"secondary",children:"Tổng đơn hàng: "}),e.jsx(R,{strong:!0,children:k.orders.length})]})]})}),e.jsxs(o,{activeKey:S,onChange:w,children:[e.jsx(q,{tab:"Sản phẩm & Bảo hành",children:e.jsx(u,{columns:O,dataSource:k.products.map(n=>({...n,key:n.id})),pagination:{pageSize:5},locale:{emptyText:"Không có sản phẩm nào"}})},"products"),e.jsx(q,{tab:"Đơn hàng",children:e.jsx(u,{columns:U,dataSource:k.orders.map(n=>({...n,key:n.id})),pagination:{pageSize:5},locale:{emptyText:"Không có đơn hàng nào"}})},"orders")]})]}),!t&&!a&&!k&&e.jsx(p,{image:p.PRESENTED_IMAGE_SIMPLE,description:"Nhập thông tin để tra cứu sản phẩm và bảo hành"}),e.jsx(y,{visible:z,title:"Xem hóa đơn",footer:null,onCancel:()=>{$(!1),URL.revokeObjectURL(E)},width:800,children:e.jsx("iframe",{src:E,style:{width:"100%",height:"70vh"},title:"Invoice Preview"})})]})}},Symbol.toStringTag,{value:"Module"})),{Title:B,Paragraph:O,Text:U}=a,{Panel:X}=N,G=Object.freeze(Object.defineProperty({__proto__:null,default:()=>e.jsxs("div",{children:[e.jsx(B,{level:2,className:"text-center mb-6",children:"Điều khoản bảo hành"}),e.jsx(j,{message:"Lưu ý quan trọng",description:"Quý khách vui lòng đọc kỹ điều khoản bảo hành trước khi mua sản phẩm. Việc sử dụng sản phẩm đồng nghĩa với việc chấp nhận các điều khoản bảo hành dưới đây.",type:"info",showIcon:!0,icon:e.jsx(K,{}),className:"mb-6"}),e.jsxs(d,{className:"mb-6",children:[e.jsx(B,{level:3,children:"Chính sách bảo hành"}),e.jsx(O,{children:"Trường Phát Computer cam kết cung cấp dịch vụ bảo hành chất lượng cao cho tất cả sản phẩm được mua tại cửa hàng. Chúng tôi áp dụng chính sách bảo hành theo tiêu chuẩn của nhà sản xuất và có thể mở rộng thêm tùy theo từng sản phẩm."}),e.jsx(B,{level:4,children:"Thời hạn bảo hành"}),e.jsx(O,{children:e.jsxs("ul",{children:[e.jsx("li",{children:"Linh kiện máy tính (CPU, Mainboard, RAM, SSD, HDD): 36 tháng"}),e.jsx("li",{children:"Màn hình máy tính: 36 tháng"}),e.jsx("li",{children:"Laptop: 12 tháng"}),e.jsx("li",{children:"Thiết bị ngoại vi (Chuột, Bàn phím, Tai nghe): 12 tháng"}),e.jsx("li",{children:"Thiết bị mạng: 24 tháng"}),e.jsx("li",{children:"Phụ kiện khác: 3-6 tháng tùy sản phẩm"})]})}),e.jsx(j,{message:"Lưu ý về thời hạn bảo hành",description:"Thời hạn bảo hành được tính từ ngày mua hàng ghi trên hóa đơn. Một số sản phẩm có thể có thời hạn bảo hành khác, vui lòng kiểm tra thông tin trên hóa đơn hoặc phiếu bảo hành.",type:"warning",showIcon:!0,icon:e.jsx(P,{}),className:"mb-4"})]}),e.jsxs(d,{className:"mb-6",children:[e.jsx(B,{level:3,children:"Điều kiện bảo hành"}),e.jsxs(N,{defaultActiveKey:["1"],className:"mb-4",children:[e.jsx(X,{header:"Điều kiện được bảo hành",children:e.jsxs("ul",{children:[e.jsx("li",{children:"Sản phẩm còn trong thời hạn bảo hành và có tem bảo hành nguyên vẹn"}),e.jsx("li",{children:"Sản phẩm bị lỗi do nhà sản xuất"}),e.jsx("li",{children:"Sản phẩm được sử dụng đúng mục đích, công năng và theo hướng dẫn của nhà sản xuất"}),e.jsx("li",{children:"Có hóa đơn mua hàng hoặc phiếu bảo hành của Trường Phát Computer"})]})},"1"),e.jsx(X,{header:"Điều kiện không được bảo hành",children:e.jsxs("ul",{children:[e.jsx("li",{children:"Sản phẩm hết thời hạn bảo hành"}),e.jsx("li",{children:"Tem bảo hành, mã sản phẩm, số serial bị rách, mờ hoặc có dấu hiệu chỉnh sửa"}),e.jsx("li",{children:"Sản phẩm bị hư hỏng do thiên tai, hỏa hoạn, lụt lội, sét đánh"}),e.jsx("li",{children:"Sản phẩm bị hư hỏng do sử dụng sai mục đích, sử dụng không đúng hướng dẫn"}),e.jsx("li",{children:"Sản phẩm bị hư hỏng do va chạm, rơi, vỡ, cháy nổ, côn trùng xâm nhập"}),e.jsx("li",{children:"Sản phẩm có dấu hiệu đã được sửa chữa bởi đơn vị không được ủy quyền"})]})},"2")]}),e.jsx(j,{message:"Chú ý",description:"Trường Phát Computer có quyền từ chối bảo hành nếu sản phẩm không đáp ứng các điều kiện bảo hành nêu trên.",type:"warning",showIcon:!0,icon:e.jsx(z,{}),className:"mb-4"})]}),e.jsxs(d,{className:"mb-6",children:[e.jsx(B,{level:3,children:"Quy trình bảo hành"}),e.jsxs("ol",{className:"list-decimal pl-6 mb-4",children:[e.jsxs("li",{className:"mb-2",children:[e.jsx(U,{strong:!0,children:"Tiếp nhận yêu cầu bảo hành:"}),e.jsxs("ul",{className:"list-disc pl-6 mt-1",children:[e.jsx("li",{children:"Khách hàng mang sản phẩm đến trực tiếp cửa hàng Trường Phát Computer"}),e.jsx("li",{children:"Hoặc liên hệ qua hotline để được hướng dẫn"})]})]}),e.jsxs("li",{className:"mb-2",children:[e.jsx(U,{strong:!0,children:"Kiểm tra tình trạng sản phẩm:"}),e.jsxs("ul",{className:"list-disc pl-6 mt-1",children:[e.jsx("li",{children:"Nhân viên kỹ thuật sẽ kiểm tra và xác định lỗi của sản phẩm"}),e.jsx("li",{children:"Kiểm tra điều kiện bảo hành (tem, thời hạn, hóa đơn)"})]})]}),e.jsxs("li",{className:"mb-2",children:[e.jsx(U,{strong:!0,children:"Xử lý bảo hành:"}),e.jsxs("ul",{className:"list-disc pl-6 mt-1",children:[e.jsx("li",{children:"Sửa chữa tại chỗ (nếu có thể)"}),e.jsx("li",{children:"Gửi về nhà sản xuất (thời gian 7-15 ngày tùy sản phẩm)"}),e.jsx("li",{children:"Đổi sản phẩm mới tương đương nếu không thể sửa chữa"})]})]}),e.jsxs("li",{className:"mb-2",children:[e.jsx(U,{strong:!0,children:"Trả sản phẩm:"}),e.jsxs("ul",{className:"list-disc pl-6 mt-1",children:[e.jsx("li",{children:"Thông báo cho khách hàng khi hoàn thành bảo hành"}),e.jsx("li",{children:"Khách hàng kiểm tra sản phẩm trước khi nhận"})]})]})]}),e.jsx(k,{}),e.jsx(B,{level:4,children:"Thời gian xử lý bảo hành"}),e.jsx(O,{children:e.jsxs("ul",{children:[e.jsx("li",{children:"Bảo hành tại chỗ: 1-3 ngày làm việc"}),e.jsx("li",{children:"Bảo hành qua nhà sản xuất: 7-15 ngày làm việc"}),e.jsx("li",{children:"Trường hợp đặc biệt: sẽ thông báo cụ thể cho khách hàng"})]})})]}),e.jsxs(d,{className:"mb-6",children:[e.jsx(B,{level:3,children:"Bảo hành mở rộng"}),e.jsx(O,{children:"Ngoài chính sách bảo hành tiêu chuẩn, Trường Phát Computer còn cung cấp dịch vụ bảo hành mở rộng giúp khách hàng an tâm sử dụng sản phẩm trong thời gian dài hơn."}),e.jsx(B,{level:4,children:"Các gói bảo hành mở rộng"}),e.jsxs("ul",{children:[e.jsx("li",{children:"Gói bảo hành +12 tháng: Tăng thêm 12 tháng bảo hành"}),e.jsx("li",{children:"Gói bảo hành +24 tháng: Tăng thêm 24 tháng bảo hành"}),e.jsx("li",{children:"Gói bảo hành VIP: Bảo hành tận nơi, ưu tiên xử lý"})]}),e.jsx(O,{children:"Để biết thêm chi tiết về các gói bảo hành mở rộng và chi phí, vui lòng liên hệ nhân viên cửa hàng."})]}),e.jsxs(d,{children:[e.jsx(B,{level:3,children:"Liên hệ hỗ trợ"}),e.jsx(O,{children:"Nếu quý khách có bất kỳ thắc mắc nào về chính sách bảo hành hoặc cần hỗ trợ, vui lòng liên hệ với chúng tôi:"}),e.jsxs("ul",{className:"list-none pl-0",children:[e.jsxs("li",{className:"mb-2",children:[e.jsx(I,{className:"mr-2"})," Hotline: ",e.jsx(U,{strong:!0,children:"1900 1234"})," (8:00 - 21:00, cả T7 & CN)"]}),e.jsxs("li",{className:"mb-2",children:[e.jsx(K,{className:"mr-2"})," Email: ",e.jsx(U,{strong:!0,children:"baohanh@truongphatcomputer.vn"})]}),e.jsxs("li",{children:[e.jsx(K,{className:"mr-2"})," Địa chỉ: ",e.jsx(U,{strong:!0,children:"123 Đường ABC, Quận XYZ, TP. Hồ Chí Minh"})]})]})]})]})},Symbol.toStringTag,{value:"Module"}));r.extend(l),r.locale("vi");const{Title:A,Text:Q,Paragraph:Z}=a,{Step:J}=S,W=Object.freeze(Object.defineProperty({__proto__:null,default:()=>{const{id:l}=s(),[c,a]=n.useState(!0),[o,m]=n.useState(null),[p,N]=n.useState(null),[C,Y]=n.useState(!1),[K,z]=n.useState(!1),[L,R]=n.useState("");n.useEffect(()=>{(async()=>{a(!0),m(null);try{const n=`order_qr_${l}`,e=await h.get(n);if(e)return N(e),void a(!1);const s=await i.get(`/customer/order/${l}`);h.set(n,s,300),N(s)}catch(n){m(n.message||"Không thể tìm thấy thông tin đơn hàng. Mã QR không hợp lệ hoặc đã hết hạn.")}finally{a(!1)}})()},[l]);const F=[{title:"Sản phẩm",dataIndex:"name",key:"name",render:(n,s)=>e.jsxs("div",{children:[e.jsx(Q,{strong:!0,children:n}),s.serial_number&&e.jsx("div",{children:e.jsxs(Q,{type:"secondary",style:{fontSize:"12px"},children:["Mã SN: ",s.serial_number]})})]})},{title:"Giá",dataIndex:"price",key:"price",render:n=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(n)},{title:"SL",dataIndex:"quantity",key:"quantity",align:"center"},{title:"Thành tiền",dataIndex:"total",key:"total",render:(n,e)=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(e.price*e.quantity)},{title:"Bảo hành",dataIndex:"warranty_expiry",key:"warranty",render:(n,s)=>{if(!n)return e.jsx(Q,{type:"secondary",children:"Không bảo hành"});const t=(n=>{if(!n)return{status:"unknown",text:"Không xác định"};const e=r(),s=r(n).diff(e,"day");return s<0?{status:"expired",text:"Hết hạn",daysText:`Hết hạn ${Math.abs(s)} ngày trước`}:s<=30?{status:"expiring",text:"Sắp hết hạn",daysText:`Còn ${s} ngày`}:{status:"active",text:"Còn hiệu lực",daysText:`Còn ${s} ngày`}})(n);let h="green",i=e.jsx(V,{});return"expired"===t.status?(h="red",i=e.jsx(H,{})):"expiring"===t.status&&(h="orange",i=e.jsx(P,{})),e.jsxs("div",{children:[e.jsx(b,{color:h,icon:i,children:t.text}),e.jsx("div",{style:{marginTop:"4px"},children:e.jsx(Q,{type:"secondary",style:{fontSize:"12px"},children:t.daysText})})]})}}];if(c)return e.jsxs("div",{className:"text-center py-12",children:[e.jsx(g,{size:"large"}),e.jsx("div",{className:"mt-4",children:e.jsx(Q,{type:"secondary",children:"Đang tải thông tin đơn hàng..."})})]});if(o)return e.jsx(T,{status:"error",title:"Không tìm thấy thông tin đơn hàng",subTitle:o,extra:[e.jsx(x,{type:"primary",children:e.jsx(t,{to:"/customer-lookup",children:"Tra cứu thủ công"})},"lookup")]});if(!p)return null;const{order:q,customer:E,products:B}=p,O=q.status||"pending",U=(n=>{switch(n){case"pending":default:return 0;case"processing":return 1;case"shipped":return 2;case"completed":return 3;case"cancelled":return-1}})(O);return e.jsxs("div",{children:[e.jsxs(A,{level:2,className:"text-center mb-6",children:[e.jsx($,{})," Chi tiết đơn hàng"]}),"cancelled"===O?e.jsx(j,{message:"Đơn hàng đã bị hủy",description:"Đơn hàng này đã bị hủy và không còn hiệu lực.",type:"error",showIcon:!0,className:"mb-6"}):e.jsx(d,{className:"mb-6",children:e.jsxs(S,{current:U,status:"cancelled"===O?"error":"process",children:[e.jsx(J,{title:"Đặt hàng",description:r(q.created_at).format("DD/MM/YYYY")}),e.jsx(J,{title:"Xử lý",description:"Đang chuẩn bị hàng"}),e.jsx(J,{title:"Vận chuyển",description:q.shipped_at?r(q.shipped_at).format("DD/MM/YYYY"):"Chờ giao hàng"}),e.jsx(J,{title:"Hoàn thành",description:q.completed_at?r(q.completed_at).format("DD/MM/YYYY"):"Chờ hoàn thành"})]})}),e.jsxs(d,{className:"mb-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:justify-between md:items-start",children:[e.jsxs("div",{className:"mb-4 md:mb-0",children:[e.jsx(A,{level:4,children:"Thông tin đơn hàng"}),e.jsxs(w,{column:1,size:"small",children:[e.jsxs(w.Item,{label:"Mã đơn hàng",children:["#",q.id]}),e.jsx(w.Item,{label:"Ngày đặt",children:r(q.created_at).format("DD/MM/YYYY HH:mm")}),e.jsx(w.Item,{label:"Trạng thái",children:e.jsx(b,{color:"completed"===O?"green":"cancelled"===O?"red":"shipped"===O?"blue":"orange",children:"completed"===O?"Hoàn thành":"cancelled"===O?"Đã hủy":"shipped"===O?"Đang giao hàng":"processing"===O?"Đang xử lý":"Chờ xác nhận"})}),e.jsx(w.Item,{label:"Phương thức thanh toán",children:q.payment_method||"Tiền mặt"})]})]}),e.jsxs("div",{children:[e.jsx(A,{level:4,children:"Thông tin khách hàng"}),e.jsxs(w,{column:1,size:"small",children:[e.jsx(w.Item,{label:"Họ tên",children:E.name}),e.jsx(w.Item,{label:"Số điện thoại",children:E.phone}),E.email&&e.jsx(w.Item,{label:"Email",children:E.email}),q.shipping_address&&e.jsx(w.Item,{label:"Địa chỉ giao hàng",children:q.shipping_address})]})]})]}),e.jsx(k,{}),e.jsxs(v,{className:"mb-4",children:[e.jsx(f,{title:"Xem hóa đơn",children:e.jsx(x,{icon:e.jsx(M,{}),onClick:async()=>{if(p){Y(!0);try{const n=await i.get(`/customer/invoice/${p.order.id}/preview`,{responseType:"blob"}),e=URL.createObjectURL(n);R(e),z(!0)}catch(n){y.error({title:"Không thể xem hóa đơn",content:"Đã xảy ra lỗi khi tải hóa đơn. Vui lòng thử lại sau."})}finally{Y(!1)}}},loading:C,children:"Xem hóa đơn"})}),e.jsx(f,{title:"Tải hóa đơn",children:e.jsx(x,{icon:e.jsx(D,{}),onClick:async()=>{if(p){Y(!0);try{await i.download(`/customer/invoice/${p.order.id}`,{},`hoa-don-${p.order.id}.pdf`)}catch(n){y.error({title:"Không thể tải hóa đơn",content:"Đã xảy ra lỗi khi tải hóa đơn. Vui lòng thử lại sau."})}finally{Y(!1)}}},loading:C,children:"Tải hóa đơn"})})]})]}),e.jsx(d,{title:"Danh sách sản phẩm",className:"mb-6",children:e.jsx(u,{columns:F,dataSource:B.map(n=>({...n,key:n.id})),pagination:!1,summary:n=>{let s=0;return n.forEach(({price:n,quantity:e})=>{s+=n*e}),e.jsxs(e.Fragment,{children:[e.jsxs(u.Summary.Row,{children:[e.jsx(u.Summary.Cell,{index:0,colSpan:3,children:e.jsx(Q,{strong:!0,children:"Tổng tiền sản phẩm"})}),e.jsx(u.Summary.Cell,{index:1,colSpan:2,children:e.jsx(Q,{strong:!0,children:new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(s)})})]}),q.shipping_fee>0&&e.jsxs(u.Summary.Row,{children:[e.jsx(u.Summary.Cell,{index:0,colSpan:3,children:e.jsx(Q,{children:"Phí vận chuyển"})}),e.jsx(u.Summary.Cell,{index:1,colSpan:2,children:new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(q.shipping_fee||0)})]}),q.discount>0&&e.jsxs(u.Summary.Row,{children:[e.jsx(u.Summary.Cell,{index:0,colSpan:3,children:e.jsx(Q,{children:"Giảm giá"})}),e.jsxs(u.Summary.Cell,{index:1,colSpan:2,children:["- ",new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(q.discount||0)]})]}),e.jsxs(u.Summary.Row,{children:[e.jsx(u.Summary.Cell,{index:0,colSpan:3,children:e.jsx(Q,{strong:!0,children:"Tổng thanh toán"})}),e.jsx(u.Summary.Cell,{index:1,colSpan:2,children:e.jsx(Q,{strong:!0,style:{fontSize:"16px",color:"#f5222d"},children:new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(q.total)})})]})]})}})}),e.jsx(d,{title:"Lịch sử đơn hàng",className:"mb-6",children:e.jsxs(_,{mode:"left",children:[e.jsxs(_.Item,{color:"green",label:r(q.created_at).format("DD/MM/YYYY HH:mm"),children:[e.jsx(Q,{strong:!0,children:"Đơn hàng được tạo"}),e.jsx("br",{}),e.jsx(Q,{type:"secondary",children:"Đơn hàng của bạn đã được tiếp nhận"})]}),"pending"!==O&&e.jsxs(_.Item,{color:"blue",label:r(q.processing_at||q.created_at).add(1,"hour").format("DD/MM/YYYY HH:mm"),children:[e.jsx(Q,{strong:!0,children:"Đang xử lý"}),e.jsx("br",{}),e.jsx(Q,{type:"secondary",children:"Đơn hàng đang được chuẩn bị"})]}),("shipped"===O||"completed"===O)&&e.jsxs(_.Item,{color:"blue",label:r(q.shipped_at||q.created_at).add(1,"day").format("DD/MM/YYYY HH:mm"),children:[e.jsx(Q,{strong:!0,children:"Đang giao hàng"}),e.jsx("br",{}),e.jsx(Q,{type:"secondary",children:"Đơn hàng đang được vận chuyển đến bạn"})]}),"completed"===O&&e.jsxs(_.Item,{color:"green",label:r(q.completed_at||q.created_at).add(2,"day").format("DD/MM/YYYY HH:mm"),children:[e.jsx(Q,{strong:!0,children:"Hoàn thành"}),e.jsx("br",{}),e.jsx(Q,{type:"secondary",children:"Đơn hàng đã được giao thành công"})]}),"cancelled"===O&&e.jsxs(_.Item,{color:"red",label:r(q.cancelled_at||q.created_at).add(1,"hour").format("DD/MM/YYYY HH:mm"),children:[e.jsx(Q,{strong:!0,children:"Đã hủy"}),e.jsx("br",{}),e.jsx(Q,{type:"secondary",children:"Đơn hàng đã bị hủy"})]})]})}),e.jsxs(d,{title:"Hỗ trợ",className:"mb-6",children:[e.jsx(Z,{children:"Nếu bạn có bất kỳ thắc mắc nào về đơn hàng, vui lòng liên hệ với chúng tôi:"}),e.jsxs("ul",{className:"list-none pl-0",children:[e.jsxs("li",{className:"mb-2",children:[e.jsx(I,{className:"mr-2"})," Hotline: ",e.jsx(Q,{strong:!0,children:"1900 1234"})," (8:00 - 21:00, cả T7 & CN)"]}),e.jsx("li",{children:e.jsxs(Q,{type:"secondary",children:["Khi liên hệ, vui lòng cung cấp mã đơn hàng: ",e.jsxs(Q,{strong:!0,children:["#",q.id]})]})})]})]}),e.jsx("div",{className:"text-center",children:e.jsx(x,{type:"primary",children:e.jsx(t,{to:"/customer-lookup",children:"Tra cứu đơn hàng khác"})})}),e.jsx(y,{visible:K,title:"Xem hóa đơn",footer:null,onCancel:()=>{z(!1),URL.revokeObjectURL(L)},width:800,children:e.jsx("iframe",{src:L,style:{width:"100%",height:"70vh"},title:"Invoice Preview"})})]})}},Symbol.toStringTag,{value:"Module"}));export{E as C,W as Q,G as T};
