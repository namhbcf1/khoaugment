import{u as k,j as s}from"./index-DPVYnWcF.js";import{u as b,f as A,r as n,O as B}from"./vendor-DD54NZMZ.js";import{S as j,A as L,a as O}from"./styles-D-ubGk5c.js";import{G as M,s as T,M as E,S as P,L as h,B as R,R as F}from"./antd-pmzi8FkM.js";const{Content:G}=h,{useBreakpoint:H}=M,J=({showHeader:S=!0,showSidebar:d=!0,showFooter:y=!1,fullWidth:v=!1})=>{const t=b(),i=A(),{user:o,isAuthenticated:u,loading:r,logout:I}=k(),m=H(),[a,c]=n.useState(!m.lg),[f,p]=n.useState(!1),[l,C]=n.useState(null);n.useEffect(()=>{r||(u?o&&o.role!=="cashier"?(T.error("Bạn không có quyền truy cập trang này"),t("/")):g():t("/login",{state:{from:i.pathname}}))},[u,o,r,t,i.pathname]);const g=async()=>{try{const e=localStorage.getItem("activeShift");e?C(JSON.parse(e)):i.pathname!=="/cashier/session/start"&&E.confirm({title:"Chưa mở ca",content:"Bạn cần mở ca làm việc trước khi sử dụng hệ thống POS. Chuyển đến trang mở ca?",okText:"Đến trang mở ca",cancelText:"Hủy",onOk(){t("/cashier/session/start")}})}catch(e){console.error("Error checking shift:",e)}},N=()=>v?0:{padding:"24px"},x=!m.lg;return r?s.jsxs("div",{className:"loading-container",children:[s.jsx(P,{size:"large"}),s.jsx("div",{className:"loading-text",children:"Đang tải..."})]}):s.jsxs(h,{className:"site-layout",children:[d&&s.jsx(s.Fragment,{children:x?s.jsx(j,{collapsed:a,onCollapse:c,isMobile:!0,visible:f,onClose:()=>p(!1)}):s.jsx(j,{collapsed:a,onCollapse:c})}),s.jsxs(h,{className:`site-layout-content ${d?a?"content-collapsed":"content-expanded":"content-no-sidebar"}`,children:[S&&s.jsx(L,{collapsed:a,onCollapse:e=>{x?p(!f):c(e)},title:"Trường Phát POS - Thu Ngân"}),l&&s.jsx("div",{className:"shift-info",children:s.jsxs("div",{className:"shift-status",children:[s.jsxs("span",{children:["Ca làm việc: ",s.jsx("strong",{children:l.name})]}),s.jsxs("span",{children:["Bắt đầu: ",s.jsx("strong",{children:new Date(l.startTime).toLocaleString()})]}),s.jsx(R,{type:"link",icon:s.jsx(F,{}),onClick:g,children:"Làm mới"})]})}),s.jsx(G,{className:"site-content",style:N(),children:s.jsx(B,{})}),y&&s.jsx(O,{minimal:!0})]})]})};export{J as default};
